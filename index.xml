<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Blog</title>
<link>https://kr9268.github.io/</link>
<atom:link href="https://kr9268.github.io/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.4.554</generator>
<lastBuildDate>Sun, 28 Apr 2024 00:00:00 GMT</lastBuildDate>
<item>
  <title>NH증권 직무인터뷰를 읽고(트레이딩&amp;빅데이터)</title>
  <dc:creator>Kibok Park</dc:creator>
  <link>https://kr9268.github.io/posts/vba-noname-yyyymmdd/</link>
  <description><![CDATA[ 





<section id="참고한-공고-인터뷰-자료" class="level2">
<h2 class="anchored" data-anchor-id="참고한-공고-인터뷰-자료">참고한 공고 &amp;인터뷰 자료</h2>
<p>관심이 생겨서 관련 공고 등을 보고 있는데, 직무이해 겸 모르는 단어를 정리해봅니다.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
참고한 공고 (클릭해서 펼치기)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><a href="https://nhqv-recruit2024.com/NH1.html">NH투자증권 채용공고-Trading</a></p>
<p><a href="https://nhqv-recruit2024.com/interview_u_08.html">NH투자증권 채용공고-빅데이터 분석</a></p>
<p><a href="https://nhqv-recruit2024.com/interview_u_04.html">NH투자증권 직무인터뷰</a></p>
</div>
</div>
</div>
</section>
<section id="트레이딩-직무-단어정리" class="level2">
<h2 class="anchored" data-anchor-id="트레이딩-직무-단어정리">트레이딩 직무 단어정리</h2>
<ul>
<li>프랍 트레이딩(Proprietary Trading) : 고객이 아닌 금융회사의 돈으로 주식이나 파생상품 등 금융상품을 거래하는 것 (=자기계정거래, 자기계좌거래, 고유계정거래, 고유계좌거래)</li>
</ul>
<blockquote class="blockquote">
<p><strong><code>프랍트레이딩</code></strong>은 통상 선물·옵션 등 <code>파생상품 부문</code>, 일반적 주식투자 같은 <code>방향성 매매</code>, 알고리즘에 따라 투자하는 <code>시스템 매매</code>, <code>채권투자</code>, 부동산이나 인프라 등의 <code>대체투자</code> 등으로 나뉜다. 보통 <u>자기매매 비중이 높은 중소형 증권사</u>에는 많게는 50여명에 이르는 프랍트레이더들이 있다. 이 가운데 <u>80% 이상이 파생 트레이더다.</u><br><u>중소형 증권사들의 파생상품투자 비중이 높은 것은 비용이 싸기 때문이다.</u> 증권사의 경우 선물·옵션 거래시 <code>사후 증거금 제도</code>가 적용된다. 장중 거래에는 증거금이 따로 필요 없고 장 마감 후 포지션 규모에 따라 증거금을 마련하면 된다. 따라서 <u>장중에는 활발히 거래하고 장 마감 직전 파생상품을 보유하지 않았으면 증거금 부담은 없다.</u> <u>하루 단위로 청산하는 경우 사실상 금융비용은 없다.</u></p>
<p><a href="https://www.sedaily.com/NewsView/1HLP1AH6UG">상기내용 참고한 서울경제 기사링크</a><br> <a href="https://blog.naver.com/vvvtg/223231778959">거래증거금vs위탁증거금 내용 참고할 수 있는 블로그</a></p>
</blockquote>
<ul>
<li><p>장내거래 vs 장외거래 : 정규시장 외 체결되는 거래</p></li>
<li><p>매크로 지식 : Macro economics지식 (↔︎ Micro economics)</p></li>
<li><p>서킷브레이커(일시매매정지, Trading Curb) : 가격 변동이 지나친 경우 일시적으로 거래를 중단하는 것</p></li>
<li><p>틱 : 체결량에 따른 단위 (5틱 = 체결 5회 기준)</p></li>
<li><p>셀사이드(Sell-side|은행, 증권사 등) : 금융 서비스 등을 제공하여 수익 창출</p></li>
<li><p>바이사이드(Buy-side|자산운용사, 연기금, 보험사, 헤지펀드 등) : 투자를 하여 수익 창출</p></li>
</ul>
<blockquote class="blockquote">
<p><a href="https://brunch.co.kr/@quantdaddy/34">참고글:셀사이드와 바이사이드의 금융공학</a></p>
</blockquote>
<ul>
<li>하우스 : 증권사, 금융사 등 단체를 칭함</li>
</ul>
</section>
<section id="빅데이터-직무-단어정리" class="level2">
<h2 class="anchored" data-anchor-id="빅데이터-직무-단어정리">빅데이터 직무 단어정리</h2>
<ul>
<li>MTS : Mobile Trading System (HTS : Home Trading System)</li>
<li>원장 : 증권사가 고객계좌나 거래내역, 매매 등을 관리하는 프로그램</li>
</ul>


</section>

<p><br><strong>Copyright © 2024 Kibok Park All rights reserved.</strong><br></p> ]]></description>
  <category>직무분석</category>
  <guid>https://kr9268.github.io/posts/vba-noname-yyyymmdd/</guid>
  <pubDate>Sun, 28 Apr 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>[버크셔 해서웨이의 재탄생 읽고] 용어 정리</title>
  <dc:creator>Kibok Park</dc:creator>
  <link>https://kr9268.github.io/posts/bk-BerkshireHathaway-20240423-terms/</link>
  <description><![CDATA[ 





<p><strong>공부할 겸 혼자서 구글링하면서 용어 정리해보는 포스팅입니다</strong></p>
<section id="프롤로그" class="level2">
<h2 class="anchored" data-anchor-id="프롤로그">프롤로그</h2>
<ul>
<li><p><strong>경제적 해자(enonomic moat)</strong> : 성 외곽에서 성을 보호해주는 해자처럼 경쟁우위를 갖게 해주는 요소 (a business’s ability to maintain a competitive edge over its competitors)</p></li>
<li><p><strong>자본배분(capital allocation)</strong> : 경제적 자원들을 효율증대/이익극대화를 위해 분배/투자 하는 것 (distributing and investing a company’s financial resources in ways that will increase its efficiency, and maximize its profits) &gt; 자본배분을 알면 워런버핏 사례의 캐피털시티를 이해할 수 있다</p></li>
<li><p><strong>플로트(float, 책임준비금)</strong> : 보험회사가 보험금을 지급하기 위해 적립시키는 돈(은행과 달리 자산운용준칙에 따라 자율적으로 사용 가능)</p>
<ul>
<li>플로트라는 단어의 다른 뜻 : 일반 대중이 거래할 수 있게 발행한 보통주 (the regular shares a company has issued to the public that are available for investors to trade) &gt; 플로트를 알면 워런버핏 사례의 가이코를 이해할 수 있다 (내셔널 인뎀너티와 블루칩스탬프의 플로트를 활용한 투자법 등)</li>
</ul></li>
<li><p><strong>재보험</strong> : 보험계약상 책임의 전부 또는 일부를 다른 보험자에게 인수시킴 (위험의 분산과 인수능력의 극대화를 위해 필요, 위험 대비 자산이 충분치 않은 경우 재보험으로 보험금액의 전부 인수가능)</p></li>
<li><p><strong>영업이익(operating income/earnings)</strong> : 기업의 핵심사업(영업활동)으로 얻은 이익 (a measure of the amount of profit realized from a business’s core operations)</p></li>
<li><p><strong>연간 영업활동 순이익(operating earnings)</strong> : 영업활동에 필요한 차입금 등 부채의 이자비용도 차감한 이익(영업활동에서 발생한 순이익)</p></li>
<li><dl>
<dt><strong>일반 회계기준(GAAP, Generally Accepted Accounting Principles, GAAP)</strong></dt>
<dd>
일반적으로 인정된 회계원칙. 회계규정 자체 또는 회계실무 지침 등 광범위하게 인정되는 회계기준 &gt; GAAP관련 추가로 알아보기
</dd>
</dl></li>
<li><p>**IFRS(International&nbsp;Financial&nbsp;Reporting&nbsp;Standards) : 국제회계기준위원회에서 공표한 회계기준. IFRS를 공부하면 IFRS를 차용한 국가의 회사 재무제표는 같은 형식으로 이해 가능</p></li>
<li><dl>
<dt><strong>규칙기반의 GAAP vs 원칙기반의 IFRS</strong></dt>
<dd>
IFRS는 원칙에 따라 작성해 형태 차이가 거의 없으나, GAAP는 세부적인 사안에 대해 자세히 기술(IFRS도 주석 부분에 기술)
</dd>
<dd>
내용을 세세하게 다루거나, 공정가치를 계산하지않아 IFRS보다 현재가치를 크게 하고 싶을때 GAAP사용
</dd>
</dl></li>
<li><dl>
<dt><strong>Non-GAAP</strong></dt>
<dd>
반복적으로 발생하지 않는 1회적 비용은 제외하고 회계처리. 비용이 줄어 순수익이 늘어남
</dd>
<dd>
미국의 경우 Non-GAAP로 다양한 비용을 제외시켜 표시하는 것이 불법은 아님(기업에 유리) <a href="https://muroyallife.tistory.com/entry/GAAP%EA%B3%BC-IFRS%EC%9D%98-%EC%B0%A8%EC%9D%B4-%EA%B7%B8%EB%9F%AC%EB%A9%B4-Non-GAAP%EC%9D%80-%EB%AD%90%EC%95%BC">참고한 링크</a>
</dd>
</dl></li>
</ul>
</section>
<section id="장.-섬유공장" class="level2">
<h2 class="anchored" data-anchor-id="장.-섬유공장">1장. 섬유공장</h2>
<blockquote class="blockquote">
<ul>
<li><strong>총자산이익률(ROA, Return on assets)</strong> : 순이익 / 총자산(자기자본 + 타인자본). 얼마나 순이익이 창출되는지 판단할 수 있음. ROA의 높고 낮음에 따라 주가의 높낮이도 따를 가능성이 큼 산업의 성숙기[성장/성숙/사양 등]에 따라 ROA는 달라질 수 있음</li>
<li><strong>자기자본이익률(ROE, Return on equity)</strong> : 순이익 / 자본총계(자산-부채) ROA가 높은 경우 적정 수준으로 부채확대를 통해 총자산 자체를 늘리면 ROE를 높일 수 있음 <a href="https://m.itooza.com/view.php?ud=2011052715374391424">참고한 링크</a> <a href="https://support.stockplus.com/hc/ko/articles/5059590236057-%EA%B8%B0%EC%97%85%EC%9D%B4-%EB%8F%88%EC%9D%84-%EC%9E%98-%EB%B2%8C%EA%B9%8C-ROE-%EA%B8%B0%EC%B4%88">참고한 링크</a></li>
</ul>
</blockquote>
<ul>
<li><p><strong>운전자본(Working Capital, =유동자본?)</strong> : 회사를 운영하는데 들어가는 돈(매출채권, 선급금, 재고자산 등 유동자산과 매입채무, 선수금 등 유동부채가 해당함)</p></li>
<li><p>순운전자본(Net Working Capital, 운전자본-총부채) : ?? (클럽 설명) 벤자민 그레이엄이 ’현명한 투자자’에서 주창한 투자 전략 즉시 현금화할 수 있는 자산과 비교함으로써 보수적인 기준에서 주가의 저(고)평가 여부를 판단하는 척도로 사용</p></li>
<li><p>장부가치</p></li>
<li><p>주가순자산배수(PBR, price to book value)</p></li>
<li><p>주주환원</p></li>
<li><p>자사주 매입</p></li>
<li><p>감가상각비</p></li>
<li><p>자산 대체원가</p></li>
<li><p>무형자산상각비 차감 전 이익(EBITDA)</p></li>
<li><p>투하자본</p></li>
<li><p>투하자본이익률(ROIC, return on invested capital)</p></li>
<li><p>배당의 이중과세 : 연간이익에 대한 기업의 법인세 + 배당금에 대한 주주의 소득세</p></li>
<li><p>자사주 매입을 통한 주주의 세금 이연(은 주주이익에 도움)</p></li>
</ul>
</section>
<section id="장.-투자-1962-1965년" class="level2">
<h2 class="anchored" data-anchor-id="장.-투자-1962-1965년">2장. 투자: 1962-1965년</h2>
<ul>
<li><strong>무한책임 파트너(general partner)</strong> : 펀드 운용에 관한 무한책임을 지는 출자자, 보통 운용자를 말함</li>
<li><strong>헤지펀드</strong> :</li>
<li><strong>환매</strong> :</li>
<li><strong>이월결손금</strong></li>
<li><strong>손익계산서</strong></li>
<li><strong>유동성소요</strong></li>
<li>**내재 사업가치(intrinsic business value)</li>
<li><strong>유한책임조합</strong></li>
</ul>
</section>
<section id="장.-전환-1965-1967년" class="level2">
<h2 class="anchored" data-anchor-id="장.-전환-1965-1967년">3장. 전환: 1965-1967년</h2>
<ul>
<li><strong>자본배분</strong></li>
<li><strong>투하자본이익률</strong></li>
<li><strong>매출원가</strong></li>
<li><strong>특별항목 (’특별항목 반영 전 순이익’에서 사용된 의미, ’1964년 특별항목은 유휴설비비용 22만 달러를 포함했다’와 같이 사용)</strong></li>
<li><strong>유휴설비비용(idle plant expense)</strong>: 비영업용 제조설비의 유지보수 및 감가상각비</li>
<li>**기대손실</li>
<li>손상차손 write-down</li>
<li>유형자산 손상차손</li>
<li>이익잉여금</li>
<li>총포괄손익</li>
<li>총창출자본(total capital generated)</li>
</ul>
</section>
<section id="장.-인수-1967-1969년" class="level2">
<h2 class="anchored" data-anchor-id="장.-인수-1967-1969년">4장. 인수: 1967-1969년</h2>
<ul>
<li>완전 소유 기업(wholly-owned-subsidiary) : 1개 기업이 단독 투자하여 100% 소유 지문을 가지는것</li>
<li>상환청구권 :</li>
</ul>
<blockquote class="blockquote">
<p>플로트(책임준비금) : + 지급준비금(lost reserve) + 손해사정비 준비금(lost adjustment expense reserve) + 미경과보험료 적립금(unearned premium reserve) - 대리점 미수금(agents’ balance) - 선급 신계약비(prepaid acquisition cost) - 출재보험 준비금(deferred charges applicable to assumed reinsurance) * 플로트 계산법은 분석대상 기업과 애널리스트에 따라 다름 * 기타자산과 기타부채를 처리하는 방법에서 차이가 발생함 * 정확한 플로트 값이 중요하지 않음(소수점 마지막까지 계산X) *</p>
</blockquote>
<ul>
<li><p>합산비율(combined ratio) : 손해율 + 사업비율. 100%를 기준으로 높으면 손해 낮으면 이익</p></li>
<li><p>손해율(loss ratio) : 보험료 수입 대비 보험금 지급 비율</p></li>
<li><p>사업비율(expense ratio) : 보험료 수입 중 인건비, 마케팅비, 모집수수료, 중개비 등 비중</p></li>
<li><p>경과보험료(earned premiums) : 1년단위/일시납이 기본인 손해보험업에서 더 유의미한 기준. 보험사의 회계연도 말을 기준으로 가입자의 전체 보험기간을 경과/미경과 기간으로 구분, 받은 보험료를 경과/미경과 보험료로 구분함</p></li>
<li><p>레버리지 :</p></li>
<li><p>영업 레버리지(operating leverage)</p></li>
<li><p>재무 레버리지(financial leverage)</p></li>
<li><p>유형순자산(tangible net worth)</p></li>
<li><p>영업권(goodwill)</p></li>
<li><p>원수보험료</p></li>
<li><p>순원수보험료(net premiums written) : 원수보험료에서 수/출재보험료와 환급보험료를 가감한 값</p></li>
<li><p>비연결자회사</p></li>
<li><p>연결납세제도(consolidated tax return) : 모회사의 자회사 지분율이 80%이상이고 경제적으로 결합되어있을 때 하나의 과세단위로 해석함. 이에 따라 모회사-자회사간 배당을 과세하지 않을때가 있음. 한국에도 도입되어있지만 연결 요건이 엄격함</p></li>
<li><p>예수부채</p></li>
<li><p>요구불예금</p></li>
<li><p>스핀오프 : 자회사 주식을 모회사 주주에게 배당(인적분할) + 기존 회사의 자회사화</p></li>
<li><p>투자 영업이익 : 이자 및 배당수익 + 유가증권 추분이익</p></li>
</ul>
</section>
<section id="장.-확장-1970년대" class="level2">
<h2 class="anchored" data-anchor-id="장.-확장-1970년대">5장. 확장: 1970년대</h2>
<ul>
<li><p>투하자본</p></li>
<li><p>매출채권</p></li>
<li><p>부채자기자본비율(debt to equity)</p></li>
<li><p>표면이자율</p></li>
<li><p>일반사채(debenture:무담보회사채)</p></li>
<li><p>이자비용 및 법인세 차감 전 이익(EBIT)</p></li>
<li><p>주가매출액배수(price to sales, PSR) : 기업의 주가와 매출을 비교하는 가치평가 지표</p></li>
<li><p>예상손해율(loss expectancy)</p></li>
<li><p>보험영업 손실/이익</p></li>
<li><p>듀레이션(duration, 듀레이션이 긴 재보험에서의 용례)</p></li>
</ul>
</section>
<section id="장.-다른-기업들" class="level2">
<h2 class="anchored" data-anchor-id="장.-다른-기업들">6장. 다른 기업들</h2>
<ul>
<li>공모채 : 불특정다수에게 발행하는 채권</li>
<li>사용자본이익률(ROCE)</li>
<li>최초 이익수익률(initial earnings yield)</li>
<li>모기지(mortgate) : 주택 구매 등을 위해 돈을 빌리고, 갚지 못하는 경우 해당 주택을 대출 업체가 소유</li>
<li>예대마진(spread) : 예금이자와 대출이자간 차이</li>
<li>예수부채 : 불특정 다수를 상대로 조달한 자금</li>
<li>차입인수(LBO, leverage buyout) : 인수할 회사의 자본 등을 담보로 자금을 확보하여 기업을 인수</li>
</ul>
</section>
<section id="장.-복합기업" class="level2">
<h2 class="anchored" data-anchor-id="장.-복합기업">7장. 복합기업</h2>
<ul>
<li>자본잉여금(paid-in surplus) : 주식 발행 등으로 발생하는 잉여금. 돈을 받고 주식을 발행하는 유상증자시 늘어나게 됨</li>
</ul>


</section>

<p><br><strong>Copyright © 2024 Kibok Park All rights reserved.</strong><br></p> ]]></description>
  <category>경제/금융공부</category>
  <guid>https://kr9268.github.io/posts/bk-BerkshireHathaway-20240423-terms/</guid>
  <pubDate>Tue, 23 Apr 2024 00:00:00 GMT</pubDate>
  <media:content url="https://kr9268.github.io/posts/bk-BerkshireHathaway-20240423-terms/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>[Pytorch] MNIST 실습</title>
  <dc:creator>Kibok Park</dc:creator>
  <link>https://kr9268.github.io/posts/coach-ml-20240505/</link>
  <description><![CDATA[ 





<section id="pytorch활용한-mnist-데이터셋-로딩" class="level2">
<h2 class="anchored" data-anchor-id="pytorch활용한-mnist-데이터셋-로딩">Pytorch활용한 MNIST 데이터셋 로딩</h2>
<div id="fig-polar" class="cell quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-polar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="fig-polar" style="background: #f1f3f5;"><pre class="sourceCode python cell code-with-copy"><code class="sourceCode python"><span id="fig-polar-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="fig-polar-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch.nn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> nn</span>
<span id="fig-polar-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch.utils.data <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DataLoader</span>
<span id="fig-polar-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torchvision</span>
<span id="fig-polar-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torchvision.datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> dset</span>
<span id="fig-polar-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torchvision.transforms <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> transforms</span>
<span id="fig-polar-7"></span>
<span id="fig-polar-8">root <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'./data'</span></span>
<span id="fig-polar-9">mnist_train <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dset.MNIST (root<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>root, train<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, transform<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>transforms.ToTensor(), download<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span> )</span>
<span id="fig-polar-10">mnist_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dset.MNIST (root<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>root, train<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, transform<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>transforms.ToTensor(), download<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="fig-polar-11"></span>
<span id="fig-polar-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Train용 / Test용 데이터셋</span></span>
<span id="fig-polar-13">train_loader <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(mnist_train, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, shuffle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="fig-polar-14">test_loader <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataLoader(mnist_test, batch_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, shuffle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-polar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
</section>
<section id="학습준비가중치-초기화-등" class="level2">
<h2 class="anchored" data-anchor-id="학습준비가중치-초기화-등">학습준비(가중치 초기화 등)</h2>
<ul>
<li>MNIST의 크기 : 28 * 28</li>
<li>Loss : Cross Entropy</li>
<li>Optimizer - SGD(Stochastic Gradient Descent)</li>
<li>Learning rate = 0.1</li>
</ul>
<div id="db135b1a" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1">device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.device(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> torch.cuda.is_available() <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cpu'</span>)</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 모델 구현 (28*28 = 784 / 0~9라서 10개 / 가중치 사용하므로 bias)</span></span>
<span id="cb1-4">linear <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.nn.Linear(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">784</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, bias<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>).to(device) </span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># weight init 가중치 초기화</span></span>
<span id="cb1-7">torch.nn.init.normal_(linear.weight)</span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loss fn - Cross Entropy Loss</span></span>
<span id="cb1-10">criterion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.nn.CrossEntropyLoss().to(device)</span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># optimizer - SGD</span></span>
<span id="cb1-13">optimizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.optim.SGD(linear.parameters(), lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span></code></pre></div>
</div>
</section>
<section id="모델-학습" class="level2">
<h2 class="anchored" data-anchor-id="모델-학습">모델 학습</h2>
<div id="683a020b" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1">training_epochs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># training 반복 횟수</span></span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> epoch <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(training_epochs):</span>
<span id="cb2-4">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, (imgs, labels) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(train_loader):</span>
<span id="cb2-5">    labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> labels.to(device)</span>
<span id="cb2-6">    imgs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> imgs.view(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>).to(device)</span>
<span id="cb2-7"></span>
<span id="cb2-8">    outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> linear(imgs) </span>
<span id="cb2-9">    loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> criterion(outputs, labels) </span>
<span id="cb2-10"></span>
<span id="cb2-11">    optimizer.zero_grad()<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># optimzier zero grad</span></span>
<span id="cb2-12"></span>
<span id="cb2-13">    loss.backward() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># loss backward</span></span>
<span id="cb2-14">    optimizer.step() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># optimzier step</span></span>
<span id="cb2-15"></span>
<span id="cb2-16">    _,argmax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(outputs, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-17">    accuracy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> argmax).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>().mean()</span>
<span id="cb2-18"></span>
<span id="cb2-19">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb2-20">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Epoch [</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">], Step [</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">], Loss: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{: .4f}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">, Accuracy: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{: .2f}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">%'</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(</span>
<span id="cb2-21">    epoch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, training_epochs, i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(train_loader), loss.item(), accuracy.item()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/20], Step [6000/6000], Loss:  0.0273, Accuracy:  100.00%
Epoch [2/20], Step [6000/6000], Loss:  0.0762, Accuracy:  100.00%
Epoch [3/20], Step [6000/6000], Loss:  0.5928, Accuracy:  80.00%
Epoch [4/20], Step [6000/6000], Loss:  0.2854, Accuracy:  90.00%
Epoch [5/20], Step [6000/6000], Loss:  0.1373, Accuracy:  90.00%
Epoch [6/20], Step [6000/6000], Loss:  0.0668, Accuracy:  100.00%
Epoch [7/20], Step [6000/6000], Loss:  0.0253, Accuracy:  100.00%
Epoch [8/20], Step [6000/6000], Loss:  0.0542, Accuracy:  100.00%
Epoch [9/20], Step [6000/6000], Loss:  0.9203, Accuracy:  80.00%
Epoch [10/20], Step [6000/6000], Loss:  0.1244, Accuracy:  90.00%
Epoch [11/20], Step [6000/6000], Loss:  0.6108, Accuracy:  90.00%
Epoch [12/20], Step [6000/6000], Loss:  0.1312, Accuracy:  100.00%
Epoch [13/20], Step [6000/6000], Loss:  0.0705, Accuracy:  100.00%
Epoch [14/20], Step [6000/6000], Loss:  1.6259, Accuracy:  70.00%
Epoch [15/20], Step [6000/6000], Loss:  0.0538, Accuracy:  100.00%
Epoch [16/20], Step [6000/6000], Loss:  0.2435, Accuracy:  80.00%
Epoch [17/20], Step [6000/6000], Loss:  0.0061, Accuracy:  100.00%
Epoch [18/20], Step [6000/6000], Loss:  0.1091, Accuracy:  100.00%
Epoch [19/20], Step [6000/6000], Loss:  0.0157, Accuracy:  100.00%
Epoch [20/20], Step [6000/6000], Loss:  0.1413, Accuracy:  90.00%</code></pre>
</div>
</div>
</section>
<section id="학습된-모델-테스트" class="level2">
<h2 class="anchored" data-anchor-id="학습된-모델-테스트">학습된 모델 테스트</h2>
<div id="1d05ac8c" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">linear.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb4-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb4-3">    correct <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb4-4">    total <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb4-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, (imgs, labels) <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(test_loader):</span>
<span id="cb4-6">        imgs, labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> imgs.to(device), labels.to(device)</span>
<span id="cb4-7">        imgs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> imgs.view(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>)</span>
<span id="cb4-8"></span>
<span id="cb4-9">        outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> linear(imgs) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 구현</span></span>
<span id="cb4-10"></span>
<span id="cb4-11">        _, argmax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(outputs, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># max()를 통해 최종 출력이 가장 높은 class 선택</span></span>
<span id="cb4-12">        total <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> imgs.size(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-13">        correct <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> (labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> argmax). <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>().item()</span>
<span id="cb4-14"></span>
<span id="cb4-15">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Test accuracy for </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> images: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{: .2f}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">%'</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">format</span>(total, correct <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test accuracy for 10000 images:  91.99%</code></pre>
</div>
</div>


</section>

<p><br><strong>Copyright © 2024 Kibok Park All rights reserved.</strong><br></p> ]]></description>
  <category>파이썬, 머신러닝</category>
  <guid>https://kr9268.github.io/posts/coach-ml-20240505/</guid>
  <pubDate>Sun, 19 Feb 2023 00:00:00 GMT</pubDate>
</item>
</channel>
</rss>
