<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kibok Park">
<meta name="dcterms.date" content="2025-01-05">

<title>[DA스터디/3주차] EDA 및 전처리 이론(+금융데이터 특징) – Blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../profile.jpg" rel="icon" type="image/jpeg">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-04dd6a5ca28aac96903e51a8fbffbcaa.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-eadd22555550656e957725f4adb214c0.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/watermark-1.0.11/watermark.min.js"></script>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-LPL499WQBH"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-LPL499WQBH', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index_dashboards.html"> 
<span class="menu-text">Dashboards</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../index_miniprojects.html"> 
<span class="menu-text">Mini Projects</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/KR9268"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/%EA%B8%B0%EB%B3%B5-%EB%B0%95-573a68268/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">[DA스터디/3주차] EDA 및 전처리 이론(+금융데이터 특징)</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Python</div>
                <div class="quarto-category">EDA</div>
                <div class="quarto-category">Preprocessing</div>
                <div class="quarto-category">202412Study_DataAnalysis</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Kibok Park </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 5, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#개요" id="toc-개요" class="nav-link active" data-scroll-target="#개요">개요</a></li>
  <li><a href="#주차-수업정리" id="toc-주차-수업정리" class="nav-link" data-scroll-target="#주차-수업정리">3주차 수업정리</a>
  <ul class="collapse">
  <li><a href="#금융데이터" id="toc-금융데이터" class="nav-link" data-scroll-target="#금융데이터">금융데이터</a>
  <ul class="collapse">
  <li><a href="#금융데이터의-특징" id="toc-금융데이터의-특징" class="nav-link" data-scroll-target="#금융데이터의-특징">금융데이터의 특징</a></li>
  <li><a href="#금융데이터-분야의-과제" id="toc-금융데이터-분야의-과제" class="nav-link" data-scroll-target="#금융데이터-분야의-과제">금융데이터 분야의 과제</a></li>
  </ul></li>
  <li><a href="#eda-이론" id="toc-eda-이론" class="nav-link" data-scroll-target="#eda-이론">EDA 이론</a></li>
  <li><a href="#전처리-이론" id="toc-전처리-이론" class="nav-link" data-scroll-target="#전처리-이론">전처리 이론</a>
  <ul class="collapse">
  <li><a href="#결측이상값-처리" id="toc-결측이상값-처리" class="nav-link" data-scroll-target="#결측이상값-처리">결측/이상값 처리</a></li>
  <li><a href="#표준화정규화" id="toc-표준화정규화" class="nav-link" data-scroll-target="#표준화정규화">표준화/정규화</a></li>
  <li><a href="#변환" id="toc-변환" class="nav-link" data-scroll-target="#변환">변환</a></li>
  <li><a href="#인코딩" id="toc-인코딩" class="nav-link" data-scroll-target="#인코딩">인코딩</a></li>
  <li><a href="#구간화" id="toc-구간화" class="nav-link" data-scroll-target="#구간화">구간화</a></li>
  </ul></li>
  <li><a href="#기초통계-등-확인하기" id="toc-기초통계-등-확인하기" class="nav-link" data-scroll-target="#기초통계-등-확인하기">기초통계 등 확인하기</a>
  <ul class="collapse">
  <li><a href="#데이터패키지-로딩-및-자료형-등-확인" id="toc-데이터패키지-로딩-및-자료형-등-확인" class="nav-link" data-scroll-target="#데이터패키지-로딩-및-자료형-등-확인">데이터/패키지 로딩 및 자료형 등 확인</a></li>
  <li><a href="#통계적-수치-확인" id="toc-통계적-수치-확인" class="nav-link" data-scroll-target="#통계적-수치-확인">통계적 수치 확인</a></li>
  </ul></li>
  <li><a href="#실습1-확인한-통계량을-가지고-시각화-고민하기" id="toc-실습1-확인한-통계량을-가지고-시각화-고민하기" class="nav-link" data-scroll-target="#실습1-확인한-통계량을-가지고-시각화-고민하기">실습1 : 확인한 통계량을 가지고 시각화 고민하기</a></li>
  <li><a href="#시각화" id="toc-시각화" class="nav-link" data-scroll-target="#시각화">시각화</a>
  <ul class="collapse">
  <li><a href="#histogram" id="toc-histogram" class="nav-link" data-scroll-target="#histogram">Histogram</a></li>
  <li><a href="#실습2-시각화-실습" id="toc-실습2-시각화-실습" class="nav-link" data-scroll-target="#실습2-시각화-실습">실습2 : 시각화 실습</a></li>
  <li><a href="#barplot" id="toc-barplot" class="nav-link" data-scroll-target="#barplot">Barplot</a></li>
  <li><a href="#실습3" id="toc-실습3" class="nav-link" data-scroll-target="#실습3">실습3</a></li>
  <li><a href="#boxplot" id="toc-boxplot" class="nav-link" data-scroll-target="#boxplot">Boxplot</a></li>
  <li><a href="#lineplot" id="toc-lineplot" class="nav-link" data-scroll-target="#lineplot">lineplot</a></li>
  <li><a href="#heatmap" id="toc-heatmap" class="nav-link" data-scroll-target="#heatmap">Heatmap</a></li>
  </ul></li>
  <li><a href="#실습4-시각화-결과를-바탕으로-전처리-고민하기" id="toc-실습4-시각화-결과를-바탕으로-전처리-고민하기" class="nav-link" data-scroll-target="#실습4-시각화-결과를-바탕으로-전처리-고민하기">실습4 : 시각화 결과를 바탕으로, 전처리 고민하기</a></li>
  <li><a href="#전처리" id="toc-전처리" class="nav-link" data-scroll-target="#전처리">전처리</a>
  <ul class="collapse">
  <li><a href="#이상값-결측값-처리" id="toc-이상값-결측값-처리" class="nav-link" data-scroll-target="#이상값-결측값-처리">이상값, 결측값 처리</a></li>
  <li><a href="#표준화-정규화" id="toc-표준화-정규화" class="nav-link" data-scroll-target="#표준화-정규화">표준화 / 정규화</a></li>
  <li><a href="#변환-1" id="toc-변환-1" class="nav-link" data-scroll-target="#변환-1">변환</a></li>
  <li><a href="#실습-5" id="toc-실습-5" class="nav-link" data-scroll-target="#실습-5">실습 5</a></li>
  <li><a href="#인코딩-1" id="toc-인코딩-1" class="nav-link" data-scroll-target="#인코딩-1">인코딩</a></li>
  <li><a href="#실습6" id="toc-실습6" class="nav-link" data-scroll-target="#실습6">실습6</a></li>
  <li><a href="#구간화-1" id="toc-구간화-1" class="nav-link" data-scroll-target="#구간화-1">구간화</a></li>
  <li><a href="#과제" id="toc-과제" class="nav-link" data-scroll-target="#과제">과제</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>금융권 데이터를 활용한 분석 스터디 - 1주차</p>
<section id="개요" class="level1">
<h1>개요</h1>
<ul>
<li>아래의 목적/이유로 참가한 스터디에 대한 기록
<ul>
<li>SQLD취득 후 장기 미사용 &amp; GPT를 통한 SQL사용 등으로 많이 잊은 SQL을 복기</li>
<li>기존에 사용해 본 Optuna가 아닌 Autogluon이 커리큘럼에 있어 익혀보고자 함</li>
<li>기존에 관심있던 XAI(설명가능한 AI)를 익히고자 함</li>
</ul></li>
<li>3주차 요약
<ul>
<li>금융데이터의 특징 및 케이스</li>
<li>EDA : 통계적 수치 확인과 시각화</li>
<li>전처리 : 결측치/이상치 처리, 표준화, 정규화, 인코딩 등</li>
</ul></li>
<li>참고사항 : 전부 보여야하는 데이터 외에는 head로 일부데이터만 표시</li>
</ul>
</section>
<section id="주차-수업정리" class="level1">
<h1>3주차 수업정리</h1>
<section id="금융데이터" class="level2">
<h2 class="anchored" data-anchor-id="금융데이터">금융데이터</h2>
<section id="금융데이터의-특징" class="level3">
<h3 class="anchored" data-anchor-id="금융데이터의-특징">금융데이터의 특징</h3>
<ul>
<li>정형성 : tabular데이터 형태로 적재, 최근 비정형 데이터 증가 추세
<ul>
<li>별도의 스키마에 저장되어 있음</li>
</ul></li>
<li>대규모 : 일 단위 적재데이터의 단위가 페타 바이트에 육박
<ul>
<li>Trino나 Presto등 대규모 처리 특화언어를 사용하게 됨</li>
</ul></li>
<li>민감성 : 금융 당국의 규제, 보안에 대한 높은 수준요구
<ul>
<li>데이터별 접근권한, 모든 조회기록 로그 등</li>
</ul></li>
<li>폐쇄성 : 폐쇠망에서 처리되는 경우가 많음. AWS 등을 사용해도 Grey zone형태로 구축
<ul>
<li>외부와 내부 폐쇄망 사이의 grey zone을 정보보호 및 IT인력이 관리</li>
</ul></li>
<li>불균형성 : Target(Y)의 정보가 불균형</li>
</ul>
</section>
<section id="금융데이터-분야의-과제" class="level3">
<h3 class="anchored" data-anchor-id="금융데이터-분야의-과제">금융데이터 분야의 과제</h3>
<ul>
<li>최근 채용공고 기반의 금융데이터 관련 과제
<ul>
<li>고객 행동 분석 및 예측
<ul>
<li>카드추천알고리즘, 이탈예측, 고객 클러스터링 등</li>
</ul></li>
<li>리스크 관리 및 신용평가
<ul>
<li>대출 상환 가능성 예측, 이상거래 탐지 등</li>
</ul></li>
<li>데이터 기반 마케팅 최적화</li>
<li>비정형 데이터 분석
<ul>
<li>콜센터상담 피드백분석, SNS데이터 감성분석 등</li>
</ul></li>
</ul></li>
<li>실무케이스 예시(회사별로 다름)
<ul>
<li>협업Case : PM급 메인리더와 팀원의 협업
<ul>
<li>리더가 데이터마트 설계, 팀원이 데이터마트 구축/완성</li>
<li>모델링 작업, 앙상블 등의 베스트모델이나 기법을 각자 다른 방향으로 진행해봄</li>
</ul></li>
<li>개인작업Case
<ul>
<li>퀀트같은 경우는 개인별로 시장 데이터 등을 분석하여 각자 전략구축</li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="eda-이론" class="level2">
<h2 class="anchored" data-anchor-id="eda-이론">EDA 이론</h2>
<ul>
<li>EDA : 데이터가 어떻게 생겼는지, 통계적 수치의 확인 및 시각화 진행
<ul>
<li>평균/중앙값</li>
<li>최대/최소값</li>
<li>사분위수</li>
<li>왜도/첨도</li>
<li>이상/결측치</li>
<li>불균형도</li>
<li>상관계수</li>
<li>최빈값</li>
<li>카테고리 개수, 카테고리별 개수</li>
</ul></li>
<li>데이터에 따른 시각화 기법
<ul>
<li>Bar plot : 범주형 변수</li>
<li>Histogram : 연속형 변수 분포, 불균형도/왜도 분포, Y값의 분포</li>
<li>Line plot : 시계열 데이터의 분포, 시계열성 확인</li>
<li>Box plot : 이상치 확인, 일반적인 변수의 분포</li>
<li>Heatmap : Y와의 상관계수, 다중공선성 확인
<ul>
<li>다중공선성은, 회귀분석에서의 기본가정인 독립 변수는 서로 독립적이어야 한다는 가정을 지킬 수 있는지 등을 확인하여 분석결과의 신뢰도를 높이고자 확인</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="전처리-이론" class="level2">
<h2 class="anchored" data-anchor-id="전처리-이론">전처리 이론</h2>
<ul>
<li>전처리 종류
<ul>
<li>결측/이상값 처리</li>
<li>표준화(Standardization)</li>
<li>정규화(Normalization)</li>
<li>변환(Transformation)</li>
<li>인코딩</li>
<li>구간화(Binning)</li>
</ul></li>
</ul>
<section id="결측이상값-처리" class="level3">
<h3 class="anchored" data-anchor-id="결측이상값-처리">결측/이상값 처리</h3>
<ul>
<li>결측이 많지않다면 삭제할 수도 있으나, 일반적으로는 대체를 활용
<ul>
<li>Mean/Median Imputation: 수치형 변수 대체시 주로 사용
<ul>
<li>평균/중앙값 중 어느 것을 쓸지는 데이터의 분포를 보고 결정</li>
</ul></li>
<li>Mode Imputation: 범주형 변수 대체시 주로 사용</li>
<li>Zero Imputation : 0으로 대체(또는 -999처럼 특정값 사용)</li>
<li>Interpolation(보간법) : 시계열 데이터에서 전후 데이터를 활용
<ul>
<li>KNN이나 ML활용도 가능하지만 잘 사용되지 않았으나, AutoML의 발전으로 활용성이 높아짐
<ul>
<li>y를 예측하기 위해, x를 또 예측한다는 점에서 비효율적이었으나, AutoML 등의 발전으로 효율성이 높아짐</li>
</ul></li>
</ul></li>
</ul></li>
<li>이상값은 수가 적거나 예측에 해가 되는 경우가 많아 종종 삭제함
<ul>
<li>유효성 검증이 되지 않아 생년월일 1800년대, 200살로 나오는 경우 등</li>
<li><strong>이상값이 유의미한 인사이트를 제공하는 경우</strong>도 있음
<ul>
<li>이상값을 결측값으로 대체한 뒤, is_outlier같은 추가변수 만들어줌</li>
<li>변환을 통해 값의 분산을 줄이기도 함</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="표준화정규화" class="level3">
<h3 class="anchored" data-anchor-id="표준화정규화">표준화/정규화</h3>
<ul>
<li>표준화 vs 정규화
<ul>
<li>표준화 : 데이터를 평균 0, 표준편차 1의 정규분포로 수정</li>
<li>정규화 : 0~1 또는 -1~1의 분포로 수정</li>
</ul></li>
<li>특성의 크기(Scale)의 차이로 인한 편향을 막기위해 사용
<ul>
<li>AI학습에서 Loss를 줄일 때, 변수 간의 Scale이 다르면 loss 및 학습에 영향이 생겨 성능저하가 일어날 수 있음</li>
</ul></li>
<li><strong>트리 기반의 알고리즘을 제외한 거의 대부분은 표준화/정규화 필요</strong></li>
<li>전통적으로 ML분야에서는 표준화를 선호하는 경향이 강함
<ul>
<li>When in doubt, just standardize the data, it shouldn’t hurt</li>
</ul></li>
</ul>
</section>
<section id="변환" class="level3">
<h3 class="anchored" data-anchor-id="변환">변환</h3>
<ul>
<li>로그 변환, 로트 변환, Box-cox변환 등이 있음
<ul>
<li>Box-cox변환은, λ로 로그/제곱근 변환 등을 하나의 수식으로 표현가능한 ’일반화’된 변환 방법</li>
</ul></li>
<li>예를 들어, 왜도가 큰 경우 변환을 통해 낮추면 성능향상에 도움
<ul>
<li><strong>양의 왜도</strong>(오른쪽으로 치우짐)의 경우 변환을 통해 그 정도를 낮춤</li>
<li><strong>음의 왜도</strong>인 경우, 적당히 큰 값에서 데이터를 빼준 뒤 다시 변환
<ul>
<li>단순 로그변환시 더 커지므로, 적당히 큰 값(Min/Max)을 빼줌</li>
</ul></li>
<li><strong>데이터범위가 너무 넓은 경우, 루트 변환</strong>으로 분산을 줄여줌</li>
<li>캐글의 타이타닉 문제에서, y의 로그변환만 해도 정확도가 3%정도 오르는 케이스도 있음</li>
<li>ML은 통계학의 변환이라는 관점에서, 통계학은 정규성을 가정하는 경우가 많아 적절한 변환은 성능에 도움되는 경우가 많음</li>
</ul></li>
</ul>
</section>
<section id="인코딩" class="level3">
<h3 class="anchored" data-anchor-id="인코딩">인코딩</h3>
<ul>
<li>수치형이 아닌 변수를 수치로 변환
<ul>
<li>One-hot Encoding : 범주형 변수의 Unique값을 변수(컬럼)로 변환
<ul>
<li>Sparcity증가의 문제(데이터 Loss는 없지만 학습이 오래걸림)</li>
</ul></li>
<li>Label Encoding : 범주형 변수의 값을 숫자로 변환
<ul>
<li>상하관계가 없는 데이터를 있다고 착각할 수 있음(상하관계없는 데이터에 1~3 부여 후 3이 높다고 판단할 수 있음)</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="구간화" class="level3">
<h3 class="anchored" data-anchor-id="구간화">구간화</h3>
<ul>
<li>수치형 변수를 구간으로 나누고, 범주화</li>
<li>장점 : 일반적으로 모델의 복잡도와, 이상값의 영향을 줄이는 효과</li>
<li>단점 : 구간 경계의 값은 해석의 손해가 있음
<ul>
<li>구간의 크기/개수 설정은 초모수(하이퍼파라미터)이므로, 성능에 영향이 크므로 자주 사용되지는 않음(도메인 지식 필요)</li>
</ul></li>
</ul>
</section>
</section>
<section id="기초통계-등-확인하기" class="level2">
<h2 class="anchored" data-anchor-id="기초통계-등-확인하기">기초통계 등 확인하기</h2>
<section id="데이터패키지-로딩-및-자료형-등-확인" class="level3">
<h3 class="anchored" data-anchor-id="데이터패키지-로딩-및-자료형-등-확인">데이터/패키지 로딩 및 자료형 등 확인</h3>
<div id="22aa3fef" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3b743a2d" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pandas설정</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_rows'</span>, <span class="dv">500</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 로딩</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">'application_train.csv'</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>data.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">SK_ID_CURR</th>
<th data-quarto-table-cell-role="th">TARGET</th>
<th data-quarto-table-cell-role="th">NAME_CONTRACT_TYPE</th>
<th data-quarto-table-cell-role="th">CODE_GENDER</th>
<th data-quarto-table-cell-role="th">FLAG_OWN_CAR</th>
<th data-quarto-table-cell-role="th">FLAG_OWN_REALTY</th>
<th data-quarto-table-cell-role="th">CNT_CHILDREN</th>
<th data-quarto-table-cell-role="th">AMT_INCOME_TOTAL</th>
<th data-quarto-table-cell-role="th">AMT_CREDIT</th>
<th data-quarto-table-cell-role="th">AMT_ANNUITY</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_18</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_19</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_20</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_21</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_HOUR</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_DAY</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_WEEK</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_MON</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_QRT</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_YEAR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>100002</td>
<td>1</td>
<td>Cash loans</td>
<td>M</td>
<td>N</td>
<td>Y</td>
<td>0</td>
<td>202500.0</td>
<td>406597.5</td>
<td>24700.5</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>100003</td>
<td>0</td>
<td>Cash loans</td>
<td>F</td>
<td>N</td>
<td>N</td>
<td>0</td>
<td>270000.0</td>
<td>1293502.5</td>
<td>35698.5</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>100004</td>
<td>0</td>
<td>Revolving loans</td>
<td>M</td>
<td>Y</td>
<td>Y</td>
<td>0</td>
<td>67500.0</td>
<td>135000.0</td>
<td>6750.0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>100006</td>
<td>0</td>
<td>Cash loans</td>
<td>F</td>
<td>N</td>
<td>Y</td>
<td>0</td>
<td>135000.0</td>
<td>312682.5</td>
<td>29686.5</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>100007</td>
<td>0</td>
<td>Cash loans</td>
<td>M</td>
<td>N</td>
<td>Y</td>
<td>0</td>
<td>121500.0</td>
<td>513000.0</td>
<td>21865.5</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

<p>5 rows × 122 columns</p>
</div>
</div>
</div>
<div id="4b5fdb26" class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 307511 entries, 0 to 307510
Columns: 122 entries, SK_ID_CURR to AMT_REQ_CREDIT_BUREAU_YEAR
dtypes: float64(65), int64(41), object(16)
memory usage: 286.2+ MB</code></pre>
</div>
</div>
</section>
<section id="통계적-수치-확인" class="level3">
<h3 class="anchored" data-anchor-id="통계적-수치-확인">통계적 수치 확인</h3>
<section id="기초-통계량-확인" class="level4">
<h4 class="anchored" data-anchor-id="기초-통계량-확인">기초 통계량 확인</h4>
<ul>
<li>pandas의 describe()
<ul>
<li>count : 결측치가 아닌 값의 개수</li>
<li>unique : 범주형 변수에 대해, unique한 값의 개수</li>
<li>top : 범주형 변수에 대해, 가장 많은 값</li>
<li>freq : 범주형 변수에 대해, 가장 많은 값의 개수</li>
<li>mean : 평균</li>
<li>std : 표준편차</li>
<li>min / 25% / 50% (median) / 75% / max : 최소값 / Q1 / 중앙값 / Q3 / 최대값</li>
</ul></li>
<li>아래의 코드(describe)를 통해 다음과 같은 점을 생각해 볼 수 있음
<ul>
<li>Unique값이 있다는 것 → 범주형 변수라는 것</li>
<li><strong>대부분 컬럼이 정규화</strong>된 것으로 추정
<ul>
<li>Min 0 / Max 1인 컬럼이 많음</li>
<li>평균과 표준편차가 작은 편인 컬럼이 많음</li>
</ul></li>
<li>대부분 컬럼이 편향이 많이 있어보임
<ul>
<li>예를 들어 <strong>NAME_CONTRACT_TYPE</strong>컬럼의 경우, unique 2 / count 307511 / frep 278232</li>
</ul></li>
<li>(향후 로그변환을 위해)변수가 음수인지 양수인지 봐두기</li>
</ul></li>
</ul>
<div id="19b02772" class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data.NAME_CONTRACT_TYPE.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>NAME_CONTRACT_TYPE
Cash loans         278232
Revolving loans     29279
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="7519d181" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>basic_statistics <span class="op">=</span> data.describe(include<span class="op">=</span><span class="st">'all'</span>).transpose().reset_index()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>basic_statistics.sort_values(<span class="st">'unique'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">unique</th>
<th data-quarto-table-cell-role="th">top</th>
<th data-quarto-table-cell-role="th">freq</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NAME_CONTRACT_TYPE</td>
<td>307511</td>
<td>2</td>
<td>Cash loans</td>
<td>278232</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>FLAG_OWN_CAR</td>
<td>307511</td>
<td>2</td>
<td>N</td>
<td>202924</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>FLAG_OWN_REALTY</td>
<td>307511</td>
<td>2</td>
<td>Y</td>
<td>213312</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">90</td>
<td>EMERGENCYSTATE_MODE</td>
<td>161756</td>
<td>2</td>
<td>No</td>
<td>159428</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>CODE_GENDER</td>
<td>307511</td>
<td>3</td>
<td>F</td>
<td>202448</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">87</td>
<td>HOUSETYPE_MODE</td>
<td>153214</td>
<td>3</td>
<td>block of flats</td>
<td>150503</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">86</td>
<td>FONDKAPREMONT_MODE</td>
<td>97216</td>
<td>4</td>
<td>reg oper account</td>
<td>73830</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>NAME_EDUCATION_TYPE</td>
<td>307511</td>
<td>5</td>
<td>Secondary / secondary special</td>
<td>218391</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>NAME_FAMILY_STATUS</td>
<td>307511</td>
<td>6</td>
<td>Married</td>
<td>196432</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>NAME_HOUSING_TYPE</td>
<td>307511</td>
<td>6</td>
<td>House / apartment</td>
<td>272868</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>NAME_TYPE_SUITE</td>
<td>306219</td>
<td>7</td>
<td>Unaccompanied</td>
<td>248526</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">32</td>
<td>WEEKDAY_APPR_PROCESS_START</td>
<td>307511</td>
<td>7</td>
<td>TUESDAY</td>
<td>53901</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">89</td>
<td>WALLSMATERIAL_MODE</td>
<td>151170</td>
<td>7</td>
<td>Panel</td>
<td>66040</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>NAME_INCOME_TYPE</td>
<td>307511</td>
<td>8</td>
<td>Working</td>
<td>158774</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>OCCUPATION_TYPE</td>
<td>211120</td>
<td>18</td>
<td>Laborers</td>
<td>55186</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">40</td>
<td>ORGANIZATION_TYPE</td>
<td>307511</td>
<td>58</td>
<td>Business Entity Type 3</td>
<td>67992</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>SK_ID_CURR</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>278180.518577</td>
<td>102790.175348</td>
<td>100002.0</td>
<td>189145.5</td>
<td>278202.0</td>
<td>367142.5</td>
<td>456255.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>TARGET</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.080729</td>
<td>0.272419</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>CNT_CHILDREN</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.417052</td>
<td>0.722121</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>19.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>AMT_INCOME_TOTAL</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>168797.919297</td>
<td>237123.146279</td>
<td>25650.0</td>
<td>112500.0</td>
<td>147150.0</td>
<td>202500.0</td>
<td>117000000.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>AMT_CREDIT</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>599025.999706</td>
<td>402490.776996</td>
<td>45000.0</td>
<td>270000.0</td>
<td>513531.0</td>
<td>808650.0</td>
<td>4050000.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>AMT_ANNUITY</td>
<td>307499.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>27108.573909</td>
<td>14493.737315</td>
<td>1615.5</td>
<td>16524.0</td>
<td>24903.0</td>
<td>34596.0</td>
<td>258025.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>AMT_GOODS_PRICE</td>
<td>307233.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>538396.207429</td>
<td>369446.46054</td>
<td>40500.0</td>
<td>238500.0</td>
<td>450000.0</td>
<td>679500.0</td>
<td>4050000.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>REGION_POPULATION_RELATIVE</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.020868</td>
<td>0.013831</td>
<td>0.00029</td>
<td>0.010006</td>
<td>0.01885</td>
<td>0.028663</td>
<td>0.072508</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>DAYS_BIRTH</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>-16036.995067</td>
<td>4363.988632</td>
<td>-25229.0</td>
<td>-19682.0</td>
<td>-15750.0</td>
<td>-12413.0</td>
<td>-7489.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>DAYS_EMPLOYED</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>63815.045904</td>
<td>141275.766519</td>
<td>-17912.0</td>
<td>-2760.0</td>
<td>-1213.0</td>
<td>-289.0</td>
<td>365243.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>DAYS_REGISTRATION</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>-4986.120328</td>
<td>3522.886321</td>
<td>-24672.0</td>
<td>-7479.5</td>
<td>-4504.0</td>
<td>-2010.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>DAYS_ID_PUBLISH</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>-2994.202373</td>
<td>1509.450419</td>
<td>-7197.0</td>
<td>-4299.0</td>
<td>-3254.0</td>
<td>-1720.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>OWN_CAR_AGE</td>
<td>104582.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>12.061091</td>
<td>11.944812</td>
<td>0.0</td>
<td>5.0</td>
<td>9.0</td>
<td>15.0</td>
<td>91.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>FLAG_MOBIL</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.999997</td>
<td>0.001803</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>FLAG_EMP_PHONE</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.819889</td>
<td>0.38428</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>FLAG_WORK_PHONE</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.199368</td>
<td>0.399526</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25</td>
<td>FLAG_CONT_MOBILE</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.998133</td>
<td>0.043164</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26</td>
<td>FLAG_PHONE</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.281066</td>
<td>0.449521</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">27</td>
<td>FLAG_EMAIL</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.05672</td>
<td>0.231307</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>CNT_FAM_MEMBERS</td>
<td>307509.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2.152665</td>
<td>0.910682</td>
<td>1.0</td>
<td>2.0</td>
<td>2.0</td>
<td>3.0</td>
<td>20.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30</td>
<td>REGION_RATING_CLIENT</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2.052463</td>
<td>0.509034</td>
<td>1.0</td>
<td>2.0</td>
<td>2.0</td>
<td>2.0</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31</td>
<td>REGION_RATING_CLIENT_W_CITY</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2.031521</td>
<td>0.502737</td>
<td>1.0</td>
<td>2.0</td>
<td>2.0</td>
<td>2.0</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">33</td>
<td>HOUR_APPR_PROCESS_START</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>12.063419</td>
<td>3.265832</td>
<td>0.0</td>
<td>10.0</td>
<td>12.0</td>
<td>14.0</td>
<td>23.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">34</td>
<td>REG_REGION_NOT_LIVE_REGION</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.015144</td>
<td>0.122126</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35</td>
<td>REG_REGION_NOT_WORK_REGION</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.050769</td>
<td>0.219526</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">36</td>
<td>LIVE_REGION_NOT_WORK_REGION</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.040659</td>
<td>0.197499</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">37</td>
<td>REG_CITY_NOT_LIVE_CITY</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.078173</td>
<td>0.268444</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">38</td>
<td>REG_CITY_NOT_WORK_CITY</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.230454</td>
<td>0.421124</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">39</td>
<td>LIVE_CITY_NOT_WORK_CITY</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.179555</td>
<td>0.383817</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">41</td>
<td>EXT_SOURCE_1</td>
<td>134133.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.50213</td>
<td>0.211062</td>
<td>0.014568</td>
<td>0.334007</td>
<td>0.505998</td>
<td>0.675053</td>
<td>0.962693</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42</td>
<td>EXT_SOURCE_2</td>
<td>306851.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.514393</td>
<td>0.19106</td>
<td>0.0</td>
<td>0.392457</td>
<td>0.565961</td>
<td>0.663617</td>
<td>0.855</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">43</td>
<td>EXT_SOURCE_3</td>
<td>246546.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.510853</td>
<td>0.194844</td>
<td>0.000527</td>
<td>0.37065</td>
<td>0.535276</td>
<td>0.669057</td>
<td>0.89601</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">44</td>
<td>APARTMENTS_AVG</td>
<td>151450.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.11744</td>
<td>0.10824</td>
<td>0.0</td>
<td>0.0577</td>
<td>0.0876</td>
<td>0.1485</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">45</td>
<td>BASEMENTAREA_AVG</td>
<td>127568.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.088442</td>
<td>0.082438</td>
<td>0.0</td>
<td>0.0442</td>
<td>0.0763</td>
<td>0.1122</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">46</td>
<td>YEARS_BEGINEXPLUATATION_AVG</td>
<td>157504.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.977735</td>
<td>0.059223</td>
<td>0.0</td>
<td>0.9767</td>
<td>0.9816</td>
<td>0.9866</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">47</td>
<td>YEARS_BUILD_AVG</td>
<td>103023.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.752471</td>
<td>0.11328</td>
<td>0.0</td>
<td>0.6872</td>
<td>0.7552</td>
<td>0.8232</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">48</td>
<td>COMMONAREA_AVG</td>
<td>92646.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.044621</td>
<td>0.076036</td>
<td>0.0</td>
<td>0.0078</td>
<td>0.0211</td>
<td>0.0515</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">49</td>
<td>ELEVATORS_AVG</td>
<td>143620.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.078942</td>
<td>0.134576</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.12</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50</td>
<td>ENTRANCES_AVG</td>
<td>152683.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.149725</td>
<td>0.100049</td>
<td>0.0</td>
<td>0.069</td>
<td>0.1379</td>
<td>0.2069</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">51</td>
<td>FLOORSMAX_AVG</td>
<td>154491.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.226282</td>
<td>0.144641</td>
<td>0.0</td>
<td>0.1667</td>
<td>0.1667</td>
<td>0.3333</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">52</td>
<td>FLOORSMIN_AVG</td>
<td>98869.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.231894</td>
<td>0.16138</td>
<td>0.0</td>
<td>0.0833</td>
<td>0.2083</td>
<td>0.375</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">53</td>
<td>LANDAREA_AVG</td>
<td>124921.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.066333</td>
<td>0.081184</td>
<td>0.0</td>
<td>0.0187</td>
<td>0.0481</td>
<td>0.0856</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">54</td>
<td>LIVINGAPARTMENTS_AVG</td>
<td>97312.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.100775</td>
<td>0.092576</td>
<td>0.0</td>
<td>0.0504</td>
<td>0.0756</td>
<td>0.121</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">55</td>
<td>LIVINGAREA_AVG</td>
<td>153161.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.107399</td>
<td>0.110565</td>
<td>0.0</td>
<td>0.0453</td>
<td>0.0745</td>
<td>0.1299</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">56</td>
<td>NONLIVINGAPARTMENTS_AVG</td>
<td>93997.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.008809</td>
<td>0.047732</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0039</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">57</td>
<td>NONLIVINGAREA_AVG</td>
<td>137829.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.028358</td>
<td>0.069523</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0036</td>
<td>0.0277</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58</td>
<td>APARTMENTS_MODE</td>
<td>151450.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.114231</td>
<td>0.107936</td>
<td>0.0</td>
<td>0.0525</td>
<td>0.084</td>
<td>0.1439</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">59</td>
<td>BASEMENTAREA_MODE</td>
<td>127568.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.087543</td>
<td>0.084307</td>
<td>0.0</td>
<td>0.0407</td>
<td>0.0746</td>
<td>0.1124</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">60</td>
<td>YEARS_BEGINEXPLUATATION_MODE</td>
<td>157504.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.977065</td>
<td>0.064575</td>
<td>0.0</td>
<td>0.9767</td>
<td>0.9816</td>
<td>0.9866</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">61</td>
<td>YEARS_BUILD_MODE</td>
<td>103023.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.759637</td>
<td>0.110111</td>
<td>0.0</td>
<td>0.6994</td>
<td>0.7648</td>
<td>0.8236</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">62</td>
<td>COMMONAREA_MODE</td>
<td>92646.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.042553</td>
<td>0.074445</td>
<td>0.0</td>
<td>0.0072</td>
<td>0.019</td>
<td>0.049</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">63</td>
<td>ELEVATORS_MODE</td>
<td>143620.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.07449</td>
<td>0.132256</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.1208</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">64</td>
<td>ENTRANCES_MODE</td>
<td>152683.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.145193</td>
<td>0.100977</td>
<td>0.0</td>
<td>0.069</td>
<td>0.1379</td>
<td>0.2069</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">65</td>
<td>FLOORSMAX_MODE</td>
<td>154491.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.222315</td>
<td>0.143709</td>
<td>0.0</td>
<td>0.1667</td>
<td>0.1667</td>
<td>0.3333</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">66</td>
<td>FLOORSMIN_MODE</td>
<td>98869.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.228058</td>
<td>0.16116</td>
<td>0.0</td>
<td>0.0833</td>
<td>0.2083</td>
<td>0.375</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">67</td>
<td>LANDAREA_MODE</td>
<td>124921.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.064958</td>
<td>0.08175</td>
<td>0.0</td>
<td>0.0166</td>
<td>0.0458</td>
<td>0.0841</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">68</td>
<td>LIVINGAPARTMENTS_MODE</td>
<td>97312.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.105645</td>
<td>0.09788</td>
<td>0.0</td>
<td>0.0542</td>
<td>0.0771</td>
<td>0.1313</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">69</td>
<td>LIVINGAREA_MODE</td>
<td>153161.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.105975</td>
<td>0.111845</td>
<td>0.0</td>
<td>0.0427</td>
<td>0.0731</td>
<td>0.1252</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">70</td>
<td>NONLIVINGAPARTMENTS_MODE</td>
<td>93997.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.008076</td>
<td>0.046276</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0039</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">71</td>
<td>NONLIVINGAREA_MODE</td>
<td>137829.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.027022</td>
<td>0.070254</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0011</td>
<td>0.0231</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">72</td>
<td>APARTMENTS_MEDI</td>
<td>151450.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.11785</td>
<td>0.109076</td>
<td>0.0</td>
<td>0.0583</td>
<td>0.0864</td>
<td>0.1489</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">73</td>
<td>BASEMENTAREA_MEDI</td>
<td>127568.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.087955</td>
<td>0.082179</td>
<td>0.0</td>
<td>0.0437</td>
<td>0.0758</td>
<td>0.1116</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">74</td>
<td>YEARS_BEGINEXPLUATATION_MEDI</td>
<td>157504.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.977752</td>
<td>0.059897</td>
<td>0.0</td>
<td>0.9767</td>
<td>0.9816</td>
<td>0.9866</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75</td>
<td>YEARS_BUILD_MEDI</td>
<td>103023.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.755746</td>
<td>0.112066</td>
<td>0.0</td>
<td>0.6914</td>
<td>0.7585</td>
<td>0.8256</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76</td>
<td>COMMONAREA_MEDI</td>
<td>92646.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.044595</td>
<td>0.076144</td>
<td>0.0</td>
<td>0.0079</td>
<td>0.0208</td>
<td>0.0513</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">77</td>
<td>ELEVATORS_MEDI</td>
<td>143620.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.078078</td>
<td>0.134467</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.12</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">78</td>
<td>ENTRANCES_MEDI</td>
<td>152683.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.149213</td>
<td>0.100368</td>
<td>0.0</td>
<td>0.069</td>
<td>0.1379</td>
<td>0.2069</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">79</td>
<td>FLOORSMAX_MEDI</td>
<td>154491.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.225897</td>
<td>0.145067</td>
<td>0.0</td>
<td>0.1667</td>
<td>0.1667</td>
<td>0.3333</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">80</td>
<td>FLOORSMIN_MEDI</td>
<td>98869.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.231625</td>
<td>0.161934</td>
<td>0.0</td>
<td>0.0833</td>
<td>0.2083</td>
<td>0.375</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">81</td>
<td>LANDAREA_MEDI</td>
<td>124921.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.067169</td>
<td>0.082167</td>
<td>0.0</td>
<td>0.0187</td>
<td>0.0487</td>
<td>0.0868</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">82</td>
<td>LIVINGAPARTMENTS_MEDI</td>
<td>97312.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.101954</td>
<td>0.093642</td>
<td>0.0</td>
<td>0.0513</td>
<td>0.0761</td>
<td>0.1231</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83</td>
<td>LIVINGAREA_MEDI</td>
<td>153161.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.108607</td>
<td>0.11226</td>
<td>0.0</td>
<td>0.0457</td>
<td>0.0749</td>
<td>0.1303</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">84</td>
<td>NONLIVINGAPARTMENTS_MEDI</td>
<td>93997.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.008651</td>
<td>0.047415</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0039</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">85</td>
<td>NONLIVINGAREA_MEDI</td>
<td>137829.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.028236</td>
<td>0.070166</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0031</td>
<td>0.0266</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">88</td>
<td>TOTALAREA_MODE</td>
<td>159080.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.102547</td>
<td>0.107462</td>
<td>0.0</td>
<td>0.0412</td>
<td>0.0688</td>
<td>0.1276</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">91</td>
<td>OBS_30_CNT_SOCIAL_CIRCLE</td>
<td>306490.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.422245</td>
<td>2.400989</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>2.0</td>
<td>348.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">92</td>
<td>DEF_30_CNT_SOCIAL_CIRCLE</td>
<td>306490.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.143421</td>
<td>0.446698</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>34.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">93</td>
<td>OBS_60_CNT_SOCIAL_CIRCLE</td>
<td>306490.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.405292</td>
<td>2.379803</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>2.0</td>
<td>344.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">94</td>
<td>DEF_60_CNT_SOCIAL_CIRCLE</td>
<td>306490.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.100049</td>
<td>0.362291</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>24.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">95</td>
<td>DAYS_LAST_PHONE_CHANGE</td>
<td>307510.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>-962.858788</td>
<td>826.808487</td>
<td>-4292.0</td>
<td>-1570.0</td>
<td>-757.0</td>
<td>-274.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">96</td>
<td>FLAG_DOCUMENT_2</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000042</td>
<td>0.006502</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">97</td>
<td>FLAG_DOCUMENT_3</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.710023</td>
<td>0.453752</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">98</td>
<td>FLAG_DOCUMENT_4</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000081</td>
<td>0.009016</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">99</td>
<td>FLAG_DOCUMENT_5</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.015115</td>
<td>0.12201</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">100</td>
<td>FLAG_DOCUMENT_6</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.088055</td>
<td>0.283376</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">101</td>
<td>FLAG_DOCUMENT_7</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000192</td>
<td>0.01385</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">102</td>
<td>FLAG_DOCUMENT_8</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.081376</td>
<td>0.273412</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">103</td>
<td>FLAG_DOCUMENT_9</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.003896</td>
<td>0.062295</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">104</td>
<td>FLAG_DOCUMENT_10</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000023</td>
<td>0.004771</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">105</td>
<td>FLAG_DOCUMENT_11</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.003912</td>
<td>0.062424</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">106</td>
<td>FLAG_DOCUMENT_12</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000007</td>
<td>0.00255</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">107</td>
<td>FLAG_DOCUMENT_13</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.003525</td>
<td>0.059268</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">108</td>
<td>FLAG_DOCUMENT_14</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.002936</td>
<td>0.05411</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">109</td>
<td>FLAG_DOCUMENT_15</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00121</td>
<td>0.03476</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">110</td>
<td>FLAG_DOCUMENT_16</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.009928</td>
<td>0.099144</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">111</td>
<td>FLAG_DOCUMENT_17</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000267</td>
<td>0.016327</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">112</td>
<td>FLAG_DOCUMENT_18</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00813</td>
<td>0.089798</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">113</td>
<td>FLAG_DOCUMENT_19</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000595</td>
<td>0.024387</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">114</td>
<td>FLAG_DOCUMENT_20</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000507</td>
<td>0.022518</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">115</td>
<td>FLAG_DOCUMENT_21</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000335</td>
<td>0.018299</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">116</td>
<td>AMT_REQ_CREDIT_BUREAU_HOUR</td>
<td>265992.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.006402</td>
<td>0.083849</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">117</td>
<td>AMT_REQ_CREDIT_BUREAU_DAY</td>
<td>265992.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.007</td>
<td>0.110757</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>9.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">118</td>
<td>AMT_REQ_CREDIT_BUREAU_WEEK</td>
<td>265992.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.034362</td>
<td>0.204685</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>8.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">119</td>
<td>AMT_REQ_CREDIT_BUREAU_MON</td>
<td>265992.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.267395</td>
<td>0.916002</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>27.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">120</td>
<td>AMT_REQ_CREDIT_BUREAU_QRT</td>
<td>265992.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.265474</td>
<td>0.794056</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>261.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">121</td>
<td>AMT_REQ_CREDIT_BUREAU_YEAR</td>
<td>265992.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.899974</td>
<td>1.869295</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>3.0</td>
<td>25.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="왜도-확인" class="level4">
<h4 class="anchored" data-anchor-id="왜도-확인">왜도 확인</h4>
<ul>
<li>수치형 변수만, skew함수로 왜도를 구할 수 있음</li>
<li>음의 왜도 확인하기 + 높은 양의 왜도 확인하기(10이 넘는 경우 왜도가 높은 편)</li>
<li>아래 코드의 결과를 기준으로, <strong>왜도가 심하게 높은 주요 변수 → 이상치 여부를 시각화로 확인 필요</strong>
<ul>
<li>AMT_INCOME_TOTAL : 391.559654</li>
<li>YEARS_BEGINEXPLUATATION_MEDI : -15.573124</li>
<li>FLAG_CONT_MOBILE : -23.081172</li>
<li>FLAG_MOBIL : -554.536744</li>
</ul></li>
</ul>
<div id="96e0998d" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>numerical_data <span class="op">=</span> data.select_dtypes(include<span class="op">=</span>[<span class="st">'float64'</span>, <span class="st">'int64'</span>])</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>numeric_skew <span class="op">=</span> numerical_data.skew().reset_index() <span class="co"># skew() 함수로 왜도 구하기</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>numeric_skew.columns <span class="op">=</span> [<span class="st">'index'</span>,<span class="st">'skewness'</span>]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>ext_statistics <span class="op">=</span> pd.merge(basic_statistics, numeric_skew, on<span class="op">=</span><span class="st">'index'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>ext_statistics.sort_values(by<span class="op">=</span><span class="st">'skewness'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">unique</th>
<th data-quarto-table-cell-role="th">top</th>
<th data-quarto-table-cell-role="th">freq</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
<th data-quarto-table-cell-role="th">skewness</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">106</td>
<td>FLAG_DOCUMENT_12</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000007</td>
<td>0.00255</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>392.114779</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>AMT_INCOME_TOTAL</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>168797.919297</td>
<td>237123.146279</td>
<td>25650.0</td>
<td>112500.0</td>
<td>147150.0</td>
<td>202500.0</td>
<td>117000000.0</td>
<td>391.559654</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">104</td>
<td>FLAG_DOCUMENT_10</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000023</td>
<td>0.004771</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>209.589054</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">96</td>
<td>FLAG_DOCUMENT_2</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000042</td>
<td>0.006502</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>153.791817</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">120</td>
<td>AMT_REQ_CREDIT_BUREAU_QRT</td>
<td>265992.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.265474</td>
<td>0.794056</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>261.0</td>
<td>134.365776</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">98</td>
<td>FLAG_DOCUMENT_4</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000081</td>
<td>0.009016</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>110.894364</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">101</td>
<td>FLAG_DOCUMENT_7</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000192</td>
<td>0.01385</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>72.174108</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">111</td>
<td>FLAG_DOCUMENT_17</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000267</td>
<td>0.016327</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>61.214140</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">115</td>
<td>FLAG_DOCUMENT_21</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000335</td>
<td>0.018299</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>54.612939</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">114</td>
<td>FLAG_DOCUMENT_20</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000507</td>
<td>0.022518</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>44.364897</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">113</td>
<td>FLAG_DOCUMENT_19</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000595</td>
<td>0.024387</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>40.956134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">109</td>
<td>FLAG_DOCUMENT_15</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00121</td>
<td>0.03476</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>28.699333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">117</td>
<td>AMT_REQ_CREDIT_BUREAU_DAY</td>
<td>265992.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.007</td>
<td>0.110757</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>9.0</td>
<td>27.043505</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">108</td>
<td>FLAG_DOCUMENT_14</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.002936</td>
<td>0.05411</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>18.372533</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">107</td>
<td>FLAG_DOCUMENT_13</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.003525</td>
<td>0.059268</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>16.753746</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">70</td>
<td>NONLIVINGAPARTMENTS_MODE</td>
<td>93997.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.008076</td>
<td>0.046276</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0039</td>
<td>1.0</td>
<td>16.251819</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">103</td>
<td>FLAG_DOCUMENT_9</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.003896</td>
<td>0.062295</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>15.927755</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">105</td>
<td>FLAG_DOCUMENT_11</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.003912</td>
<td>0.062424</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>15.894229</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">84</td>
<td>NONLIVINGAPARTMENTS_MEDI</td>
<td>93997.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.008651</td>
<td>0.047415</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0039</td>
<td>1.0</td>
<td>15.671995</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">56</td>
<td>NONLIVINGAPARTMENTS_AVG</td>
<td>93997.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.008809</td>
<td>0.047732</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0039</td>
<td>1.0</td>
<td>15.541185</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">116</td>
<td>AMT_REQ_CREDIT_BUREAU_HOUR</td>
<td>265992.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.006402</td>
<td>0.083849</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>4.0</td>
<td>14.534062</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">91</td>
<td>OBS_30_CNT_SOCIAL_CIRCLE</td>
<td>306490.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.422245</td>
<td>2.400989</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>2.0</td>
<td>348.0</td>
<td>12.139598</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">93</td>
<td>OBS_60_CNT_SOCIAL_CIRCLE</td>
<td>306490.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.405292</td>
<td>2.379803</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>2.0</td>
<td>344.0</td>
<td>12.070829</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">112</td>
<td>FLAG_DOCUMENT_18</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.00813</td>
<td>0.089798</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>10.955080</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">110</td>
<td>FLAG_DOCUMENT_16</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.009928</td>
<td>0.099144</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>9.886111</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">118</td>
<td>AMT_REQ_CREDIT_BUREAU_WEEK</td>
<td>265992.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.034362</td>
<td>0.204685</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>8.0</td>
<td>9.293573</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">99</td>
<td>FLAG_DOCUMENT_5</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.015115</td>
<td>0.12201</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>7.948322</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">34</td>
<td>REG_REGION_NOT_LIVE_REGION</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.015144</td>
<td>0.122126</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>7.940276</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">119</td>
<td>AMT_REQ_CREDIT_BUREAU_MON</td>
<td>265992.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.267395</td>
<td>0.916002</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>27.0</td>
<td>7.804848</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">57</td>
<td>NONLIVINGAREA_AVG</td>
<td>137829.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.028358</td>
<td>0.069523</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0036</td>
<td>0.0277</td>
<td>1.0</td>
<td>6.559012</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">71</td>
<td>NONLIVINGAREA_MODE</td>
<td>137829.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.027022</td>
<td>0.070254</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0011</td>
<td>0.0231</td>
<td>1.0</td>
<td>6.522451</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">85</td>
<td>NONLIVINGAREA_MEDI</td>
<td>137829.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.028236</td>
<td>0.070166</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0031</td>
<td>0.0266</td>
<td>1.0</td>
<td>6.508831</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">62</td>
<td>COMMONAREA_MODE</td>
<td>92646.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.042553</td>
<td>0.074445</td>
<td>0.0</td>
<td>0.0072</td>
<td>0.019</td>
<td>0.049</td>
<td>1.0</td>
<td>5.620589</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">48</td>
<td>COMMONAREA_AVG</td>
<td>92646.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.044621</td>
<td>0.076036</td>
<td>0.0</td>
<td>0.0078</td>
<td>0.0211</td>
<td>0.0515</td>
<td>1.0</td>
<td>5.457305</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76</td>
<td>COMMONAREA_MEDI</td>
<td>92646.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.044595</td>
<td>0.076144</td>
<td>0.0</td>
<td>0.0079</td>
<td>0.0208</td>
<td>0.0513</td>
<td>1.0</td>
<td>5.419238</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">94</td>
<td>DEF_60_CNT_SOCIAL_CIRCLE</td>
<td>306490.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.100049</td>
<td>0.362291</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>24.0</td>
<td>5.277878</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">92</td>
<td>DEF_30_CNT_SOCIAL_CIRCLE</td>
<td>306490.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.143421</td>
<td>0.446698</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>34.0</td>
<td>5.183518</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">36</td>
<td>LIVE_REGION_NOT_WORK_REGION</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.040659</td>
<td>0.197499</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>4.651620</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">53</td>
<td>LANDAREA_AVG</td>
<td>124921.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.066333</td>
<td>0.081184</td>
<td>0.0</td>
<td>0.0187</td>
<td>0.0481</td>
<td>0.0856</td>
<td>1.0</td>
<td>4.458677</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">67</td>
<td>LANDAREA_MODE</td>
<td>124921.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.064958</td>
<td>0.08175</td>
<td>0.0</td>
<td>0.0166</td>
<td>0.0458</td>
<td>0.0841</td>
<td>1.0</td>
<td>4.377027</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">81</td>
<td>LANDAREA_MEDI</td>
<td>124921.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.067169</td>
<td>0.082167</td>
<td>0.0</td>
<td>0.0187</td>
<td>0.0487</td>
<td>0.0868</td>
<td>1.0</td>
<td>4.368292</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>REG_REGION_NOT_WORK_REGION</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.050769</td>
<td>0.219526</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>4.092767</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">27</td>
<td>FLAG_EMAIL</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.05672</td>
<td>0.231307</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>3.832853</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">45</td>
<td>BASEMENTAREA_AVG</td>
<td>127568.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.088442</td>
<td>0.082438</td>
<td>0.0</td>
<td>0.0442</td>
<td>0.0763</td>
<td>0.1122</td>
<td>1.0</td>
<td>3.566306</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">73</td>
<td>BASEMENTAREA_MEDI</td>
<td>127568.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.087955</td>
<td>0.082179</td>
<td>0.0</td>
<td>0.0437</td>
<td>0.0758</td>
<td>0.1116</td>
<td>1.0</td>
<td>3.553040</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">59</td>
<td>BASEMENTAREA_MODE</td>
<td>127568.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.087543</td>
<td>0.084307</td>
<td>0.0</td>
<td>0.0407</td>
<td>0.0746</td>
<td>0.1124</td>
<td>1.0</td>
<td>3.481533</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">37</td>
<td>REG_CITY_NOT_LIVE_CITY</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.078173</td>
<td>0.268444</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>3.142781</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>TARGET</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.080729</td>
<td>0.272419</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>3.078159</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">102</td>
<td>FLAG_DOCUMENT_8</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.081376</td>
<td>0.273412</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>3.062241</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">54</td>
<td>LIVINGAPARTMENTS_AVG</td>
<td>97312.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.100775</td>
<td>0.092576</td>
<td>0.0</td>
<td>0.0504</td>
<td>0.0756</td>
<td>0.121</td>
<td>1.0</td>
<td>3.042198</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">82</td>
<td>LIVINGAPARTMENTS_MEDI</td>
<td>97312.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.101954</td>
<td>0.093642</td>
<td>0.0</td>
<td>0.0513</td>
<td>0.0761</td>
<td>0.1231</td>
<td>1.0</td>
<td>2.988291</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">100</td>
<td>FLAG_DOCUMENT_6</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.088055</td>
<td>0.283376</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>2.907427</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">68</td>
<td>LIVINGAPARTMENTS_MODE</td>
<td>97312.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.105645</td>
<td>0.09788</td>
<td>0.0</td>
<td>0.0542</td>
<td>0.0771</td>
<td>0.1313</td>
<td>1.0</td>
<td>2.902672</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">69</td>
<td>LIVINGAREA_MODE</td>
<td>153161.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.105975</td>
<td>0.111845</td>
<td>0.0</td>
<td>0.0427</td>
<td>0.0731</td>
<td>0.1252</td>
<td>1.0</td>
<td>2.902491</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">55</td>
<td>LIVINGAREA_AVG</td>
<td>153161.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.107399</td>
<td>0.110565</td>
<td>0.0</td>
<td>0.0453</td>
<td>0.0745</td>
<td>0.1299</td>
<td>1.0</td>
<td>2.854736</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83</td>
<td>LIVINGAREA_MEDI</td>
<td>153161.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.108607</td>
<td>0.11226</td>
<td>0.0</td>
<td>0.0457</td>
<td>0.0749</td>
<td>0.1303</td>
<td>1.0</td>
<td>2.848935</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">88</td>
<td>TOTALAREA_MODE</td>
<td>159080.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.102547</td>
<td>0.107462</td>
<td>0.0</td>
<td>0.0412</td>
<td>0.0688</td>
<td>0.1276</td>
<td>1.0</td>
<td>2.797572</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>OWN_CAR_AGE</td>
<td>104582.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>12.061091</td>
<td>11.944812</td>
<td>0.0</td>
<td>5.0</td>
<td>9.0</td>
<td>15.0</td>
<td>91.0</td>
<td>2.745422</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58</td>
<td>APARTMENTS_MODE</td>
<td>151450.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.114231</td>
<td>0.107936</td>
<td>0.0</td>
<td>0.0525</td>
<td>0.084</td>
<td>0.1439</td>
<td>1.0</td>
<td>2.703052</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">44</td>
<td>APARTMENTS_AVG</td>
<td>151450.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.11744</td>
<td>0.10824</td>
<td>0.0</td>
<td>0.0577</td>
<td>0.0876</td>
<td>0.1485</td>
<td>1.0</td>
<td>2.641836</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">72</td>
<td>APARTMENTS_MEDI</td>
<td>151450.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.11785</td>
<td>0.109076</td>
<td>0.0</td>
<td>0.0583</td>
<td>0.0864</td>
<td>0.1489</td>
<td>1.0</td>
<td>2.639256</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">63</td>
<td>ELEVATORS_MODE</td>
<td>143620.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.07449</td>
<td>0.132256</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.1208</td>
<td>1.0</td>
<td>2.552281</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77</td>
<td>ELEVATORS_MEDI</td>
<td>143620.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.078078</td>
<td>0.134467</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.12</td>
<td>1.0</td>
<td>2.457824</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">49</td>
<td>ELEVATORS_AVG</td>
<td>143620.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.078942</td>
<td>0.134576</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.12</td>
<td>1.0</td>
<td>2.439429</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50</td>
<td>ENTRANCES_AVG</td>
<td>152683.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.149725</td>
<td>0.100049</td>
<td>0.0</td>
<td>0.069</td>
<td>0.1379</td>
<td>0.2069</td>
<td>1.0</td>
<td>2.399717</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">64</td>
<td>ENTRANCES_MODE</td>
<td>152683.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.145193</td>
<td>0.100977</td>
<td>0.0</td>
<td>0.069</td>
<td>0.1379</td>
<td>0.2069</td>
<td>1.0</td>
<td>2.392343</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">78</td>
<td>ENTRANCES_MEDI</td>
<td>152683.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.149213</td>
<td>0.100368</td>
<td>0.0</td>
<td>0.069</td>
<td>0.1379</td>
<td>0.2069</td>
<td>1.0</td>
<td>2.387711</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>CNT_CHILDREN</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.417052</td>
<td>0.722121</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>19.0</td>
<td>1.974604</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">39</td>
<td>LIVE_CITY_NOT_WORK_CITY</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.179555</td>
<td>0.383817</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.669795</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>DAYS_EMPLOYED</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>63815.045904</td>
<td>141275.766519</td>
<td>-17912.0</td>
<td>-2760.0</td>
<td>-1213.0</td>
<td>-289.0</td>
<td>365243.0</td>
<td>1.664346</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>AMT_ANNUITY</td>
<td>307499.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>27108.573909</td>
<td>14493.737315</td>
<td>1615.5</td>
<td>16524.0</td>
<td>24903.0</td>
<td>34596.0</td>
<td>258025.5</td>
<td>1.579777</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>FLAG_WORK_PHONE</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.199368</td>
<td>0.399526</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.504950</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>REGION_POPULATION_RELATIVE</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.020868</td>
<td>0.013831</td>
<td>0.00029</td>
<td>0.010006</td>
<td>0.01885</td>
<td>0.028663</td>
<td>0.072508</td>
<td>1.488009</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>AMT_GOODS_PRICE</td>
<td>307233.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>538396.207429</td>
<td>369446.46054</td>
<td>40500.0</td>
<td>238500.0</td>
<td>450000.0</td>
<td>679500.0</td>
<td>4050000.0</td>
<td>1.349000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>REG_CITY_NOT_WORK_CITY</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.230454</td>
<td>0.421124</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.280138</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">65</td>
<td>FLOORSMAX_MODE</td>
<td>154491.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.222315</td>
<td>0.143709</td>
<td>0.0</td>
<td>0.1667</td>
<td>0.1667</td>
<td>0.3333</td>
<td>1.0</td>
<td>1.244343</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">121</td>
<td>AMT_REQ_CREDIT_BUREAU_YEAR</td>
<td>265992.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.899974</td>
<td>1.869295</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>3.0</td>
<td>25.0</td>
<td>1.243590</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">79</td>
<td>FLOORSMAX_MEDI</td>
<td>154491.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.225897</td>
<td>0.145067</td>
<td>0.0</td>
<td>0.1667</td>
<td>0.1667</td>
<td>0.3333</td>
<td>1.0</td>
<td>1.240185</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>AMT_CREDIT</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>599025.999706</td>
<td>402490.776996</td>
<td>45000.0</td>
<td>270000.0</td>
<td>513531.0</td>
<td>808650.0</td>
<td>4050000.0</td>
<td>1.234778</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">51</td>
<td>FLOORSMAX_AVG</td>
<td>154491.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.226282</td>
<td>0.144641</td>
<td>0.0</td>
<td>0.1667</td>
<td>0.1667</td>
<td>0.3333</td>
<td>1.0</td>
<td>1.226454</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">29</td>
<td>CNT_FAM_MEMBERS</td>
<td>307509.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2.152665</td>
<td>0.910682</td>
<td>1.0</td>
<td>2.0</td>
<td>2.0</td>
<td>3.0</td>
<td>20.0</td>
<td>0.987543</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26</td>
<td>FLAG_PHONE</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.281066</td>
<td>0.449521</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.974083</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">66</td>
<td>FLOORSMIN_MODE</td>
<td>98869.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.228058</td>
<td>0.16116</td>
<td>0.0</td>
<td>0.0833</td>
<td>0.2083</td>
<td>0.375</td>
<td>1.0</td>
<td>0.963835</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">80</td>
<td>FLOORSMIN_MEDI</td>
<td>98869.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.231625</td>
<td>0.161934</td>
<td>0.0</td>
<td>0.0833</td>
<td>0.2083</td>
<td>0.375</td>
<td>1.0</td>
<td>0.960226</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">52</td>
<td>FLOORSMIN_AVG</td>
<td>98869.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.231894</td>
<td>0.16138</td>
<td>0.0</td>
<td>0.0833</td>
<td>0.2083</td>
<td>0.375</td>
<td>1.0</td>
<td>0.954197</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>DAYS_ID_PUBLISH</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>-2994.202373</td>
<td>1509.450419</td>
<td>-7197.0</td>
<td>-4299.0</td>
<td>-3254.0</td>
<td>-1720.0</td>
<td>0.0</td>
<td>0.349327</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30</td>
<td>REGION_RATING_CLIENT</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2.052463</td>
<td>0.509034</td>
<td>1.0</td>
<td>2.0</td>
<td>2.0</td>
<td>2.0</td>
<td>3.0</td>
<td>0.087468</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31</td>
<td>REGION_RATING_CLIENT_W_CITY</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2.031521</td>
<td>0.502737</td>
<td>1.0</td>
<td>2.0</td>
<td>2.0</td>
<td>2.0</td>
<td>3.0</td>
<td>0.059730</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>SK_ID_CURR</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>278180.518577</td>
<td>102790.175348</td>
<td>100002.0</td>
<td>189145.5</td>
<td>278202.0</td>
<td>367142.5</td>
<td>456255.0</td>
<td>-0.001200</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33</td>
<td>HOUR_APPR_PROCESS_START</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>12.063419</td>
<td>3.265832</td>
<td>0.0</td>
<td>10.0</td>
<td>12.0</td>
<td>14.0</td>
<td>23.0</td>
<td>-0.028024</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">41</td>
<td>EXT_SOURCE_1</td>
<td>134133.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.50213</td>
<td>0.211062</td>
<td>0.014568</td>
<td>0.334007</td>
<td>0.505998</td>
<td>0.675053</td>
<td>0.962693</td>
<td>-0.068755</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>DAYS_BIRTH</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>-16036.995067</td>
<td>4363.988632</td>
<td>-25229.0</td>
<td>-19682.0</td>
<td>-15750.0</td>
<td>-12413.0</td>
<td>-7489.0</td>
<td>-0.115673</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">43</td>
<td>EXT_SOURCE_3</td>
<td>246546.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.510853</td>
<td>0.194844</td>
<td>0.000527</td>
<td>0.37065</td>
<td>0.535276</td>
<td>0.669057</td>
<td>0.89601</td>
<td>-0.409390</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>DAYS_REGISTRATION</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>-4986.120328</td>
<td>3522.886321</td>
<td>-24672.0</td>
<td>-7479.5</td>
<td>-4504.0</td>
<td>-2010.0</td>
<td>0.0</td>
<td>-0.590872</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">95</td>
<td>DAYS_LAST_PHONE_CHANGE</td>
<td>307510.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>-962.858788</td>
<td>826.808487</td>
<td>-4292.0</td>
<td>-1570.0</td>
<td>-757.0</td>
<td>-274.0</td>
<td>0.0</td>
<td>-0.713606</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">42</td>
<td>EXT_SOURCE_2</td>
<td>306851.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.514393</td>
<td>0.19106</td>
<td>0.0</td>
<td>0.392457</td>
<td>0.565961</td>
<td>0.663617</td>
<td>0.855</td>
<td>-0.793576</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">97</td>
<td>FLAG_DOCUMENT_3</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.710023</td>
<td>0.453752</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>-0.925725</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">47</td>
<td>YEARS_BUILD_AVG</td>
<td>103023.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.752471</td>
<td>0.11328</td>
<td>0.0</td>
<td>0.6872</td>
<td>0.7552</td>
<td>0.8232</td>
<td>1.0</td>
<td>-0.962485</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75</td>
<td>YEARS_BUILD_MEDI</td>
<td>103023.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.755746</td>
<td>0.112066</td>
<td>0.0</td>
<td>0.6914</td>
<td>0.7585</td>
<td>0.8256</td>
<td>1.0</td>
<td>-0.962784</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">61</td>
<td>YEARS_BUILD_MODE</td>
<td>103023.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.759637</td>
<td>0.110111</td>
<td>0.0</td>
<td>0.6994</td>
<td>0.7648</td>
<td>0.8236</td>
<td>1.0</td>
<td>-1.002305</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>FLAG_EMP_PHONE</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.819889</td>
<td>0.38428</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>-1.664886</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">60</td>
<td>YEARS_BEGINEXPLUATATION_MODE</td>
<td>157504.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.977065</td>
<td>0.064575</td>
<td>0.0</td>
<td>0.9767</td>
<td>0.9816</td>
<td>0.9866</td>
<td>1.0</td>
<td>-14.755318</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">46</td>
<td>YEARS_BEGINEXPLUATATION_AVG</td>
<td>157504.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.977735</td>
<td>0.059223</td>
<td>0.0</td>
<td>0.9767</td>
<td>0.9816</td>
<td>0.9866</td>
<td>1.0</td>
<td>-15.515264</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">74</td>
<td>YEARS_BEGINEXPLUATATION_MEDI</td>
<td>157504.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.977752</td>
<td>0.059897</td>
<td>0.0</td>
<td>0.9767</td>
<td>0.9816</td>
<td>0.9866</td>
<td>1.0</td>
<td>-15.573124</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25</td>
<td>FLAG_CONT_MOBILE</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.998133</td>
<td>0.043164</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>-23.081172</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>FLAG_MOBIL</td>
<td>307511.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.999997</td>
<td>0.001803</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>-554.536744</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NAME_CONTRACT_TYPE</td>
<td>307511</td>
<td>2</td>
<td>Cash loans</td>
<td>278232</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>CODE_GENDER</td>
<td>307511</td>
<td>3</td>
<td>F</td>
<td>202448</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>FLAG_OWN_CAR</td>
<td>307511</td>
<td>2</td>
<td>N</td>
<td>202924</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>FLAG_OWN_REALTY</td>
<td>307511</td>
<td>2</td>
<td>Y</td>
<td>213312</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>NAME_TYPE_SUITE</td>
<td>306219</td>
<td>7</td>
<td>Unaccompanied</td>
<td>248526</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>NAME_INCOME_TYPE</td>
<td>307511</td>
<td>8</td>
<td>Working</td>
<td>158774</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>NAME_EDUCATION_TYPE</td>
<td>307511</td>
<td>5</td>
<td>Secondary / secondary special</td>
<td>218391</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>NAME_FAMILY_STATUS</td>
<td>307511</td>
<td>6</td>
<td>Married</td>
<td>196432</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>NAME_HOUSING_TYPE</td>
<td>307511</td>
<td>6</td>
<td>House / apartment</td>
<td>272868</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">28</td>
<td>OCCUPATION_TYPE</td>
<td>211120</td>
<td>18</td>
<td>Laborers</td>
<td>55186</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32</td>
<td>WEEKDAY_APPR_PROCESS_START</td>
<td>307511</td>
<td>7</td>
<td>TUESDAY</td>
<td>53901</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">40</td>
<td>ORGANIZATION_TYPE</td>
<td>307511</td>
<td>58</td>
<td>Business Entity Type 3</td>
<td>67992</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">86</td>
<td>FONDKAPREMONT_MODE</td>
<td>97216</td>
<td>4</td>
<td>reg oper account</td>
<td>73830</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">87</td>
<td>HOUSETYPE_MODE</td>
<td>153214</td>
<td>3</td>
<td>block of flats</td>
<td>150503</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">89</td>
<td>WALLSMATERIAL_MODE</td>
<td>151170</td>
<td>7</td>
<td>Panel</td>
<td>66040</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">90</td>
<td>EMERGENCYSTATE_MODE</td>
<td>161756</td>
<td>2</td>
<td>No</td>
<td>159428</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="결측치-확인" class="level4">
<h4 class="anchored" data-anchor-id="결측치-확인">결측치 확인</h4>
<ul>
<li>isnull()을 활용한 결측치 확인</li>
</ul>
<div id="1edd3778" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> data.isnull().<span class="bu">sum</span>().sort_values(ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>percent <span class="op">=</span> (data.isnull().<span class="bu">sum</span>()<span class="op">/</span>data.isnull().count()<span class="op">*</span><span class="dv">100</span>).sort_values(ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>missing_data  <span class="op">=</span> pd.concat([total, percent], axis<span class="op">=</span><span class="dv">1</span>, keys<span class="op">=</span>[<span class="st">'total'</span>, <span class="st">'percent'</span>])</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>missing_data[missing_data[<span class="st">'percent'</span>]<span class="op">!=</span><span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">total</th>
<th data-quarto-table-cell-role="th">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">COMMONAREA_MEDI</td>
<td>214865</td>
<td>69.872297</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">COMMONAREA_AVG</td>
<td>214865</td>
<td>69.872297</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">COMMONAREA_MODE</td>
<td>214865</td>
<td>69.872297</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">NONLIVINGAPARTMENTS_MODE</td>
<td>213514</td>
<td>69.432963</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">NONLIVINGAPARTMENTS_AVG</td>
<td>213514</td>
<td>69.432963</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">NONLIVINGAPARTMENTS_MEDI</td>
<td>213514</td>
<td>69.432963</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">FONDKAPREMONT_MODE</td>
<td>210295</td>
<td>68.386172</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LIVINGAPARTMENTS_MODE</td>
<td>210199</td>
<td>68.354953</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">LIVINGAPARTMENTS_AVG</td>
<td>210199</td>
<td>68.354953</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LIVINGAPARTMENTS_MEDI</td>
<td>210199</td>
<td>68.354953</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">FLOORSMIN_AVG</td>
<td>208642</td>
<td>67.848630</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">FLOORSMIN_MODE</td>
<td>208642</td>
<td>67.848630</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">FLOORSMIN_MEDI</td>
<td>208642</td>
<td>67.848630</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">YEARS_BUILD_MEDI</td>
<td>204488</td>
<td>66.497784</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">YEARS_BUILD_MODE</td>
<td>204488</td>
<td>66.497784</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">YEARS_BUILD_AVG</td>
<td>204488</td>
<td>66.497784</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OWN_CAR_AGE</td>
<td>202929</td>
<td>65.990810</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LANDAREA_MEDI</td>
<td>182590</td>
<td>59.376738</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">LANDAREA_MODE</td>
<td>182590</td>
<td>59.376738</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LANDAREA_AVG</td>
<td>182590</td>
<td>59.376738</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">BASEMENTAREA_MEDI</td>
<td>179943</td>
<td>58.515956</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">BASEMENTAREA_AVG</td>
<td>179943</td>
<td>58.515956</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">BASEMENTAREA_MODE</td>
<td>179943</td>
<td>58.515956</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">EXT_SOURCE_1</td>
<td>173378</td>
<td>56.381073</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">NONLIVINGAREA_MODE</td>
<td>169682</td>
<td>55.179164</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">NONLIVINGAREA_AVG</td>
<td>169682</td>
<td>55.179164</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">NONLIVINGAREA_MEDI</td>
<td>169682</td>
<td>55.179164</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ELEVATORS_MEDI</td>
<td>163891</td>
<td>53.295980</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ELEVATORS_AVG</td>
<td>163891</td>
<td>53.295980</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ELEVATORS_MODE</td>
<td>163891</td>
<td>53.295980</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">WALLSMATERIAL_MODE</td>
<td>156341</td>
<td>50.840783</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">APARTMENTS_MEDI</td>
<td>156061</td>
<td>50.749729</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">APARTMENTS_AVG</td>
<td>156061</td>
<td>50.749729</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">APARTMENTS_MODE</td>
<td>156061</td>
<td>50.749729</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ENTRANCES_MEDI</td>
<td>154828</td>
<td>50.348768</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ENTRANCES_AVG</td>
<td>154828</td>
<td>50.348768</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ENTRANCES_MODE</td>
<td>154828</td>
<td>50.348768</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LIVINGAREA_AVG</td>
<td>154350</td>
<td>50.193326</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">LIVINGAREA_MODE</td>
<td>154350</td>
<td>50.193326</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LIVINGAREA_MEDI</td>
<td>154350</td>
<td>50.193326</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">HOUSETYPE_MODE</td>
<td>154297</td>
<td>50.176091</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">FLOORSMAX_MODE</td>
<td>153020</td>
<td>49.760822</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">FLOORSMAX_MEDI</td>
<td>153020</td>
<td>49.760822</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">FLOORSMAX_AVG</td>
<td>153020</td>
<td>49.760822</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">YEARS_BEGINEXPLUATATION_MODE</td>
<td>150007</td>
<td>48.781019</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">YEARS_BEGINEXPLUATATION_MEDI</td>
<td>150007</td>
<td>48.781019</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">YEARS_BEGINEXPLUATATION_AVG</td>
<td>150007</td>
<td>48.781019</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">TOTALAREA_MODE</td>
<td>148431</td>
<td>48.268517</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">EMERGENCYSTATE_MODE</td>
<td>145755</td>
<td>47.398304</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">OCCUPATION_TYPE</td>
<td>96391</td>
<td>31.345545</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">EXT_SOURCE_3</td>
<td>60965</td>
<td>19.825307</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_HOUR</td>
<td>41519</td>
<td>13.501631</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_DAY</td>
<td>41519</td>
<td>13.501631</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_WEEK</td>
<td>41519</td>
<td>13.501631</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_MON</td>
<td>41519</td>
<td>13.501631</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_QRT</td>
<td>41519</td>
<td>13.501631</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_YEAR</td>
<td>41519</td>
<td>13.501631</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">NAME_TYPE_SUITE</td>
<td>1292</td>
<td>0.420148</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OBS_30_CNT_SOCIAL_CIRCLE</td>
<td>1021</td>
<td>0.332021</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">DEF_30_CNT_SOCIAL_CIRCLE</td>
<td>1021</td>
<td>0.332021</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">OBS_60_CNT_SOCIAL_CIRCLE</td>
<td>1021</td>
<td>0.332021</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">DEF_60_CNT_SOCIAL_CIRCLE</td>
<td>1021</td>
<td>0.332021</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">EXT_SOURCE_2</td>
<td>660</td>
<td>0.214626</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AMT_GOODS_PRICE</td>
<td>278</td>
<td>0.090403</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AMT_ANNUITY</td>
<td>12</td>
<td>0.003902</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CNT_FAM_MEMBERS</td>
<td>2</td>
<td>0.000650</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">DAYS_LAST_PHONE_CHANGE</td>
<td>1</td>
<td>0.000325</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>전체 데이터에서, 결측이 10% 이상인 컬럼 확인
<ul>
<li>몇 퍼센트의 결측치를 볼지는 개인별 선택</li>
</ul></li>
<li>결측치가 많으므로 단순히 Drop할 것이 아니라 Imputation(대체)이 필요함</li>
</ul>
<div id="9a54072a" class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>missing_data[missing_data.percent <span class="op">&gt;=</span> <span class="dv">10</span>].shape[<span class="dv">0</span>]<span class="op">/</span>missing_data.shape[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.4672131147540984</code></pre>
</div>
</div>
</section>
<section id="이상치-확인" class="level4">
<h4 class="anchored" data-anchor-id="이상치-확인">이상치 확인</h4>
<ul>
<li><p>결측치와 달리, 이상치는 기준을 정해야 함</p>
<ul>
<li>일반적으로 IQR을 기준으로 많이 작업(모수의 분포를 모르므로)</li>
<li>IQR(Q3-Q1)을 기준으로, <span class="math inline">\(Q1 - 1.5*IQR\)</span> 보다 작거나, <span class="math inline">\(Q3 + 1.5*IQR\)</span> 보다 크면 이상치라고 함</li>
</ul></li>
<li><p>분위수를 구하는 quantile함수를 활용해, Q1, Q3, IQR을 직접 구하는 함수를 구현할 수 있음</p></li>
<li><p>이상치 확인할 때, 결측치 제외하는 것이 중요함</p></li>
<li><p>이상치 확인하기 (결측치 제외되지 않은 사례)</p>
<ul>
<li>이상치 비율이 비정상적으로 큰 것을 볼 수 있음</li>
</ul></li>
</ul>
<div id="353730c9" class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> detect_outliers(df):</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  outlier_flags <span class="op">=</span> df.copy()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> column <span class="kw">in</span> df.columns:</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    col_data <span class="op">=</span> df[column].dropna()  <span class="co"># 결측치 제외   → 이상치를 구하는데 영향을 끼치므로</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    Q1 <span class="op">=</span> col_data.quantile(<span class="fl">0.25</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    Q3 <span class="op">=</span> col_data.quantile(<span class="fl">0.75</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    lower_bound <span class="op">=</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    upper_bound <span class="op">=</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    outlier_flags[column] <span class="op">=</span> df[column].<span class="bu">apply</span>(</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> x: <span class="kw">not</span> lower_bound <span class="op">&lt;=</span> x <span class="op">&lt;=</span> upper_bound</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> outlier_flags</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>outliers_total <span class="op">=</span> detect_outliers(numerical_data).<span class="bu">sum</span>().sort_values(ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>outliers_percent <span class="op">=</span> (detect_outliers(numerical_data).<span class="bu">sum</span>()<span class="op">/</span>detect_outliers(numerical_data).count()<span class="op">*</span><span class="dv">100</span>).sort_values(ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>outliers_data  <span class="op">=</span> pd.concat([outliers_total, outliers_percent], axis<span class="op">=</span><span class="dv">1</span>, keys<span class="op">=</span>[<span class="st">'total'</span>, <span class="st">'percent'</span>])</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>outliers_data.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">total</th>
<th data-quarto-table-cell-role="th">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">NONLIVINGAPARTMENTS_AVG</td>
<td>229094</td>
<td>74.499449</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">NONLIVINGAPARTMENTS_MEDI</td>
<td>228729</td>
<td>74.380754</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">NONLIVINGAPARTMENTS_MODE</td>
<td>227738</td>
<td>74.058489</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">COMMONAREA_MEDI</td>
<td>222869</td>
<td>72.475131</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">COMMONAREA_AVG</td>
<td>222807</td>
<td>72.454969</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">COMMONAREA_MODE</td>
<td>222803</td>
<td>72.453668</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">LIVINGAPARTMENTS_MEDI</td>
<td>218126</td>
<td>70.932747</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">LIVINGAPARTMENTS_AVG</td>
<td>218080</td>
<td>70.917788</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">LIVINGAPARTMENTS_MODE</td>
<td>217668</td>
<td>70.783809</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">FLOORSMIN_MEDI</td>
<td>208986</td>
<td>67.960496</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>이상치 확인하기 (결측치 제외된 사례)
<ul>
<li>이상치의 비중이 26, 25%와 같이 높은 편으로, 단순히 제거하여 해결하는 것은 좋지 않음</li>
<li>시각화까지 진행해보고, 이후 방향을 결정</li>
</ul></li>
</ul>
<div id="0d566558" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> detect_outliers_wo_nan(df):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  outlier_flags <span class="op">=</span> df.copy()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> column <span class="kw">in</span> df.columns:</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    col_data <span class="op">=</span> df[column].dropna()  <span class="co"># 결측치 제외</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    Q1 <span class="op">=</span> col_data.quantile(<span class="fl">0.25</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    Q3 <span class="op">=</span> col_data.quantile(<span class="fl">0.75</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    lower_bound <span class="op">=</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    upper_bound <span class="op">=</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    outlier_flags[column] <span class="op">=</span> df[column].<span class="bu">apply</span>(</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> x: <span class="kw">not</span> lower_bound <span class="op">&lt;=</span> x <span class="op">&lt;=</span> upper_bound <span class="cf">if</span> pd.notna(x) <span class="cf">else</span> <span class="va">False</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> outlier_flags</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0b25b733" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>outliers_total <span class="op">=</span> detect_outliers_wo_nan(numerical_data).<span class="bu">sum</span>().sort_values(ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>outliers_percent <span class="op">=</span> (detect_outliers_wo_nan(numerical_data).<span class="bu">sum</span>()<span class="op">/</span>detect_outliers_wo_nan(numerical_data).count()<span class="op">*</span><span class="dv">100</span>).sort_values(ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>outliers_data  <span class="op">=</span> pd.concat([outliers_total, outliers_percent], axis<span class="op">=</span><span class="dv">1</span>, keys<span class="op">=</span>[<span class="st">'total'</span>, <span class="st">'percent'</span>])</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>outliers_data.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">total</th>
<th data-quarto-table-cell-role="th">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">REGION_RATING_CLIENT</td>
<td>80527</td>
<td>26.186706</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">REGION_RATING_CLIENT_W_CITY</td>
<td>78027</td>
<td>25.373726</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">DAYS_EMPLOYED</td>
<td>72217</td>
<td>23.484363</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">REG_CITY_NOT_WORK_CITY</td>
<td>70867</td>
<td>23.045354</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">FLAG_WORK_PHONE</td>
<td>61308</td>
<td>19.936848</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">FLAG_EMP_PHONE</td>
<td>55386</td>
<td>18.011063</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">LIVE_CITY_NOT_WORK_CITY</td>
<td>55215</td>
<td>17.955455</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_QRT</td>
<td>50575</td>
<td>16.446566</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_MON</td>
<td>43759</td>
<td>14.230060</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">DEF_30_CNT_SOCIAL_CIRCLE</td>
<td>35166</td>
<td>11.435688</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="심화1-벡터연산을-통한-최적화-기존-이상치-연산과-비교" class="level4">
<h4 class="anchored" data-anchor-id="심화1-벡터연산을-통한-최적화-기존-이상치-연산과-비교">심화1 : 벡터연산을 통한 최적화 (기존 이상치 연산과 비교)</h4>
<ul>
<li>pandas를 반복문 대신 벡터연산(numpy)으로 빠르게 처리할 수 있음
<ul>
<li>apply함수 : 각 행/열을 독립적으로 처리하는 벡터화 함수</li>
</ul></li>
<li>하단 코드는 벡터연산 적용한 이상치 찾는 함수 vs 기존의 이상치 찾는 함수의 비교</li>
</ul>
<div id="c00e886c" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> detect_outliers_fast(df):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate IQR without NaN values</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    Q1 <span class="op">=</span> df.quantile(<span class="fl">0.25</span>, interpolation<span class="op">=</span><span class="st">'midpoint'</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    Q3 <span class="op">=</span> df.quantile(<span class="fl">0.75</span>, interpolation<span class="op">=</span><span class="st">'midpoint'</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    lower_bound <span class="op">=</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    upper_bound <span class="op">=</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vectorized outlier detection with NaN handling</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    outlier_flags <span class="op">=</span> df.<span class="bu">apply</span>(</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> col: <span class="op">~</span>col.between(lower_bound[col.name], upper_bound[col.name]) <span class="op">&amp;</span> col.notna()</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> outlier_flags</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a87471dd" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>detect_outliers_wo_nan(numerical_data).head(<span class="dv">5</span>)  <span class="co"># 기존의 (벡터연산 미적용된) 코드</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: total: 13.8 s
Wall time: 14.5 s</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">SK_ID_CURR</th>
<th data-quarto-table-cell-role="th">TARGET</th>
<th data-quarto-table-cell-role="th">CNT_CHILDREN</th>
<th data-quarto-table-cell-role="th">AMT_INCOME_TOTAL</th>
<th data-quarto-table-cell-role="th">AMT_CREDIT</th>
<th data-quarto-table-cell-role="th">AMT_ANNUITY</th>
<th data-quarto-table-cell-role="th">AMT_GOODS_PRICE</th>
<th data-quarto-table-cell-role="th">REGION_POPULATION_RELATIVE</th>
<th data-quarto-table-cell-role="th">DAYS_BIRTH</th>
<th data-quarto-table-cell-role="th">DAYS_EMPLOYED</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_18</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_19</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_20</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_21</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_HOUR</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_DAY</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_WEEK</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_MON</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_QRT</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_YEAR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>5 rows × 106 columns</p>
</div>
</div>
</div>
<div id="56d3a32b" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>detect_outliers_fast(numerical_data).head(<span class="dv">5</span>)  <span class="co"># 벡터연산 적용한 코드</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: total: 797 ms
Wall time: 867 ms</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">SK_ID_CURR</th>
<th data-quarto-table-cell-role="th">TARGET</th>
<th data-quarto-table-cell-role="th">CNT_CHILDREN</th>
<th data-quarto-table-cell-role="th">AMT_INCOME_TOTAL</th>
<th data-quarto-table-cell-role="th">AMT_CREDIT</th>
<th data-quarto-table-cell-role="th">AMT_ANNUITY</th>
<th data-quarto-table-cell-role="th">AMT_GOODS_PRICE</th>
<th data-quarto-table-cell-role="th">REGION_POPULATION_RELATIVE</th>
<th data-quarto-table-cell-role="th">DAYS_BIRTH</th>
<th data-quarto-table-cell-role="th">DAYS_EMPLOYED</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_18</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_19</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_20</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_21</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_HOUR</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_DAY</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_WEEK</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_MON</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_QRT</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_YEAR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>5 rows × 106 columns</p>
</div>
</div>
</div>
</section>
<section id="심화2-polars" class="level4">
<h4 class="anchored" data-anchor-id="심화2-polars">심화2 : Polars</h4>
<ul>
<li>대용량 데이터 처리에 특화된 Polars
<ul>
<li>pandas와 비슷한 문법, 대부분의 경우 pandas보다 빠른 연산</li>
<li>광범위하게 쓰이진 않지만, 대용량 데이터 처리에는 유용함</li>
</ul></li>
</ul>
<div id="b8a7b96a" class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install polars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Collecting polars
  Downloading polars-1.19.0-cp39-abi3-win_amd64.whl.metadata (15 kB)
Downloading polars-1.19.0-cp39-abi3-win_amd64.whl (32.8 MB)
   ---------------------------------------- 0.0/32.8 MB ? eta -:--:--
   -- ------------------------------------- 2.4/32.8 MB 11.2 MB/s eta 0:00:03
   ----- ---------------------------------- 4.7/32.8 MB 11.4 MB/s eta 0:00:03
   -------- ------------------------------- 7.3/32.8 MB 11.6 MB/s eta 0:00:03
   --------- ------------------------------ 7.9/32.8 MB 9.2 MB/s eta 0:00:03
   ----------- ---------------------------- 9.7/32.8 MB 9.2 MB/s eta 0:00:03
   --------------- ------------------------ 12.3/32.8 MB 9.6 MB/s eta 0:00:03
   ----------------- ---------------------- 14.7/32.8 MB 9.9 MB/s eta 0:00:02
   --------------------- ------------------ 17.3/32.8 MB 10.2 MB/s eta 0:00:02
   ----------------------- ---------------- 19.7/32.8 MB 10.3 MB/s eta 0:00:02
   -------------------------- ------------- 22.0/32.8 MB 10.6 MB/s eta 0:00:02
   ---------------------------- ----------- 23.6/32.8 MB 10.2 MB/s eta 0:00:01
   ------------------------------- -------- 26.2/32.8 MB 10.3 MB/s eta 0:00:01
   ---------------------------------- ----- 28.6/32.8 MB 10.4 MB/s eta 0:00:01
   ------------------------------------- -- 31.2/32.8 MB 10.5 MB/s eta 0:00:01
   ---------------------------------------- 32.8/32.8 MB 10.4 MB/s eta 0:00:00
Installing collected packages: polars
Successfully installed polars-1.19.0</code></pre>
</div>
</div>
<div id="fd3c0800" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Polars 활용한 코드</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>numerical_data_polars <span class="op">=</span> pl.from_pandas(numerical_data)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> detect_outliers_polars(df):</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    q1 <span class="op">=</span> df.quantile(<span class="fl">0.25</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    q3 <span class="op">=</span> df.quantile(<span class="fl">0.75</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    iqr <span class="op">=</span> q3 <span class="op">-</span> q1</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    lower_bound <span class="op">=</span> q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> iqr</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    upper_bound <span class="op">=</span> q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> iqr</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    outlier_flags <span class="op">=</span> df.with_columns(</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        [</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>            <span class="op">~</span>((pl.col(col) <span class="op">&gt;=</span> lower_bound[col]) <span class="op">&amp;</span> (pl.col(col) <span class="op">&lt;=</span> upper_bound[col])) <span class="co"># 범위 계산</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>            .fill_null(<span class="va">False</span>) <span class="co"># 결측치 제외   → null을 넣지않고 삭제</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>            .alias(col) <span class="co"># 기존 열 이름 유지</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> col <span class="kw">in</span> df.columns</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> outlier_flags</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="89ae4fed" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>detect_outliers_polars(numerical_data_polars).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: total: 1.02 s
Wall time: 266 ms</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 106)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">SK_ID_CURR</th>
<th data-quarto-table-cell-role="th">TARGET</th>
<th data-quarto-table-cell-role="th">CNT_CHILDREN</th>
<th data-quarto-table-cell-role="th">AMT_INCOME_TOTAL</th>
<th data-quarto-table-cell-role="th">AMT_CREDIT</th>
<th data-quarto-table-cell-role="th">AMT_ANNUITY</th>
<th data-quarto-table-cell-role="th">AMT_GOODS_PRICE</th>
<th data-quarto-table-cell-role="th">REGION_POPULATION_RELATIVE</th>
<th data-quarto-table-cell-role="th">DAYS_BIRTH</th>
<th data-quarto-table-cell-role="th">DAYS_EMPLOYED</th>
<th data-quarto-table-cell-role="th">DAYS_REGISTRATION</th>
<th data-quarto-table-cell-role="th">DAYS_ID_PUBLISH</th>
<th data-quarto-table-cell-role="th">OWN_CAR_AGE</th>
<th data-quarto-table-cell-role="th">FLAG_MOBIL</th>
<th data-quarto-table-cell-role="th">FLAG_EMP_PHONE</th>
<th data-quarto-table-cell-role="th">FLAG_WORK_PHONE</th>
<th data-quarto-table-cell-role="th">FLAG_CONT_MOBILE</th>
<th data-quarto-table-cell-role="th">FLAG_PHONE</th>
<th data-quarto-table-cell-role="th">FLAG_EMAIL</th>
<th data-quarto-table-cell-role="th">CNT_FAM_MEMBERS</th>
<th data-quarto-table-cell-role="th">REGION_RATING_CLIENT</th>
<th data-quarto-table-cell-role="th">REGION_RATING_CLIENT_W_CITY</th>
<th data-quarto-table-cell-role="th">HOUR_APPR_PROCESS_START</th>
<th data-quarto-table-cell-role="th">REG_REGION_NOT_LIVE_REGION</th>
<th data-quarto-table-cell-role="th">REG_REGION_NOT_WORK_REGION</th>
<th data-quarto-table-cell-role="th">LIVE_REGION_NOT_WORK_REGION</th>
<th data-quarto-table-cell-role="th">REG_CITY_NOT_LIVE_CITY</th>
<th data-quarto-table-cell-role="th">REG_CITY_NOT_WORK_CITY</th>
<th data-quarto-table-cell-role="th">LIVE_CITY_NOT_WORK_CITY</th>
<th data-quarto-table-cell-role="th">EXT_SOURCE_1</th>
<th data-quarto-table-cell-role="th">EXT_SOURCE_2</th>
<th data-quarto-table-cell-role="th">EXT_SOURCE_3</th>
<th data-quarto-table-cell-role="th">APARTMENTS_AVG</th>
<th data-quarto-table-cell-role="th">BASEMENTAREA_AVG</th>
<th data-quarto-table-cell-role="th">YEARS_BEGINEXPLUATATION_AVG</th>
<th data-quarto-table-cell-role="th">YEARS_BUILD_AVG</th>
<th data-quarto-table-cell-role="th">COMMONAREA_AVG</th>
<th data-quarto-table-cell-role="th">…</th>
<th data-quarto-table-cell-role="th">LANDAREA_MEDI</th>
<th data-quarto-table-cell-role="th">LIVINGAPARTMENTS_MEDI</th>
<th data-quarto-table-cell-role="th">LIVINGAREA_MEDI</th>
<th data-quarto-table-cell-role="th">NONLIVINGAPARTMENTS_MEDI</th>
<th data-quarto-table-cell-role="th">NONLIVINGAREA_MEDI</th>
<th data-quarto-table-cell-role="th">TOTALAREA_MODE</th>
<th data-quarto-table-cell-role="th">OBS_30_CNT_SOCIAL_CIRCLE</th>
<th data-quarto-table-cell-role="th">DEF_30_CNT_SOCIAL_CIRCLE</th>
<th data-quarto-table-cell-role="th">OBS_60_CNT_SOCIAL_CIRCLE</th>
<th data-quarto-table-cell-role="th">DEF_60_CNT_SOCIAL_CIRCLE</th>
<th data-quarto-table-cell-role="th">DAYS_LAST_PHONE_CHANGE</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_2</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_3</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_4</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_5</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_6</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_7</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_8</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_9</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_10</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_11</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_12</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_13</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_14</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_15</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_16</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_17</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_18</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_19</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_20</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_21</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_HOUR</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_DAY</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_WEEK</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_MON</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_QRT</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_YEAR</th>
</tr>
<tr class="even">
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>…</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
<th>bool</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>false</td>
<td>true</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>true</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>…</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>true</td>
<td>false</td>
<td>true</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
</tr>
<tr class="even">
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>true</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>true</td>
<td>true</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>true</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>…</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
</tr>
<tr class="odd">
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>true</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>true</td>
<td>false</td>
<td>false</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>…</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
</tr>
<tr class="even">
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>true</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>true</td>
<td>false</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>…</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
</tr>
<tr class="odd">
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>true</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>false</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>…</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>true</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="y의-불균형도-확인" class="level4">
<h4 class="anchored" data-anchor-id="y의-불균형도-확인">y의 불균형도 확인</h4>
<ul>
<li>pandas의 value_counts : SQL의 group by + count</li>
</ul>
<div id="cad53d0c" class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'TARGET'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>TARGET
0    282686
1     24825
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="실습1-확인한-통계량을-가지고-시각화-고민하기" class="level2">
<h2 class="anchored" data-anchor-id="실습1-확인한-통계량을-가지고-시각화-고민하기">실습1 : 확인한 통계량을 가지고 시각화 고민하기</h2>
<ul>
<li>지금까지 본 수치를 기반으로 각 변수별로 어떤 시각화가 필요할지 고민해봅시다.
<ul>
<li>범주형 변수(describe기준 unique값 있는 경우)에 대해 barplot</li>
<li>대부분 변수에 대해 Histogram으로 분포 확인</li>
<li>결측치(Null)을 제외한 후 Box plot으로 이상치 확인</li>
<li>Heatmap을 활용한 상관계수 확인</li>
</ul></li>
</ul>
<div id="30145d7c" class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data.describe(include<span class="op">=</span><span class="st">'all'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">SK_ID_CURR</th>
<th data-quarto-table-cell-role="th">TARGET</th>
<th data-quarto-table-cell-role="th">NAME_CONTRACT_TYPE</th>
<th data-quarto-table-cell-role="th">CODE_GENDER</th>
<th data-quarto-table-cell-role="th">FLAG_OWN_CAR</th>
<th data-quarto-table-cell-role="th">FLAG_OWN_REALTY</th>
<th data-quarto-table-cell-role="th">CNT_CHILDREN</th>
<th data-quarto-table-cell-role="th">AMT_INCOME_TOTAL</th>
<th data-quarto-table-cell-role="th">AMT_CREDIT</th>
<th data-quarto-table-cell-role="th">AMT_ANNUITY</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_18</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_19</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_20</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_21</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_HOUR</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_DAY</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_WEEK</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_MON</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_QRT</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_YEAR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>307511.000000</td>
<td>307511.000000</td>
<td>307511</td>
<td>307511</td>
<td>307511</td>
<td>307511</td>
<td>307511.000000</td>
<td>3.075110e+05</td>
<td>3.075110e+05</td>
<td>307499.000000</td>
<td>...</td>
<td>307511.000000</td>
<td>307511.000000</td>
<td>307511.000000</td>
<td>307511.000000</td>
<td>265992.000000</td>
<td>265992.000000</td>
<td>265992.000000</td>
<td>265992.000000</td>
<td>265992.000000</td>
<td>265992.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">unique</td>
<td>NaN</td>
<td>NaN</td>
<td>2</td>
<td>3</td>
<td>2</td>
<td>2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">top</td>
<td>NaN</td>
<td>NaN</td>
<td>Cash loans</td>
<td>F</td>
<td>N</td>
<td>Y</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">freq</td>
<td>NaN</td>
<td>NaN</td>
<td>278232</td>
<td>202448</td>
<td>202924</td>
<td>213312</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">mean</td>
<td>278180.518577</td>
<td>0.080729</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.417052</td>
<td>1.687979e+05</td>
<td>5.990260e+05</td>
<td>27108.573909</td>
<td>...</td>
<td>0.008130</td>
<td>0.000595</td>
<td>0.000507</td>
<td>0.000335</td>
<td>0.006402</td>
<td>0.007000</td>
<td>0.034362</td>
<td>0.267395</td>
<td>0.265474</td>
<td>1.899974</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">std</td>
<td>102790.175348</td>
<td>0.272419</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.722121</td>
<td>2.371231e+05</td>
<td>4.024908e+05</td>
<td>14493.737315</td>
<td>...</td>
<td>0.089798</td>
<td>0.024387</td>
<td>0.022518</td>
<td>0.018299</td>
<td>0.083849</td>
<td>0.110757</td>
<td>0.204685</td>
<td>0.916002</td>
<td>0.794056</td>
<td>1.869295</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">min</td>
<td>100002.000000</td>
<td>0.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000000</td>
<td>2.565000e+04</td>
<td>4.500000e+04</td>
<td>1615.500000</td>
<td>...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25%</td>
<td>189145.500000</td>
<td>0.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000000</td>
<td>1.125000e+05</td>
<td>2.700000e+05</td>
<td>16524.000000</td>
<td>...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50%</td>
<td>278202.000000</td>
<td>0.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000000</td>
<td>1.471500e+05</td>
<td>5.135310e+05</td>
<td>24903.000000</td>
<td>...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75%</td>
<td>367142.500000</td>
<td>0.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.000000</td>
<td>2.025000e+05</td>
<td>8.086500e+05</td>
<td>34596.000000</td>
<td>...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">max</td>
<td>456255.000000</td>
<td>1.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>19.000000</td>
<td>1.170000e+08</td>
<td>4.050000e+06</td>
<td>258025.500000</td>
<td>...</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>4.000000</td>
<td>9.000000</td>
<td>8.000000</td>
<td>27.000000</td>
<td>261.000000</td>
<td>25.000000</td>
</tr>
</tbody>
</table>

<p>11 rows × 122 columns</p>
</div>
</div>
</div>
</section>
<section id="시각화" class="level2">
<h2 class="anchored" data-anchor-id="시각화">시각화</h2>
<ul>
<li>일단 기본적인 histogram, barplot을 그려보기
<ul>
<li>수치형 변수는 histogram, 범주형 변수는 bar plot</li>
<li>select_dtypes 활용</li>
</ul></li>
</ul>
<section id="histogram" class="level3">
<h3 class="anchored" data-anchor-id="histogram">Histogram</h3>
<ul>
<li>수치형데이터에 대해 histogram 그리기</li>
<li>Matplotlib와 Seaborn으로 나누어 실습</li>
</ul>
<div id="aeecce1e" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>numeric_data <span class="op">=</span> data.select_dtypes(include<span class="op">=</span>[<span class="st">'float64'</span>, <span class="st">'int64'</span>])</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>numeric_data.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">SK_ID_CURR</th>
<th data-quarto-table-cell-role="th">TARGET</th>
<th data-quarto-table-cell-role="th">CNT_CHILDREN</th>
<th data-quarto-table-cell-role="th">AMT_INCOME_TOTAL</th>
<th data-quarto-table-cell-role="th">AMT_CREDIT</th>
<th data-quarto-table-cell-role="th">AMT_ANNUITY</th>
<th data-quarto-table-cell-role="th">AMT_GOODS_PRICE</th>
<th data-quarto-table-cell-role="th">REGION_POPULATION_RELATIVE</th>
<th data-quarto-table-cell-role="th">DAYS_BIRTH</th>
<th data-quarto-table-cell-role="th">DAYS_EMPLOYED</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_18</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_19</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_20</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_21</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_HOUR</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_DAY</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_WEEK</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_MON</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_QRT</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_YEAR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>100002</td>
<td>1</td>
<td>0</td>
<td>202500.0</td>
<td>406597.5</td>
<td>24700.5</td>
<td>351000.0</td>
<td>0.018801</td>
<td>-9461</td>
<td>-637</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>100003</td>
<td>0</td>
<td>0</td>
<td>270000.0</td>
<td>1293502.5</td>
<td>35698.5</td>
<td>1129500.0</td>
<td>0.003541</td>
<td>-16765</td>
<td>-1188</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>100004</td>
<td>0</td>
<td>0</td>
<td>67500.0</td>
<td>135000.0</td>
<td>6750.0</td>
<td>135000.0</td>
<td>0.010032</td>
<td>-19046</td>
<td>-225</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

<p>3 rows × 106 columns</p>
</div>
</div>
</div>
<div id="7104f6ec" class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matplotlib와 Seaborn 그래프</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 준비</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>var_idx <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>var_nm <span class="op">=</span> numeric_data.columns[var_idx]</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 서브플롯 생성</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">6</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 코드 1: Matplotlib Graph (좌측)</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].hist(numeric_data[var_nm], bins<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="ss">f'Histogram of </span><span class="sc">{</span>var_nm<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Values'</span>)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 코드 2: Seaborn Graph (우측)</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>sns.histplot(data[var_nm], kde<span class="op">=</span><span class="va">True</span>, bins<span class="op">=</span><span class="st">'auto'</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="ss">f'Histogram of </span><span class="sc">{</span>var_nm<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Values'</span>)</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 전체 그래프 간격 조정</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-22-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>0~1 사이에 분포하는 컬럼이 많음 → 많은 컬럼이 정규화 되어있음</li>
<li>앞서 왜도가 높았던 컬럼의 확인 결과
<ul>
<li>AMT_INCOME_TOTAL(391.559654) : 식별이 어려워 bin값 조정필요</li>
<li>YEARS_BEGINEXPLUATATION_MEDI(-15.573124) : 왜도와 달리 값이 치우치지 않아보임</li>
<li>FLAG_CONT_MOBILE(-23.081172) : 왜도와 달리 값이 치우치지 않아보임</li>
<li>FLAG_MOBIL(-554.536744) : 왜도와 달리 값이 치우치지 않아보임</li>
</ul></li>
</ul>
<div id="db74b1f0" class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 설정: 가로 그래프 개수</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>num_vars <span class="op">=</span> <span class="bu">len</span>(numeric_data.columns)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> math.ceil(num_vars <span class="op">/</span> cols)  <span class="co"># 필요한 행(row) 수 계산</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 서브플롯 생성</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(rows, cols, figsize<span class="op">=</span>(<span class="dv">15</span>, rows <span class="op">*</span> <span class="dv">3</span>))  <span class="co"># 전체 figure 크기 조정</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()  <span class="co"># 2D 배열을 1D로 변환하여 인덱싱 편리하게</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 그래프 그리기</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var_idx, var_nm <span class="kw">in</span> <span class="bu">enumerate</span>(numeric_data.columns):</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> axes[var_idx]</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    ax.hist(numeric_data.iloc[:, var_idx], bins<span class="op">=</span><span class="st">'auto'</span>, color<span class="op">=</span><span class="st">'skyblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'Histogram of </span><span class="sc">{</span>var_nm<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'Values'</span>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 빈 서브플롯 숨기기</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_vars, <span class="bu">len</span>(axes)):</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    axes[i].axis(<span class="st">'off'</span>)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-23-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="실습2-시각화-실습" class="level3">
<h3 class="anchored" data-anchor-id="실습2-시각화-실습">실습2 : 시각화 실습</h3>
<ul>
<li>AMT_INCOME_TOTAL을 다시 시각화해봅시다. bins 변수를 적절히 조정해서 잘 보이게 해봅시다.</li>
</ul>
<div id="de43fef2" class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>var_idx <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">3</span>))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>plt.hist(numeric_data.iloc[:,var_idx], bins<span class="op">=</span><span class="dv">3</span>) <span class="co"># 컬럼명 기준으로 인덱싱시 발생할 수 있는 오류 예방.</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f'Histogram of </span><span class="sc">{</span>var_nm<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Values'</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-24-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="barplot" class="level3">
<h3 class="anchored" data-anchor-id="barplot">Barplot</h3>
<ul>
<li><code>plt.bar</code> or <code>sns.barplot</code>으로 시각화</li>
</ul>
<div id="35307765" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>categorical_data <span class="op">=</span> data.select_dtypes(include<span class="op">=</span>[<span class="st">'object'</span>, <span class="st">'category'</span>])</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>categorical_data.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NAME_CONTRACT_TYPE</th>
<th data-quarto-table-cell-role="th">CODE_GENDER</th>
<th data-quarto-table-cell-role="th">FLAG_OWN_CAR</th>
<th data-quarto-table-cell-role="th">FLAG_OWN_REALTY</th>
<th data-quarto-table-cell-role="th">NAME_TYPE_SUITE</th>
<th data-quarto-table-cell-role="th">NAME_INCOME_TYPE</th>
<th data-quarto-table-cell-role="th">NAME_EDUCATION_TYPE</th>
<th data-quarto-table-cell-role="th">NAME_FAMILY_STATUS</th>
<th data-quarto-table-cell-role="th">NAME_HOUSING_TYPE</th>
<th data-quarto-table-cell-role="th">OCCUPATION_TYPE</th>
<th data-quarto-table-cell-role="th">WEEKDAY_APPR_PROCESS_START</th>
<th data-quarto-table-cell-role="th">ORGANIZATION_TYPE</th>
<th data-quarto-table-cell-role="th">FONDKAPREMONT_MODE</th>
<th data-quarto-table-cell-role="th">HOUSETYPE_MODE</th>
<th data-quarto-table-cell-role="th">WALLSMATERIAL_MODE</th>
<th data-quarto-table-cell-role="th">EMERGENCYSTATE_MODE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Cash loans</td>
<td>M</td>
<td>N</td>
<td>Y</td>
<td>Unaccompanied</td>
<td>Working</td>
<td>Secondary / secondary special</td>
<td>Single / not married</td>
<td>House / apartment</td>
<td>Laborers</td>
<td>WEDNESDAY</td>
<td>Business Entity Type 3</td>
<td>reg oper account</td>
<td>block of flats</td>
<td>Stone, brick</td>
<td>No</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Cash loans</td>
<td>F</td>
<td>N</td>
<td>N</td>
<td>Family</td>
<td>State servant</td>
<td>Higher education</td>
<td>Married</td>
<td>House / apartment</td>
<td>Core staff</td>
<td>MONDAY</td>
<td>School</td>
<td>reg oper account</td>
<td>block of flats</td>
<td>Block</td>
<td>No</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Revolving loans</td>
<td>M</td>
<td>Y</td>
<td>Y</td>
<td>Unaccompanied</td>
<td>Working</td>
<td>Secondary / secondary special</td>
<td>Single / not married</td>
<td>House / apartment</td>
<td>Laborers</td>
<td>MONDAY</td>
<td>Government</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Cash loans</td>
<td>F</td>
<td>N</td>
<td>Y</td>
<td>Unaccompanied</td>
<td>Working</td>
<td>Secondary / secondary special</td>
<td>Civil marriage</td>
<td>House / apartment</td>
<td>Laborers</td>
<td>WEDNESDAY</td>
<td>Business Entity Type 3</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Cash loans</td>
<td>M</td>
<td>N</td>
<td>Y</td>
<td>Unaccompanied</td>
<td>Working</td>
<td>Secondary / secondary special</td>
<td>Single / not married</td>
<td>House / apartment</td>
<td>Core staff</td>
<td>THURSDAY</td>
<td>Religion</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>하단의 범주형변수 시각화를 통해 알 수 있는 점
<ul>
<li>대체로 불균형한 분포를 보임</li>
<li>대부분 unique값이 많지 않아, one-hot인코딩에 크게 문제가 없어보임</li>
<li>Education_type은 순위가 있는 변수이므로 인코딩할 때 유의</li>
</ul></li>
</ul>
<div id="78d9343d" class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 설정: 가로 그래프 개수</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>num_vars <span class="op">=</span> <span class="bu">len</span>(categorical_data.columns)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> math.ceil(num_vars <span class="op">/</span> cols)  <span class="co"># 필요한 행(row) 수 계산</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 서브플롯 생성</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(rows, cols, figsize<span class="op">=</span>(<span class="dv">15</span>, rows <span class="op">*</span> <span class="dv">4</span>))  <span class="co"># 전체 figure 크기 조정</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()  <span class="co"># 2D 배열을 1D로 변환하여 인덱싱 편리하게</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 그래프 그리기</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var_idx, var_nm <span class="kw">in</span> <span class="bu">enumerate</span>(categorical_data.columns):</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> axes[var_idx]</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    value_counts <span class="op">=</span> categorical_data[var_nm].value_counts().reset_index()</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    value_counts.columns <span class="op">=</span> [var_nm, <span class="st">'Count'</span>]</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    sns.barplot(x<span class="op">=</span>var_nm, y<span class="op">=</span><span class="st">'Count'</span>, data<span class="op">=</span>value_counts, ax<span class="op">=</span>ax)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'Bar Plot of </span><span class="sc">{</span>var_nm<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(var_nm)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Count'</span>)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 빈 서브플롯 숨기기</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_vars, <span class="bu">len</span>(axes)):</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    axes[i].axis(<span class="st">'off'</span>)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Target(y)값 기준으로 나누어서(Stack) 그릴 수도 있음</li>
</ul>
<div id="f40b3b35" class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># TARGET 데이터 합치기</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>combined_data <span class="op">=</span> categorical_data.copy()</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>combined_data[<span class="st">'TARGET'</span>] <span class="op">=</span> data[<span class="st">'TARGET'</span>]  <span class="co"># 동일한 인덱스를 기준으로 TARGET 추가</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 설정: 가로 그래프 개수</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>num_vars <span class="op">=</span> <span class="bu">len</span>(categorical_data.columns)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> math.ceil(num_vars <span class="op">/</span> cols)  <span class="co"># 필요한 행(row) 수 계산</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 서브플롯 생성</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(rows, cols, figsize<span class="op">=</span>(<span class="dv">18</span>, rows <span class="op">*</span> <span class="dv">5</span>))  <span class="co"># 전체 figure 크기 조정</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()  <span class="co"># 2D 배열을 1D로 변환하여 인덱싱 편리하게</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 그래프 그리기</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var_idx, var_nm <span class="kw">in</span> <span class="bu">enumerate</span>(categorical_data.columns):</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> axes[var_idx]</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 데이터 그룹화 및 카운트 계산</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    stacked_data <span class="op">=</span> combined_data.groupby([var_nm, <span class="st">'TARGET'</span>]).size().reset_index(name<span class="op">=</span><span class="st">'Count'</span>)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    sns.barplot(x<span class="op">=</span>var_nm, y<span class="op">=</span><span class="st">'Count'</span>, hue<span class="op">=</span><span class="st">'TARGET'</span>, data<span class="op">=</span>stacked_data, dodge<span class="op">=</span><span class="va">False</span>, ax<span class="op">=</span>ax)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'Stacked Bar Plot of </span><span class="sc">{</span>var_nm<span class="sc">}</span><span class="ss"> by TARGET'</span>)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(var_nm)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Count'</span>)</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>    ax.legend(title<span class="op">=</span><span class="st">'TARGET'</span>, loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 빈 서브플롯 숨기기</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_vars, <span class="bu">len</span>(axes)):</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>    axes[i].axis(<span class="st">'off'</span>)</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-27-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="실습3" class="level3">
<h3 class="anchored" data-anchor-id="실습3">실습3</h3>
<ul>
<li>y도 시각화 해봅시다.</li>
</ul>
<div id="43a6c3a6" class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">'TARGET'</span>, data<span class="op">=</span>data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Axes: xlabel='TARGET', ylabel='count'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-28-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="boxplot" class="level3">
<h3 class="anchored" data-anchor-id="boxplot">Boxplot</h3>
<ul>
<li><code>sns.boxplot</code> or <code>plt.boxplot</code>로 시각화 가능</li>
<li>이상치에 대해 시각화 (10%가 넘는 경우 시각화 해보기)</li>
<li>아래 boxplot 시각화를 기준으로
<ul>
<li>0이나 1이 너무 많아, 일반적인 boxplot형태는 아님</li>
<li>DAYS_EMPLOYED는 음의 값이 존재</li>
<li><strong>Drop이 아닌 변환으로 진행</strong></li>
</ul></li>
</ul>
<div id="de8b2ee4" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>outliers_over_10 <span class="op">=</span> outliers_data[outliers_data.percent <span class="op">&gt;</span> <span class="dv">10</span>]</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 설정: 가로 그래프 개수</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>num_vars <span class="op">=</span> <span class="bu">len</span>(outliers_over_10.index)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> math.ceil(num_vars <span class="op">/</span> cols)  <span class="co"># 필요한 행(row) 수 계산</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 서브플롯 생성</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(rows, cols, figsize<span class="op">=</span>(<span class="dv">18</span>, rows <span class="op">*</span> <span class="dv">4</span>))  <span class="co"># 전체 figure 크기 조정</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()  <span class="co"># 2D 배열을 1D로 변환하여 인덱싱 편리하게</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 그래프 그리기</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var_idx, var_nm <span class="kw">in</span> <span class="bu">enumerate</span>(outliers_over_10.index):</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> axes[var_idx]</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    sns.boxplot(x<span class="op">=</span>data[var_nm], ax<span class="op">=</span>ax, color<span class="op">=</span><span class="st">'lightblue'</span>)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'Box Plot of </span><span class="sc">{</span>var_nm<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(var_nm)</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 빈 서브플롯 숨기기</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_vars, <span class="bu">len</span>(axes)):</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    axes[i].axis(<span class="st">'off'</span>)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-29-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lineplot" class="level3">
<h3 class="anchored" data-anchor-id="lineplot">lineplot</h3>
<ul>
<li>사용중인 데이터가 시계열 데이터가 아니므로, 임의의 데이터로 시각화</li>
</ul>
<div id="17fce40d" class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random time series data</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>time_series_data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Date'</span>: pd.date_range(start<span class="op">=</span><span class="st">'2023-01-01'</span>, periods<span class="op">=</span><span class="dv">100</span>, freq<span class="op">=</span><span class="st">'D'</span>),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Value'</span>: np.cumsum(np.random.randn(<span class="dv">100</span>))  <span class="co"># Cumulative sum of random values</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 서브플롯 생성</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">6</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 코드 1: Matplotlib</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(time_series_data[<span class="st">'Date'</span>], time_series_data[<span class="st">'Value'</span>], color<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="st">'Value'</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Time Series Lineplot (Matplotlib)'</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Date'</span>)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Value'</span>)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].legend()</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(<span class="va">True</span>)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 코드 2: Seaborn</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">'Date'</span>, y<span class="op">=</span><span class="st">'Value'</span>, data<span class="op">=</span>time_series_data, color<span class="op">=</span><span class="st">'orange'</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Time Series Lineplot (Seaborn)'</span>)</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Date'</span>)</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(<span class="va">True</span>)</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 그래프 간격 조정</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-30-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="heatmap" class="level3">
<h3 class="anchored" data-anchor-id="heatmap">Heatmap</h3>
<ul>
<li>y변수와의 상관계수를 시각화, 수치형&amp;수치형 변수일 때 사용</li>
<li>seaborn만 가능(matplotlib불가)</li>
<li>사용중인 데이터의 y가 binary이므로, 임의 데이터로 시각화</li>
</ul>
<div id="ea98b5ff" class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a random example dataset</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>example_data <span class="op">=</span> pd.DataFrame(</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    np.random.rand(<span class="dv">10</span>, <span class="dv">10</span>),</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="ss">f'Feature_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)]</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the correlation matrix</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> example_data.corr()</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the heatmap using seaborn</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'.2f'</span>, cmap<span class="op">=</span><span class="st">'coolwarm'</span>, cbar<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Correlation Heatmap'</span>)</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-31-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="실습4-시각화-결과를-바탕으로-전처리-고민하기" class="level2">
<h2 class="anchored" data-anchor-id="실습4-시각화-결과를-바탕으로-전처리-고민하기">실습4 : 시각화 결과를 바탕으로, 전처리 고민하기</h2>
<ul>
<li>지금까지의 시각화 결과를 바탕으로 변수별로 어떤 전처리가 필요할지, 전처리 계획을 세워봅시다.
<ul>
<li>많은 컬럼이 정규화되어있음</li>
<li>왜도가 높았던 변수가 있었지만, 시각화해보니 값이 치우치지는 않았음</li>
<li>이상치 데이터가 많은 편으로, 단순히 제거하는 것은 옳지 않음</li>
<li>순위가 있는 Education_type은 인코딩할 때 주의(순위있는 변수)</li>
<li>unique값이 많지 않은 경우는 원핫인코딩도 고려</li>
</ul></li>
</ul>
</section>
<section id="전처리" class="level2">
<h2 class="anchored" data-anchor-id="전처리">전처리</h2>
<section id="이상값-결측값-처리" class="level3">
<h3 class="anchored" data-anchor-id="이상값-결측값-처리">이상값, 결측값 처리</h3>
<ul>
<li>Drop 또는 변환을 통해 처리
<ul>
<li>현재 사용중인 데이터는 Drop보다는 변환이 적절</li>
<li>pandas fillna()를 활용</li>
</ul></li>
<li>정규화 여부로 변수 나눠보기
<ul>
<li>정규화 여부에 따라 채워넣을 값이 달라지기 때문</li>
</ul></li>
</ul>
<div id="05c496a5" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 결측치가 있는 컬럼 : 결측 데이터 비율 0% 초과</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>missing_data_cols <span class="op">=</span> missing_data[missing_data.percent <span class="op">&gt;</span> <span class="dv">0</span>].index.tolist()</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>missing_data_cols</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>['COMMONAREA_MEDI',
 'COMMONAREA_AVG',
 'COMMONAREA_MODE',
 'NONLIVINGAPARTMENTS_MODE',
 'NONLIVINGAPARTMENTS_AVG',
 'NONLIVINGAPARTMENTS_MEDI',
 'FONDKAPREMONT_MODE',
 'LIVINGAPARTMENTS_MODE',
 'LIVINGAPARTMENTS_AVG',
 'LIVINGAPARTMENTS_MEDI',
 'FLOORSMIN_AVG',
 'FLOORSMIN_MODE',
 'FLOORSMIN_MEDI',
 'YEARS_BUILD_MEDI',
 'YEARS_BUILD_MODE',
 'YEARS_BUILD_AVG',
 'OWN_CAR_AGE',
 'LANDAREA_MEDI',
 'LANDAREA_MODE',
 'LANDAREA_AVG',
 'BASEMENTAREA_MEDI',
 'BASEMENTAREA_AVG',
 'BASEMENTAREA_MODE',
 'EXT_SOURCE_1',
 'NONLIVINGAREA_MODE',
 'NONLIVINGAREA_AVG',
 'NONLIVINGAREA_MEDI',
 'ELEVATORS_MEDI',
 'ELEVATORS_AVG',
 'ELEVATORS_MODE',
 'WALLSMATERIAL_MODE',
 'APARTMENTS_MEDI',
 'APARTMENTS_AVG',
 'APARTMENTS_MODE',
 'ENTRANCES_MEDI',
 'ENTRANCES_AVG',
 'ENTRANCES_MODE',
 'LIVINGAREA_AVG',
 'LIVINGAREA_MODE',
 'LIVINGAREA_MEDI',
 'HOUSETYPE_MODE',
 'FLOORSMAX_MODE',
 'FLOORSMAX_MEDI',
 'FLOORSMAX_AVG',
 'YEARS_BEGINEXPLUATATION_MODE',
 'YEARS_BEGINEXPLUATATION_MEDI',
 'YEARS_BEGINEXPLUATATION_AVG',
 'TOTALAREA_MODE',
 'EMERGENCYSTATE_MODE',
 'OCCUPATION_TYPE',
 'EXT_SOURCE_3',
 'AMT_REQ_CREDIT_BUREAU_HOUR',
 'AMT_REQ_CREDIT_BUREAU_DAY',
 'AMT_REQ_CREDIT_BUREAU_WEEK',
 'AMT_REQ_CREDIT_BUREAU_MON',
 'AMT_REQ_CREDIT_BUREAU_QRT',
 'AMT_REQ_CREDIT_BUREAU_YEAR',
 'NAME_TYPE_SUITE',
 'OBS_30_CNT_SOCIAL_CIRCLE',
 'DEF_30_CNT_SOCIAL_CIRCLE',
 'OBS_60_CNT_SOCIAL_CIRCLE',
 'DEF_60_CNT_SOCIAL_CIRCLE',
 'EXT_SOURCE_2',
 'AMT_GOODS_PRICE',
 'AMT_ANNUITY',
 'CNT_FAM_MEMBERS',
 'DAYS_LAST_PHONE_CHANGE']</code></pre>
</div>
</div>
<div id="b281671a" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 최소 0 /최대 1인 값을 찾는 mask (정규화 되어있는)</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>min_max_mask <span class="op">=</span> (numeric_data.<span class="bu">min</span>() <span class="op">==</span> <span class="dv">0</span>) <span class="op">&amp;</span> (numeric_data.<span class="bu">max</span>() <span class="op">==</span> <span class="dv">1</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>df_min_max_0_1 <span class="op">=</span> numeric_data.loc[:, min_max_mask]</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>df_min_max_0_1.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TARGET</th>
<th data-quarto-table-cell-role="th">FLAG_MOBIL</th>
<th data-quarto-table-cell-role="th">FLAG_EMP_PHONE</th>
<th data-quarto-table-cell-role="th">FLAG_WORK_PHONE</th>
<th data-quarto-table-cell-role="th">FLAG_CONT_MOBILE</th>
<th data-quarto-table-cell-role="th">FLAG_PHONE</th>
<th data-quarto-table-cell-role="th">FLAG_EMAIL</th>
<th data-quarto-table-cell-role="th">REG_REGION_NOT_LIVE_REGION</th>
<th data-quarto-table-cell-role="th">REG_REGION_NOT_WORK_REGION</th>
<th data-quarto-table-cell-role="th">LIVE_REGION_NOT_WORK_REGION</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_12</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_13</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_14</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_15</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_16</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_17</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_18</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_19</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_20</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_21</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>5 rows × 76 columns</p>
</div>
</div>
</div>
<div id="866a43b6" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>df_min_max_0_1.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>Index(['TARGET', 'FLAG_MOBIL', 'FLAG_EMP_PHONE', 'FLAG_WORK_PHONE',
       'FLAG_CONT_MOBILE', 'FLAG_PHONE', 'FLAG_EMAIL',
       'REG_REGION_NOT_LIVE_REGION', 'REG_REGION_NOT_WORK_REGION',
       'LIVE_REGION_NOT_WORK_REGION', 'REG_CITY_NOT_LIVE_CITY',
       'REG_CITY_NOT_WORK_CITY', 'LIVE_CITY_NOT_WORK_CITY', 'APARTMENTS_AVG',
       'BASEMENTAREA_AVG', 'YEARS_BEGINEXPLUATATION_AVG', 'YEARS_BUILD_AVG',
       'COMMONAREA_AVG', 'ELEVATORS_AVG', 'ENTRANCES_AVG', 'FLOORSMAX_AVG',
       'FLOORSMIN_AVG', 'LANDAREA_AVG', 'LIVINGAPARTMENTS_AVG',
       'LIVINGAREA_AVG', 'NONLIVINGAPARTMENTS_AVG', 'NONLIVINGAREA_AVG',
       'APARTMENTS_MODE', 'BASEMENTAREA_MODE', 'YEARS_BEGINEXPLUATATION_MODE',
       'YEARS_BUILD_MODE', 'COMMONAREA_MODE', 'ELEVATORS_MODE',
       'ENTRANCES_MODE', 'FLOORSMAX_MODE', 'FLOORSMIN_MODE', 'LANDAREA_MODE',
       'LIVINGAPARTMENTS_MODE', 'LIVINGAREA_MODE', 'NONLIVINGAPARTMENTS_MODE',
       'NONLIVINGAREA_MODE', 'APARTMENTS_MEDI', 'BASEMENTAREA_MEDI',
       'YEARS_BEGINEXPLUATATION_MEDI', 'YEARS_BUILD_MEDI', 'COMMONAREA_MEDI',
       'ELEVATORS_MEDI', 'ENTRANCES_MEDI', 'FLOORSMAX_MEDI', 'FLOORSMIN_MEDI',
       'LANDAREA_MEDI', 'LIVINGAPARTMENTS_MEDI', 'LIVINGAREA_MEDI',
       'NONLIVINGAPARTMENTS_MEDI', 'NONLIVINGAREA_MEDI', 'TOTALAREA_MODE',
       'FLAG_DOCUMENT_2', 'FLAG_DOCUMENT_3', 'FLAG_DOCUMENT_4',
       'FLAG_DOCUMENT_5', 'FLAG_DOCUMENT_6', 'FLAG_DOCUMENT_7',
       'FLAG_DOCUMENT_8', 'FLAG_DOCUMENT_9', 'FLAG_DOCUMENT_10',
       'FLAG_DOCUMENT_11', 'FLAG_DOCUMENT_12', 'FLAG_DOCUMENT_13',
       'FLAG_DOCUMENT_14', 'FLAG_DOCUMENT_15', 'FLAG_DOCUMENT_16',
       'FLAG_DOCUMENT_17', 'FLAG_DOCUMENT_18', 'FLAG_DOCUMENT_19',
       'FLAG_DOCUMENT_20', 'FLAG_DOCUMENT_21'],
      dtype='object')</code></pre>
</div>
</div>
<div id="66ab66b8" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 앞서 만든 mask의 값과 다른(~) dataframe 구하기 (정규화되어있지 않은)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>df_other <span class="op">=</span> numeric_data.loc[:, <span class="op">~</span>min_max_mask]</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>df_other.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">SK_ID_CURR</th>
<th data-quarto-table-cell-role="th">CNT_CHILDREN</th>
<th data-quarto-table-cell-role="th">AMT_INCOME_TOTAL</th>
<th data-quarto-table-cell-role="th">AMT_CREDIT</th>
<th data-quarto-table-cell-role="th">AMT_ANNUITY</th>
<th data-quarto-table-cell-role="th">AMT_GOODS_PRICE</th>
<th data-quarto-table-cell-role="th">REGION_POPULATION_RELATIVE</th>
<th data-quarto-table-cell-role="th">DAYS_BIRTH</th>
<th data-quarto-table-cell-role="th">DAYS_EMPLOYED</th>
<th data-quarto-table-cell-role="th">DAYS_REGISTRATION</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">DEF_30_CNT_SOCIAL_CIRCLE</th>
<th data-quarto-table-cell-role="th">OBS_60_CNT_SOCIAL_CIRCLE</th>
<th data-quarto-table-cell-role="th">DEF_60_CNT_SOCIAL_CIRCLE</th>
<th data-quarto-table-cell-role="th">DAYS_LAST_PHONE_CHANGE</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_HOUR</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_DAY</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_WEEK</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_MON</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_QRT</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_YEAR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>100002</td>
<td>0</td>
<td>202500.0</td>
<td>406597.5</td>
<td>24700.5</td>
<td>351000.0</td>
<td>0.018801</td>
<td>-9461</td>
<td>-637</td>
<td>-3648.0</td>
<td>...</td>
<td>2.0</td>
<td>2.0</td>
<td>2.0</td>
<td>-1134.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>100003</td>
<td>0</td>
<td>270000.0</td>
<td>1293502.5</td>
<td>35698.5</td>
<td>1129500.0</td>
<td>0.003541</td>
<td>-16765</td>
<td>-1188</td>
<td>-1186.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>-828.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>100004</td>
<td>0</td>
<td>67500.0</td>
<td>135000.0</td>
<td>6750.0</td>
<td>135000.0</td>
<td>0.010032</td>
<td>-19046</td>
<td>-225</td>
<td>-4260.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>-815.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>100006</td>
<td>0</td>
<td>135000.0</td>
<td>312682.5</td>
<td>29686.5</td>
<td>297000.0</td>
<td>0.008019</td>
<td>-19005</td>
<td>-3039</td>
<td>-9833.0</td>
<td>...</td>
<td>0.0</td>
<td>2.0</td>
<td>0.0</td>
<td>-617.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>100007</td>
<td>0</td>
<td>121500.0</td>
<td>513000.0</td>
<td>21865.5</td>
<td>513000.0</td>
<td>0.028663</td>
<td>-19932</td>
<td>-3038</td>
<td>-4311.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>-1106.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

<p>5 rows × 30 columns</p>
</div>
</div>
</div>
<div id="2f1dd0b9" class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>df_other.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['SK_ID_CURR', 'CNT_CHILDREN', 'AMT_INCOME_TOTAL', 'AMT_CREDIT',
       'AMT_ANNUITY', 'AMT_GOODS_PRICE', 'REGION_POPULATION_RELATIVE',
       'DAYS_BIRTH', 'DAYS_EMPLOYED', 'DAYS_REGISTRATION', 'DAYS_ID_PUBLISH',
       'OWN_CAR_AGE', 'CNT_FAM_MEMBERS', 'REGION_RATING_CLIENT',
       'REGION_RATING_CLIENT_W_CITY', 'HOUR_APPR_PROCESS_START',
       'EXT_SOURCE_1', 'EXT_SOURCE_2', 'EXT_SOURCE_3',
       'OBS_30_CNT_SOCIAL_CIRCLE', 'DEF_30_CNT_SOCIAL_CIRCLE',
       'OBS_60_CNT_SOCIAL_CIRCLE', 'DEF_60_CNT_SOCIAL_CIRCLE',
       'DAYS_LAST_PHONE_CHANGE', 'AMT_REQ_CREDIT_BUREAU_HOUR',
       'AMT_REQ_CREDIT_BUREAU_DAY', 'AMT_REQ_CREDIT_BUREAU_WEEK',
       'AMT_REQ_CREDIT_BUREAU_MON', 'AMT_REQ_CREDIT_BUREAU_QRT',
       'AMT_REQ_CREDIT_BUREAU_YEAR'],
      dtype='object')</code></pre>
</div>
</div>
<ul>
<li>정규화 된 vs 되지 않은 변수에 대한 처리 방안
<ul>
<li>정규화된 변수(df_min_max_0_1.columns)는 도시, 아파트 등 거주지에 관련된 변수
<ul>
<li>평균이나 0으로 대체할 수 있음</li>
<li>아예 다른 -1 등으로 대체하여, 모델에게 일반적인 값이 아니라고 알려줄 수 있음</li>
</ul></li>
<li>정규화되지 않은 변수(df_other.columns)는 공통적이지 않아 위처럼 일괄적용은 불가
<ul>
<li>무난하게 평균으로 대체(Imputation)</li>
</ul></li>
</ul></li>
</ul>
<div id="b8953c97" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 정규화된 데이터(df_min_max_0_1) : -1로 채우기</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>df_min_max_0_1_filled <span class="op">=</span> df_min_max_0_1.fillna(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 정규화되지 않은 데이터( : )df_other) : 평균으로 채우기</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>df_other_filled <span class="op">=</span> df_other.fillna(df_other.mean())</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 두 데이터 다시 합치기</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>numeric_data_filled <span class="op">=</span> pd.concat([df_min_max_0_1_filled, df_other_filled], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>numeric_data_filled <span class="op">=</span> numeric_data_filled[numeric_data.columns]</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>numeric_data_filled.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">SK_ID_CURR</th>
<th data-quarto-table-cell-role="th">TARGET</th>
<th data-quarto-table-cell-role="th">CNT_CHILDREN</th>
<th data-quarto-table-cell-role="th">AMT_INCOME_TOTAL</th>
<th data-quarto-table-cell-role="th">AMT_CREDIT</th>
<th data-quarto-table-cell-role="th">AMT_ANNUITY</th>
<th data-quarto-table-cell-role="th">AMT_GOODS_PRICE</th>
<th data-quarto-table-cell-role="th">REGION_POPULATION_RELATIVE</th>
<th data-quarto-table-cell-role="th">DAYS_BIRTH</th>
<th data-quarto-table-cell-role="th">DAYS_EMPLOYED</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_18</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_19</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_20</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_21</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_HOUR</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_DAY</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_WEEK</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_MON</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_QRT</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_YEAR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>100002</td>
<td>1</td>
<td>0</td>
<td>202500.0</td>
<td>406597.5</td>
<td>24700.5</td>
<td>351000.0</td>
<td>0.018801</td>
<td>-9461</td>
<td>-637</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.000000</td>
<td>0.000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>100003</td>
<td>0</td>
<td>0</td>
<td>270000.0</td>
<td>1293502.5</td>
<td>35698.5</td>
<td>1129500.0</td>
<td>0.003541</td>
<td>-16765</td>
<td>-1188</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.000000</td>
<td>0.000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>100004</td>
<td>0</td>
<td>0</td>
<td>67500.0</td>
<td>135000.0</td>
<td>6750.0</td>
<td>135000.0</td>
<td>0.010032</td>
<td>-19046</td>
<td>-225</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.000000</td>
<td>0.000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>100006</td>
<td>0</td>
<td>0</td>
<td>135000.0</td>
<td>312682.5</td>
<td>29686.5</td>
<td>297000.0</td>
<td>0.008019</td>
<td>-19005</td>
<td>-3039</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.006402</td>
<td>0.007</td>
<td>0.034362</td>
<td>0.267395</td>
<td>0.265474</td>
<td>1.899974</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>100007</td>
<td>0</td>
<td>0</td>
<td>121500.0</td>
<td>513000.0</td>
<td>21865.5</td>
<td>513000.0</td>
<td>0.028663</td>
<td>-19932</td>
<td>-3038</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.000000</td>
<td>0.000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
</tbody>
</table>

<p>5 rows × 106 columns</p>
</div>
</div>
</div>
<div id="9bca8b89" class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 결측치 존재여부 확인하기 : 없음</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>numeric_data_filled.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>SK_ID_CURR                      0
TARGET                          0
CNT_CHILDREN                    0
AMT_INCOME_TOTAL                0
AMT_CREDIT                      0
AMT_ANNUITY                     0
AMT_GOODS_PRICE                 0
REGION_POPULATION_RELATIVE      0
DAYS_BIRTH                      0
DAYS_EMPLOYED                   0
DAYS_REGISTRATION               0
DAYS_ID_PUBLISH                 0
OWN_CAR_AGE                     0
FLAG_MOBIL                      0
FLAG_EMP_PHONE                  0
FLAG_WORK_PHONE                 0
FLAG_CONT_MOBILE                0
FLAG_PHONE                      0
FLAG_EMAIL                      0
CNT_FAM_MEMBERS                 0
REGION_RATING_CLIENT            0
REGION_RATING_CLIENT_W_CITY     0
HOUR_APPR_PROCESS_START         0
REG_REGION_NOT_LIVE_REGION      0
REG_REGION_NOT_WORK_REGION      0
LIVE_REGION_NOT_WORK_REGION     0
REG_CITY_NOT_LIVE_CITY          0
REG_CITY_NOT_WORK_CITY          0
LIVE_CITY_NOT_WORK_CITY         0
EXT_SOURCE_1                    0
EXT_SOURCE_2                    0
EXT_SOURCE_3                    0
APARTMENTS_AVG                  0
BASEMENTAREA_AVG                0
YEARS_BEGINEXPLUATATION_AVG     0
YEARS_BUILD_AVG                 0
COMMONAREA_AVG                  0
ELEVATORS_AVG                   0
ENTRANCES_AVG                   0
FLOORSMAX_AVG                   0
FLOORSMIN_AVG                   0
LANDAREA_AVG                    0
LIVINGAPARTMENTS_AVG            0
LIVINGAREA_AVG                  0
NONLIVINGAPARTMENTS_AVG         0
NONLIVINGAREA_AVG               0
APARTMENTS_MODE                 0
BASEMENTAREA_MODE               0
YEARS_BEGINEXPLUATATION_MODE    0
YEARS_BUILD_MODE                0
COMMONAREA_MODE                 0
ELEVATORS_MODE                  0
ENTRANCES_MODE                  0
FLOORSMAX_MODE                  0
FLOORSMIN_MODE                  0
LANDAREA_MODE                   0
LIVINGAPARTMENTS_MODE           0
LIVINGAREA_MODE                 0
NONLIVINGAPARTMENTS_MODE        0
NONLIVINGAREA_MODE              0
APARTMENTS_MEDI                 0
BASEMENTAREA_MEDI               0
YEARS_BEGINEXPLUATATION_MEDI    0
YEARS_BUILD_MEDI                0
COMMONAREA_MEDI                 0
ELEVATORS_MEDI                  0
ENTRANCES_MEDI                  0
FLOORSMAX_MEDI                  0
FLOORSMIN_MEDI                  0
LANDAREA_MEDI                   0
LIVINGAPARTMENTS_MEDI           0
LIVINGAREA_MEDI                 0
NONLIVINGAPARTMENTS_MEDI        0
NONLIVINGAREA_MEDI              0
TOTALAREA_MODE                  0
OBS_30_CNT_SOCIAL_CIRCLE        0
DEF_30_CNT_SOCIAL_CIRCLE        0
OBS_60_CNT_SOCIAL_CIRCLE        0
DEF_60_CNT_SOCIAL_CIRCLE        0
DAYS_LAST_PHONE_CHANGE          0
FLAG_DOCUMENT_2                 0
FLAG_DOCUMENT_3                 0
FLAG_DOCUMENT_4                 0
FLAG_DOCUMENT_5                 0
FLAG_DOCUMENT_6                 0
FLAG_DOCUMENT_7                 0
FLAG_DOCUMENT_8                 0
FLAG_DOCUMENT_9                 0
FLAG_DOCUMENT_10                0
FLAG_DOCUMENT_11                0
FLAG_DOCUMENT_12                0
FLAG_DOCUMENT_13                0
FLAG_DOCUMENT_14                0
FLAG_DOCUMENT_15                0
FLAG_DOCUMENT_16                0
FLAG_DOCUMENT_17                0
FLAG_DOCUMENT_18                0
FLAG_DOCUMENT_19                0
FLAG_DOCUMENT_20                0
FLAG_DOCUMENT_21                0
AMT_REQ_CREDIT_BUREAU_HOUR      0
AMT_REQ_CREDIT_BUREAU_DAY       0
AMT_REQ_CREDIT_BUREAU_WEEK      0
AMT_REQ_CREDIT_BUREAU_MON       0
AMT_REQ_CREDIT_BUREAU_QRT       0
AMT_REQ_CREDIT_BUREAU_YEAR      0
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="표준화-정규화" class="level3">
<h3 class="anchored" data-anchor-id="표준화-정규화">표준화 / 정규화</h3>
<ul>
<li>현재 이용중인 데이터는 정규화가 되어있어, 더미 데이터로 정규화 실습</li>
</ul>
<div id="be383d25" class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 필요한 라이브러리 임포트</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_classification</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, MinMaxScaler</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 데이터 생성</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co"># make_classification을 사용해 극단적인 스케일 차이를 가진 데이터를 생성</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>X_extreme, y_extreme <span class="op">=</span> make_classification(</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    n_samples<span class="op">=</span><span class="dv">10000</span>,            <span class="co"># 데이터 샘플 수</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    n_features<span class="op">=</span><span class="dv">40</span>,             <span class="co"># 전체 피처 수</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    n_informative<span class="op">=</span><span class="dv">10</span>,           <span class="co"># 유용한 피처 수</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    scale<span class="op">=</span>[<span class="dv">10</span>, <span class="dv">10000</span>, <span class="fl">0.1</span>, <span class="fl">0.001</span>] <span class="op">*</span> <span class="dv">10</span>,  <span class="co"># 피처별 스케일 조정</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span>            <span class="co"># 재현 가능성을 위한 시드값</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0635d64a" class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(X_extreme).describe().transpose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10000.0</td>
<td>-0.000843</td>
<td>0.099991</td>
<td>-0.400455</td>
<td>-0.068812</td>
<td>-9.649203e-04</td>
<td>0.065022</td>
<td>0.345748</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10000.0</td>
<td>-0.049159</td>
<td>0.203922</td>
<td>-1.028082</td>
<td>-0.186545</td>
<td>-4.998679e-02</td>
<td>0.087477</td>
<td>0.696282</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>10000.0</td>
<td>0.098310</td>
<td>9.967478</td>
<td>-37.084345</td>
<td>-6.431134</td>
<td>2.068342e-01</td>
<td>6.805382</td>
<td>36.569668</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>10000.0</td>
<td>0.000092</td>
<td>0.100792</td>
<td>-0.376615</td>
<td>-0.068290</td>
<td>1.600637e-03</td>
<td>0.066608</td>
<td>0.370791</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>10000.0</td>
<td>33.711066</td>
<td>9968.009346</td>
<td>-37924.222059</td>
<td>-6660.572565</td>
<td>2.665940e+01</td>
<td>6718.807581</td>
<td>38249.915049</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>10000.0</td>
<td>-0.014777</td>
<td>10.035188</td>
<td>-44.042140</td>
<td>-6.791118</td>
<td>-1.207864e-03</td>
<td>6.879935</td>
<td>34.238262</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>10000.0</td>
<td>0.004445</td>
<td>0.348834</td>
<td>-1.327898</td>
<td>-0.224403</td>
<td>4.139092e-03</td>
<td>0.240916</td>
<td>1.279965</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>10000.0</td>
<td>-29.276123</td>
<td>9901.953926</td>
<td>-34920.171700</td>
<td>-6780.256223</td>
<td>5.289047e+01</td>
<td>6660.789736</td>
<td>35896.144788</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>10000.0</td>
<td>5012.027982</td>
<td>20322.028651</td>
<td>-72656.674262</td>
<td>-8177.712578</td>
<td>5.592046e+03</td>
<td>19130.519205</td>
<td>87719.082190</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>10000.0</td>
<td>5.235305</td>
<td>21.577716</td>
<td>-94.872061</td>
<td>-8.381620</td>
<td>6.028815e+00</td>
<td>19.905182</td>
<td>86.318571</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>10000.0</td>
<td>-16.717119</td>
<td>22438.781080</td>
<td>-94469.882979</td>
<td>-14865.590516</td>
<td>7.735623e+02</td>
<td>15595.529638</td>
<td>82303.951337</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>10000.0</td>
<td>-0.000006</td>
<td>0.001006</td>
<td>-0.004374</td>
<td>-0.000688</td>
<td>-2.374679e-07</td>
<td>0.000671</td>
<td>0.003626</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>10000.0</td>
<td>105.978945</td>
<td>10155.422965</td>
<td>-37826.155102</td>
<td>-6811.010474</td>
<td>6.823802e+01</td>
<td>6998.192954</td>
<td>45621.147236</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>10000.0</td>
<td>-0.001012</td>
<td>0.210320</td>
<td>-0.858273</td>
<td>-0.143428</td>
<td>5.860082e-04</td>
<td>0.140071</td>
<td>0.889246</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>10000.0</td>
<td>-4858.457290</td>
<td>21738.300654</td>
<td>-94748.760660</td>
<td>-19030.662537</td>
<td>-5.041786e+03</td>
<td>9388.088922</td>
<td>78861.853678</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>10000.0</td>
<td>-0.000007</td>
<td>0.000999</td>
<td>-0.004067</td>
<td>-0.000675</td>
<td>-5.164186e-06</td>
<td>0.000670</td>
<td>0.003677</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>10000.0</td>
<td>-5.141587</td>
<td>17.738662</td>
<td>-71.054112</td>
<td>-17.153315</td>
<td>-5.349305e+00</td>
<td>7.050539</td>
<td>55.128501</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>10000.0</td>
<td>-0.000369</td>
<td>0.100389</td>
<td>-0.348579</td>
<td>-0.067523</td>
<td>-3.805544e-04</td>
<td>0.067480</td>
<td>0.367819</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>10000.0</td>
<td>-0.000006</td>
<td>0.000996</td>
<td>-0.003884</td>
<td>-0.000686</td>
<td>-1.293092e-05</td>
<td>0.000666</td>
<td>0.003644</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>10000.0</td>
<td>-0.000172</td>
<td>0.099557</td>
<td>-0.353209</td>
<td>-0.067392</td>
<td>8.681804e-04</td>
<td>0.067532</td>
<td>0.340875</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>10000.0</td>
<td>-0.000009</td>
<td>0.098640</td>
<td>-0.400360</td>
<td>-0.066536</td>
<td>5.128733e-04</td>
<td>0.066323</td>
<td>0.345383</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>10000.0</td>
<td>-0.000014</td>
<td>0.000989</td>
<td>-0.003470</td>
<td>-0.000682</td>
<td>-2.495327e-05</td>
<td>0.000648</td>
<td>0.003575</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>10000.0</td>
<td>58.343623</td>
<td>9989.324997</td>
<td>-37011.053323</td>
<td>-6603.388513</td>
<td>-2.738199e+01</td>
<td>6687.434189</td>
<td>37550.968936</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>10000.0</td>
<td>-0.191571</td>
<td>22.000080</td>
<td>-76.276131</td>
<td>-15.251958</td>
<td>-1.285423e+00</td>
<td>14.269217</td>
<td>93.037809</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>10000.0</td>
<td>-94.852822</td>
<td>9900.227203</td>
<td>-39993.322490</td>
<td>-6837.457775</td>
<td>-1.868981e+01</td>
<td>6573.974126</td>
<td>38262.551726</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>10000.0</td>
<td>0.000006</td>
<td>0.001006</td>
<td>-0.003842</td>
<td>-0.000672</td>
<td>8.375875e-06</td>
<td>0.000691</td>
<td>0.004219</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>10000.0</td>
<td>0.000290</td>
<td>0.003541</td>
<td>-0.012334</td>
<td>-0.002022</td>
<td>2.878352e-04</td>
<td>0.002610</td>
<td>0.015225</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>10000.0</td>
<td>0.000841</td>
<td>0.099419</td>
<td>-0.399701</td>
<td>-0.065312</td>
<td>1.257511e-04</td>
<td>0.067327</td>
<td>0.354844</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>10000.0</td>
<td>-0.088997</td>
<td>9.912015</td>
<td>-34.888492</td>
<td>-6.821070</td>
<td>-1.745981e-01</td>
<td>6.518458</td>
<td>37.321065</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>10000.0</td>
<td>0.000400</td>
<td>0.099395</td>
<td>-0.356424</td>
<td>-0.066818</td>
<td>1.730892e-04</td>
<td>0.066774</td>
<td>0.386391</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30</td>
<td>10000.0</td>
<td>-79.666444</td>
<td>10110.197747</td>
<td>-37110.587943</td>
<td>-6797.004214</td>
<td>-2.879375e+01</td>
<td>6750.676244</td>
<td>37841.363336</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31</td>
<td>10000.0</td>
<td>0.112263</td>
<td>10.151527</td>
<td>-37.939557</td>
<td>-6.815460</td>
<td>6.569630e-02</td>
<td>7.061795</td>
<td>42.020259</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32</td>
<td>10000.0</td>
<td>0.059398</td>
<td>10.005156</td>
<td>-37.291744</td>
<td>-6.652975</td>
<td>1.770254e-01</td>
<td>6.828899</td>
<td>39.181850</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33</td>
<td>10000.0</td>
<td>-0.000011</td>
<td>0.001012</td>
<td>-0.003814</td>
<td>-0.000696</td>
<td>-1.729425e-05</td>
<td>0.000668</td>
<td>0.003775</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34</td>
<td>10000.0</td>
<td>0.112279</td>
<td>9.979008</td>
<td>-35.699687</td>
<td>-6.730720</td>
<td>1.131022e-01</td>
<td>6.848352</td>
<td>39.768682</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>10000.0</td>
<td>0.000514</td>
<td>0.001720</td>
<td>-0.005501</td>
<td>-0.000699</td>
<td>4.901425e-04</td>
<td>0.001649</td>
<td>0.008263</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">36</td>
<td>10000.0</td>
<td>-0.000020</td>
<td>0.002119</td>
<td>-0.007758</td>
<td>-0.001392</td>
<td>1.818282e-04</td>
<td>0.001455</td>
<td>0.006503</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">37</td>
<td>10000.0</td>
<td>201.890197</td>
<td>9859.993885</td>
<td>-36573.006696</td>
<td>-6408.351214</td>
<td>1.730065e+02</td>
<td>6872.631552</td>
<td>34511.089264</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>10000.0</td>
<td>-0.055936</td>
<td>10.030580</td>
<td>-37.936384</td>
<td>-6.934862</td>
<td>-5.052432e-02</td>
<td>6.753313</td>
<td>38.782169</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39</td>
<td>10000.0</td>
<td>-0.000004</td>
<td>0.001007</td>
<td>-0.004414</td>
<td>-0.000690</td>
<td>-1.970009e-05</td>
<td>0.000669</td>
<td>0.003569</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>변수별로 scale차이가 큰 데이터가 만들어졌고, 로지스틱 회귀 모델에 넣어볼 예정</li>
<li>표준화와 정규화 부분에 집중해서 보기(나머지는 추후 배움)</li>
<li><strong>표준화</strong>는 <code>sklearn.preprocessing</code>의 <code>StandardScaler</code>로, <strong>정규화</strong>는 <code>MinMaxScaler</code>로 수행</li>
</ul>
<div id="b8fab45b" class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 데이터 분리</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 학습 데이터와 테스트 데이터로 분리</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>X_train_extreme, X_test_extreme, y_train_extreme, y_test_extreme <span class="op">=</span> train_test_split(</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    X_extreme, y_extreme, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 로지스틱 회귀 모델 초기화</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>model_lr_extreme <span class="op">=</span> LogisticRegression(random_state<span class="op">=</span><span class="dv">42</span>, max_iter<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. 원본 데이터로 예측 (Raw Data)</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 스케일링 없이 원본 데이터를 사용해 모델 학습</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>model_lr_extreme.fit(X_train_extreme, y_train_extreme)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>y_pred_raw_extreme_lr <span class="op">=</span> model_lr_extreme.predict(X_test_extreme)</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>accuracy_raw_extreme_lr <span class="op">=</span> accuracy_score(y_test_extreme, y_pred_raw_extreme_lr)</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. 표준화된 데이터로 예측 (Standardized Data)</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 표준화를 적용한 데이터를 사용해 모델 학습</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>scaler_standard <span class="op">=</span> StandardScaler()</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>X_train_extreme_standardized <span class="op">=</span> scaler_standard.fit_transform(X_train_extreme) <span class="co"># fit을 통해 0~4의 값이 min/max 0/4임을 구하고, transform으로 0~1로 변경</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>X_test_extreme_standardized <span class="op">=</span> scaler_standard.transform(X_test_extreme)</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>model_lr_extreme.fit(X_train_extreme_standardized, y_train_extreme)</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>y_pred_standardized_extreme_lr <span class="op">=</span> model_lr_extreme.predict(X_test_extreme_standardized)</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>accuracy_standardized_extreme_lr <span class="op">=</span> accuracy_score(y_test_extreme, y_pred_standardized_extreme_lr)</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. 정규화된 데이터로 예측 (Normalized Data)</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 정규화를 적용한 데이터를 사용해 모델 학습</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>scaler_minmax <span class="op">=</span> MinMaxScaler()</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>X_train_extreme_normalized <span class="op">=</span> scaler_minmax.fit_transform(X_train_extreme)</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>X_test_extreme_normalized <span class="op">=</span> scaler_minmax.transform(X_test_extreme)</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>model_lr_extreme.fit(X_train_extreme_normalized, y_train_extreme)</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>y_pred_normalized_extreme_lr <span class="op">=</span> model_lr_extreme.predict(X_test_extreme_normalized)</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>accuracy_normalized_extreme_lr <span class="op">=</span> accuracy_score(y_test_extreme, y_pred_normalized_extreme_lr)</span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. 결과 비교</span></span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과를 데이터프레임으로 정리</span></span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>results_extreme_lr <span class="op">=</span> {</span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Method"</span>: [<span class="st">"Raw Data"</span>, <span class="st">"Standardized Data"</span>, <span class="st">"Normalized Data"</span>],</span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Accuracy"</span>: [accuracy_raw_extreme_lr, accuracy_standardized_extreme_lr, accuracy_normalized_extreme_lr],</span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a>results_extreme_lr_df <span class="op">=</span> pd.DataFrame(results_extreme_lr)</span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a>results_extreme_lr_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>c:\Users\kibok\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\linear_model\_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Method</th>
<th data-quarto-table-cell-role="th">Accuracy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Raw Data</td>
<td>0.692333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Standardized Data</td>
<td>0.803000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Normalized Data</td>
<td>0.803667</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="변환-1" class="level3">
<h3 class="anchored" data-anchor-id="변환-1">변환</h3>
<ul>
<li>앞서 확인한 사실 : 일부 데이터의 치우침(왜도), 이상치, DAYS_EMPLOYED를 제외하면 전부 양수</li>
<li>위와 같은 경우 변환을 할 수 있으며, 로그변환과 제곱근 변환 중 일반적으로 쓰이는 로그변환을 사용</li>
<li><code>np.log1p</code>를 사용 : log(x + 1)를 정밀하게 연산하는 함수로, 값이 0에 가까울수록 무한대로 발산하는 것을 막기위해 log1p를 사용
<ul>
<li>손실없이 계산하기 위해 log1p를 사용</li>
</ul></li>
</ul>
<div id="dfeb29e2" class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>outliers_over_10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">total</th>
<th data-quarto-table-cell-role="th">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">REGION_RATING_CLIENT</td>
<td>80527</td>
<td>26.186706</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">REGION_RATING_CLIENT_W_CITY</td>
<td>78027</td>
<td>25.373726</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">DAYS_EMPLOYED</td>
<td>72217</td>
<td>23.484363</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">REG_CITY_NOT_WORK_CITY</td>
<td>70867</td>
<td>23.045354</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">FLAG_WORK_PHONE</td>
<td>61308</td>
<td>19.936848</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">FLAG_EMP_PHONE</td>
<td>55386</td>
<td>18.011063</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">LIVE_CITY_NOT_WORK_CITY</td>
<td>55215</td>
<td>17.955455</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_QRT</td>
<td>50575</td>
<td>16.446566</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_MON</td>
<td>43759</td>
<td>14.230060</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">DEF_30_CNT_SOCIAL_CIRCLE</td>
<td>35166</td>
<td>11.435688</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="c5e56e1d" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>log_transform_columns <span class="op">=</span> outliers_over_10.index.tolist()</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>log_transform_columns.remove(<span class="st">'DAYS_EMPLOYED'</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>log_transform_columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>['REGION_RATING_CLIENT',
 'REGION_RATING_CLIENT_W_CITY',
 'REG_CITY_NOT_WORK_CITY',
 'FLAG_WORK_PHONE',
 'FLAG_EMP_PHONE',
 'LIVE_CITY_NOT_WORK_CITY',
 'AMT_REQ_CREDIT_BUREAU_QRT',
 'AMT_REQ_CREDIT_BUREAU_MON',
 'DEF_30_CNT_SOCIAL_CIRCLE']</code></pre>
</div>
</div>
<div id="8967ba20" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>numeric_data_filled[log_transform_columns]  <span class="op">=</span> numeric_data_filled[log_transform_columns].<span class="bu">apply</span>(<span class="kw">lambda</span> x : np.log1p(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ecb15940" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>numeric_data_filled.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">SK_ID_CURR</th>
<th data-quarto-table-cell-role="th">TARGET</th>
<th data-quarto-table-cell-role="th">CNT_CHILDREN</th>
<th data-quarto-table-cell-role="th">AMT_INCOME_TOTAL</th>
<th data-quarto-table-cell-role="th">AMT_CREDIT</th>
<th data-quarto-table-cell-role="th">AMT_ANNUITY</th>
<th data-quarto-table-cell-role="th">AMT_GOODS_PRICE</th>
<th data-quarto-table-cell-role="th">REGION_POPULATION_RELATIVE</th>
<th data-quarto-table-cell-role="th">DAYS_BIRTH</th>
<th data-quarto-table-cell-role="th">DAYS_EMPLOYED</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_18</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_19</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_20</th>
<th data-quarto-table-cell-role="th">FLAG_DOCUMENT_21</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_HOUR</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_DAY</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_WEEK</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_MON</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_QRT</th>
<th data-quarto-table-cell-role="th">AMT_REQ_CREDIT_BUREAU_YEAR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>100002</td>
<td>1</td>
<td>0</td>
<td>202500.0</td>
<td>406597.5</td>
<td>24700.5</td>
<td>351000.0</td>
<td>0.018801</td>
<td>-9461</td>
<td>-637</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.000000</td>
<td>0.000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>100003</td>
<td>0</td>
<td>0</td>
<td>270000.0</td>
<td>1293502.5</td>
<td>35698.5</td>
<td>1129500.0</td>
<td>0.003541</td>
<td>-16765</td>
<td>-1188</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.000000</td>
<td>0.000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>100004</td>
<td>0</td>
<td>0</td>
<td>67500.0</td>
<td>135000.0</td>
<td>6750.0</td>
<td>135000.0</td>
<td>0.010032</td>
<td>-19046</td>
<td>-225</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.000000</td>
<td>0.000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>100006</td>
<td>0</td>
<td>0</td>
<td>135000.0</td>
<td>312682.5</td>
<td>29686.5</td>
<td>297000.0</td>
<td>0.008019</td>
<td>-19005</td>
<td>-3039</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.006402</td>
<td>0.007</td>
<td>0.034362</td>
<td>0.236964</td>
<td>0.235447</td>
<td>1.899974</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>100007</td>
<td>0</td>
<td>0</td>
<td>121500.0</td>
<td>513000.0</td>
<td>21865.5</td>
<td>513000.0</td>
<td>0.028663</td>
<td>-19932</td>
<td>-3038</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.000000</td>
<td>0.000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
</tbody>
</table>

<p>5 rows × 106 columns</p>
</div>
</div>
</div>
</section>
<section id="실습-5" class="level3">
<h3 class="anchored" data-anchor-id="실습-5">실습 5</h3>
<ul>
<li>DAYS_EMPOLYED 같이 음수의 값을 갖는 경우, 최소값 조정이라는 걸 통해 변환해줄 수 있습니다.</li>
<li>쉽게 말해 최소값의 절대값보다 큰 수 C를 모든 데이터에 더하는 걸 말합니다.</li>
<li>구현한 뒤에 로그변환을 해봅시다.</li>
</ul>
<div id="375c4e0a" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 최소값 조정 : numeric_data_filled['DAYS_EMPLOYED'].min() * -1</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>(numeric_data_filled[<span class="st">'DAYS_EMPLOYED'</span>] <span class="op">+</span> numeric_data_filled[<span class="st">'DAYS_EMPLOYED'</span>].<span class="bu">min</span>() <span class="op">*</span> <span class="op">-</span><span class="dv">1</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x : np.log1p(x)).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>0    9.757074
1    9.724660
2    9.780642
3    9.607370
4    9.607437
Name: DAYS_EMPLOYED, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="인코딩-1" class="level3">
<h3 class="anchored" data-anchor-id="인코딩-1">인코딩</h3>
<ul>
<li>각 카테고리의 값을 숫자로 바꾸는 <strong>Label인코딩은 순서에 대한 왜곡 발생</strong>
<ul>
<li><strong>메모리, 계산 부담이 없는 경우는 One-hot 인코딩</strong>이 이론상 더 성능이 좋음</li>
<li>범주간의 <strong>순서가 존재하는 경우는 Label 인코딩</strong>을 하는게 오히려 좋음</li>
<li>Unique한 값이 많으면 One-hot인코딩은 메모리 비효율 발생</li>
</ul></li>
<li><code>sklearn.preprocessing</code>의 <code>OneHotEncoder</code>으로 Ont-hot 인코딩</li>
</ul>
<div id="a99213b7" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One-hot 인코딩 대상 컬럼</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>one_hot_columns <span class="op">=</span> categorical_data.describe().transpose()[categorical_data.describe().transpose().unique <span class="op">&lt;=</span> <span class="dv">3</span>].index.tolist()</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>one_hot_columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>['NAME_CONTRACT_TYPE',
 'CODE_GENDER',
 'FLAG_OWN_CAR',
 'FLAG_OWN_REALTY',
 'HOUSETYPE_MODE',
 'EMERGENCYSTATE_MODE']</code></pre>
</div>
</div>
<div id="81bed530" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One-hot 인코딩(fit_transform)을 통해, 각 카테고리의 값이  컬럼으로 올라감</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>ohe <span class="op">=</span> OneHotEncoder(sparse_output<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>onehot_encoded <span class="op">=</span> ohe.fit_transform(categorical_data[one_hot_columns])</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>encoded_col_names <span class="op">=</span> ohe.get_feature_names_out(input_features<span class="op">=</span>one_hot_columns)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co"># get_feature_names_out : ont-hot 인코딩된 컬럼을 반환</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>onehot_df <span class="op">=</span> pd.DataFrame(onehot_encoded, columns<span class="op">=</span>encoded_col_names, index<span class="op">=</span>categorical_data.index)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>onehot_df.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NAME_CONTRACT_TYPE_Cash loans</th>
<th data-quarto-table-cell-role="th">NAME_CONTRACT_TYPE_Revolving loans</th>
<th data-quarto-table-cell-role="th">CODE_GENDER_F</th>
<th data-quarto-table-cell-role="th">CODE_GENDER_M</th>
<th data-quarto-table-cell-role="th">CODE_GENDER_XNA</th>
<th data-quarto-table-cell-role="th">FLAG_OWN_CAR_N</th>
<th data-quarto-table-cell-role="th">FLAG_OWN_CAR_Y</th>
<th data-quarto-table-cell-role="th">FLAG_OWN_REALTY_N</th>
<th data-quarto-table-cell-role="th">FLAG_OWN_REALTY_Y</th>
<th data-quarto-table-cell-role="th">HOUSETYPE_MODE_block of flats</th>
<th data-quarto-table-cell-role="th">HOUSETYPE_MODE_specific housing</th>
<th data-quarto-table-cell-role="th">HOUSETYPE_MODE_terraced house</th>
<th data-quarto-table-cell-role="th">HOUSETYPE_MODE_nan</th>
<th data-quarto-table-cell-role="th">EMERGENCYSTATE_MODE_No</th>
<th data-quarto-table-cell-role="th">EMERGENCYSTATE_MODE_Yes</th>
<th data-quarto-table-cell-role="th">EMERGENCYSTATE_MODE_nan</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>순위가 불명확하거나 값이 다양한 경우 : Label Encoder 사용</li>
<li><code>sklearn.preprocessing</code>의 <code>LabelEncoder</code>로 Label인코딩
<ul>
<li>컬럼별로 인코딩되며, 한번에 fit_transform불가</li>
<li>벡터연산으로 적용해보기(<code>.apply()</code>)</li>
</ul></li>
</ul>
<div id="e4bab7b5" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Label인코딩 대상 컬럼</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>le_columns <span class="op">=</span> categorical_data.describe().transpose()[categorical_data.describe().transpose().unique <span class="op">&gt;</span> <span class="dv">3</span>].index.tolist()</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>le_columns.remove(<span class="st">'NAME_EDUCATION_TYPE'</span>)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>le_columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>['NAME_TYPE_SUITE',
 'NAME_INCOME_TYPE',
 'NAME_FAMILY_STATUS',
 'NAME_HOUSING_TYPE',
 'OCCUPATION_TYPE',
 'WEEKDAY_APPR_PROCESS_START',
 'ORGANIZATION_TYPE',
 'FONDKAPREMONT_MODE',
 'WALLSMATERIAL_MODE']</code></pre>
</div>
</div>
<div id="9f8e75a3" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>le <span class="op">=</span> LabelEncoder()</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>le_df <span class="op">=</span> categorical_data[le_columns].<span class="bu">apply</span>(le.fit_transform)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>le_df.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NAME_TYPE_SUITE</th>
<th data-quarto-table-cell-role="th">NAME_INCOME_TYPE</th>
<th data-quarto-table-cell-role="th">NAME_FAMILY_STATUS</th>
<th data-quarto-table-cell-role="th">NAME_HOUSING_TYPE</th>
<th data-quarto-table-cell-role="th">OCCUPATION_TYPE</th>
<th data-quarto-table-cell-role="th">WEEKDAY_APPR_PROCESS_START</th>
<th data-quarto-table-cell-role="th">ORGANIZATION_TYPE</th>
<th data-quarto-table-cell-role="th">FONDKAPREMONT_MODE</th>
<th data-quarto-table-cell-role="th">WALLSMATERIAL_MODE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>6</td>
<td>7</td>
<td>3</td>
<td>1</td>
<td>8</td>
<td>6</td>
<td>5</td>
<td>2</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>3</td>
<td>1</td>
<td>39</td>
<td>2</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>6</td>
<td>7</td>
<td>3</td>
<td>1</td>
<td>8</td>
<td>1</td>
<td>11</td>
<td>4</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>6</td>
<td>7</td>
<td>0</td>
<td>1</td>
<td>8</td>
<td>6</td>
<td>5</td>
<td>4</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>6</td>
<td>7</td>
<td>3</td>
<td>1</td>
<td>3</td>
<td>4</td>
<td>37</td>
<td>4</td>
<td>7</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="실습6" class="level3">
<h3 class="anchored" data-anchor-id="실습6">실습6</h3>
<ul>
<li>지금도 괜찮긴 한데, 이러면 나중에 저 값이 뭔지 궁금해도 찾아볼 수 없는 문제가 생깁니다.</li>
<li>fit과 transform을 나눠서 적용하면 어떻게 될 것도 같은데, 해볼까요?</li>
</ul>
<div id="92e794a0" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 고민해 본 방법1 : 각 딕셔너리에 .classes_를 활용해 보존 (GPT로 구현)</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 각 열마다 별도의 LabelEncoder 생성</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>label_encoders <span class="op">=</span> {col: LabelEncoder() <span class="cf">for</span> col <span class="kw">in</span> le_columns}</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. fit: LabelEncoder를 각 열에 학습</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>le_df_encoder <span class="op">=</span> categorical_data[le_columns].<span class="bu">apply</span>(</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> col: label_encoders[col.name].fit(col)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 학습된 카테고리와 매핑된 값 저장</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>dict_classes <span class="op">=</span> {}</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> le_columns:</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 레이블과 변환된 값의 매핑 저장</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>    dict_classes[col] <span class="op">=</span> {label: idx <span class="cf">for</span> idx, label <span class="kw">in</span> <span class="bu">enumerate</span>(label_encoders[col].classes_)}</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. transform: 학습된 LabelEncoder를 각 열에 적용</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>le_df_value <span class="op">=</span> categorical_data[le_columns].<span class="bu">apply</span>(</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> col: label_encoders[col.name].transform(col)</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과 확인</span></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>dict_classes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>{'NAME_TYPE_SUITE': {'Children': 0,
  'Family': 1,
  'Group of people': 2,
  'Other_A': 3,
  'Other_B': 4,
  'Spouse, partner': 5,
  'Unaccompanied': 6,
  nan: 7},
 'NAME_INCOME_TYPE': {'Businessman': 0,
  'Commercial associate': 1,
  'Maternity leave': 2,
  'Pensioner': 3,
  'State servant': 4,
  'Student': 5,
  'Unemployed': 6,
  'Working': 7},
 'NAME_FAMILY_STATUS': {'Civil marriage': 0,
  'Married': 1,
  'Separated': 2,
  'Single / not married': 3,
  'Unknown': 4,
  'Widow': 5},
 'NAME_HOUSING_TYPE': {'Co-op apartment': 0,
  'House / apartment': 1,
  'Municipal apartment': 2,
  'Office apartment': 3,
  'Rented apartment': 4,
  'With parents': 5},
 'OCCUPATION_TYPE': {'Accountants': 0,
  'Cleaning staff': 1,
  'Cooking staff': 2,
  'Core staff': 3,
  'Drivers': 4,
  'HR staff': 5,
  'High skill tech staff': 6,
  'IT staff': 7,
  'Laborers': 8,
  'Low-skill Laborers': 9,
  'Managers': 10,
  'Medicine staff': 11,
  'Private service staff': 12,
  'Realty agents': 13,
  'Sales staff': 14,
  'Secretaries': 15,
  'Security staff': 16,
  'Waiters/barmen staff': 17,
  nan: 18},
 'WEEKDAY_APPR_PROCESS_START': {'FRIDAY': 0,
  'MONDAY': 1,
  'SATURDAY': 2,
  'SUNDAY': 3,
  'THURSDAY': 4,
  'TUESDAY': 5,
  'WEDNESDAY': 6},
 'ORGANIZATION_TYPE': {'Advertising': 0,
  'Agriculture': 1,
  'Bank': 2,
  'Business Entity Type 1': 3,
  'Business Entity Type 2': 4,
  'Business Entity Type 3': 5,
  'Cleaning': 6,
  'Construction': 7,
  'Culture': 8,
  'Electricity': 9,
  'Emergency': 10,
  'Government': 11,
  'Hotel': 12,
  'Housing': 13,
  'Industry: type 1': 14,
  'Industry: type 10': 15,
  'Industry: type 11': 16,
  'Industry: type 12': 17,
  'Industry: type 13': 18,
  'Industry: type 2': 19,
  'Industry: type 3': 20,
  'Industry: type 4': 21,
  'Industry: type 5': 22,
  'Industry: type 6': 23,
  'Industry: type 7': 24,
  'Industry: type 8': 25,
  'Industry: type 9': 26,
  'Insurance': 27,
  'Kindergarten': 28,
  'Legal Services': 29,
  'Medicine': 30,
  'Military': 31,
  'Mobile': 32,
  'Other': 33,
  'Police': 34,
  'Postal': 35,
  'Realtor': 36,
  'Religion': 37,
  'Restaurant': 38,
  'School': 39,
  'Security': 40,
  'Security Ministries': 41,
  'Self-employed': 42,
  'Services': 43,
  'Telecom': 44,
  'Trade: type 1': 45,
  'Trade: type 2': 46,
  'Trade: type 3': 47,
  'Trade: type 4': 48,
  'Trade: type 5': 49,
  'Trade: type 6': 50,
  'Trade: type 7': 51,
  'Transport: type 1': 52,
  'Transport: type 2': 53,
  'Transport: type 3': 54,
  'Transport: type 4': 55,
  'University': 56,
  'XNA': 57},
 'FONDKAPREMONT_MODE': {'not specified': 0,
  'org spec account': 1,
  'reg oper account': 2,
  'reg oper spec account': 3,
  nan: 4},
 'WALLSMATERIAL_MODE': {'Block': 0,
  'Mixed': 1,
  'Monolithic': 2,
  'Others': 3,
  'Panel': 4,
  'Stone, brick': 5,
  'Wooden': 6,
  nan: 7}}</code></pre>
</div>
</div>
<div id="b8103b50" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 고민해 본 방법2 : joblib로 인코더 저장 (타 프로젝트에서 해 본 방법)</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> joblib</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 0. 인코딩 전 데이터의 X, Y 확인</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"""X : </span><span class="sc">{</span>categorical_data[le_columns]<span class="sc">.</span>index<span class="sc">}</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="ss">      Y : </span><span class="sc">{</span>data[<span class="st">'TARGET'</span>]<span class="sc">.</span>index<span class="sc">}</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="ss">      """</span>)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 각 열마다 별도의 LabelEncoder 생성 및 학습</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>label_encoders <span class="op">=</span> {}</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> le_columns:</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>    le <span class="op">=</span> LabelEncoder()</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>    le.fit(categorical_data[col])  <span class="co"># LabelEncoder 학습</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>    label_encoders[col] <span class="op">=</span> le      <span class="co"># 학습된 인코더를 딕셔너리에 저장</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. LabelEncoder 딕셔너리를 joblib으로 저장</span></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>joblib.dump(label_encoders, <span class="st">'label_encoders.pkl'</span>)</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 저장된 LabelEncoder를 사용해 transform 적용</span></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>label_encoders_loaded <span class="op">=</span> joblib.load(<span class="st">'label_encoders.pkl'</span>)  <span class="co"># 인코더 불러오기</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>encoded_data <span class="op">=</span> categorical_data[le_columns].<span class="bu">apply</span>(</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> col: label_encoders_loaded[col.name].transform(col)</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과 확인</span></span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>encoded_data.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X : RangeIndex(start=0, stop=307511, step=1)
      Y : RangeIndex(start=0, stop=307511, step=1)
      </code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="50">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NAME_TYPE_SUITE</th>
<th data-quarto-table-cell-role="th">NAME_INCOME_TYPE</th>
<th data-quarto-table-cell-role="th">NAME_FAMILY_STATUS</th>
<th data-quarto-table-cell-role="th">NAME_HOUSING_TYPE</th>
<th data-quarto-table-cell-role="th">OCCUPATION_TYPE</th>
<th data-quarto-table-cell-role="th">WEEKDAY_APPR_PROCESS_START</th>
<th data-quarto-table-cell-role="th">ORGANIZATION_TYPE</th>
<th data-quarto-table-cell-role="th">FONDKAPREMONT_MODE</th>
<th data-quarto-table-cell-role="th">WALLSMATERIAL_MODE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>6</td>
<td>7</td>
<td>3</td>
<td>1</td>
<td>8</td>
<td>6</td>
<td>5</td>
<td>2</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>3</td>
<td>1</td>
<td>39</td>
<td>2</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>6</td>
<td>7</td>
<td>3</td>
<td>1</td>
<td>8</td>
<td>1</td>
<td>11</td>
<td>4</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>6</td>
<td>7</td>
<td>0</td>
<td>1</td>
<td>8</td>
<td>6</td>
<td>5</td>
<td>4</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>6</td>
<td>7</td>
<td>3</td>
<td>1</td>
<td>3</td>
<td>4</td>
<td>37</td>
<td>4</td>
<td>7</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="e91642b1" class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 고민해 본 방법2-2 : joblib로 저장한 인코더 로딩하는 예제</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>encoder_label <span class="op">=</span> joblib.load(<span class="st">'encoder_label.pkl'</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>x_data_all <span class="op">=</span> encoder_label.transform(df_dropped[x_column], df_dropped[y_column])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="89d3af78" class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 답</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co">## 각 컬럼에 대한 LabelEncoder를 저장할 딕셔너리</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>encoders <span class="op">=</span> {}</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co">## apply를 사용해 벡터 연산으로 처리</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> encode_column(column):</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>    le <span class="op">=</span> LabelEncoder()</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>    encoders[column.name] <span class="op">=</span> le  <span class="co"># 컬럼명을 key로 LabelEncoder 저장</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> le.fit_transform(column)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>df_encoded <span class="op">=</span> categorical_data[le_columns].<span class="bu">apply</span>(encode_column)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>순위를 반영해야하는 경우 Ordinal인코딩
<ul>
<li>순위가 명확한 학벌에 대해 적용</li>
<li>Order는 낮은 → 높은 순서로 반영</li>
</ul></li>
</ul>
<div id="471a8946" class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>np.unique(categorical_data[<span class="st">'NAME_EDUCATION_TYPE'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array(['Academic degree', 'Higher education', 'Incomplete higher',
       'Lower secondary', 'Secondary / secondary special'], dtype=object)</code></pre>
</div>
</div>
<div id="bf4c6a10" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OrdinalEncoder</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> [</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Lower secondary'</span>,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Secondary / secondary special'</span>,</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Incomplete higher'</span>,</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Higher education'</span>,</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Academic degree'</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>oe <span class="op">=</span> OrdinalEncoder(categories<span class="op">=</span>[order])</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>oe_df <span class="op">=</span> oe.fit_transform(categorical_data[[<span class="st">'NAME_EDUCATION_TYPE'</span>]], )</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>oe_df <span class="op">=</span> pd.Series(oe_df.flatten(), index<span class="op">=</span>categorical_data.index, name<span class="op">=</span><span class="st">'NAME_EDUCATION_TYPE_Encoded'</span>)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>oe_df.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>0    1.0
1    3.0
2    1.0
3    1.0
4    1.0
Name: NAME_EDUCATION_TYPE_Encoded, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="구간화-1" class="level3">
<h3 class="anchored" data-anchor-id="구간화-1">구간화</h3>
<ul>
<li><p>구간화를 할 만큼 제반지식(도메인)이 충분하지 않으므로, 임의의 더미 데이터로 구간화 실습</p></li>
<li><p><code>sklearn.preprocessing</code>의 <code>KBinsDiscretizer</code></p></li>
<li><p>아래 코드데이터를 보면, 실 성능에 도움이 되지 않을 수 있음</p>
<pre><code>  Accuracy without binning: 0.9600
  Accuracy with binning: 0.9567</code></pre></li>
<li><p><strong>구간화가 주는 메모리적 이득이 크지 않다면, 적용하는 것을 신중히 고려</strong></p></li>
</ul>
<div id="ff199cf5" class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_classification</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> KBinsDiscretizer</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 신용점수 데이터 생성</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>num_samples <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>credit_score <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, <span class="dv">1000</span>, num_samples)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>annual_income <span class="op">=</span> np.random.uniform(<span class="dv">20_000</span>, <span class="dv">100_000</span>, num_samples)</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 신용점수와 대출 승인 여부 설계</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>target_credit <span class="op">=</span> np.where(credit_score <span class="op">&gt;=</span> <span class="dv">600</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>random_noise <span class="op">=</span> np.random.choice([<span class="dv">0</span>, <span class="dv">1</span>], size<span class="op">=</span>num_samples, p<span class="op">=</span>[<span class="fl">0.2</span>, <span class="fl">0.8</span>])</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>target_credit <span class="op">=</span> np.where(random_noise <span class="op">==</span> <span class="dv">0</span>, <span class="dv">1</span> <span class="op">-</span> target_credit, target_credit)</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 더미 데이터 생성 (make_classification)</span></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>X_dummy, y_dummy <span class="op">=</span> make_classification(</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>    n_samples<span class="op">=</span>num_samples,         <span class="co"># 샘플 수</span></span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>    n_features<span class="op">=</span><span class="dv">5</span>,                  <span class="co"># 총 피처 수</span></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>    n_informative<span class="op">=</span><span class="dv">3</span>,               <span class="co"># 유의미한 피처 수</span></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>    n_redundant<span class="op">=</span><span class="dv">2</span>,                 <span class="co"># 중복된 피처 수</span></span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>    n_classes<span class="op">=</span><span class="dv">2</span>,                   <span class="co"># 클래스 수</span></span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span>,               <span class="co"># 재현성을 위한 랜덤 시드</span></span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>    class_sep<span class="op">=</span><span class="fl">1.0</span>                  <span class="co"># 클래스 간 분리 정도</span></span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 신용점수 데이터와 더미 데이터 결합</span></span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame(X_dummy, columns<span class="op">=</span>[<span class="ss">f"dummy_feature_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(X_dummy.shape[<span class="dv">1</span>])])</span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"credit_score"</span>] <span class="op">=</span> credit_score</span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"annual_income"</span>] <span class="op">=</span> annual_income</span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"target"</span>] <span class="op">=</span> np.where(target_credit <span class="op">==</span> y_dummy, target_credit, y_dummy)  <span class="co"># 타겟 혼합</span></span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 분리</span></span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data.drop(columns<span class="op">=</span>[<span class="st">"target"</span>])</span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data[<span class="st">"target"</span>]</span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-42"><a href="#cb79-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 구간화를 적용하지 않은 경우</span></span>
<span id="cb79-43"><a href="#cb79-43" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb79-44"><a href="#cb79-44" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb79-45"><a href="#cb79-45" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train)</span>
<span id="cb79-46"><a href="#cb79-46" aria-hidden="true" tabindex="-1"></a>non_binned_preds <span class="op">=</span> model.predict(X_test)</span>
<span id="cb79-47"><a href="#cb79-47" aria-hidden="true" tabindex="-1"></a>non_binned_accuracy <span class="op">=</span> accuracy_score(y_test, non_binned_preds)</span>
<span id="cb79-48"><a href="#cb79-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-49"><a href="#cb79-49" aria-hidden="true" tabindex="-1"></a><span class="co"># 신용점수에 구간화 적용 (고위험: 0~400, 중위험: 400~700, 저위험: 700~1000)</span></span>
<span id="cb79-50"><a href="#cb79-50" aria-hidden="true" tabindex="-1"></a>binner <span class="op">=</span> KBinsDiscretizer(n_bins<span class="op">=</span><span class="dv">3</span>, encode<span class="op">=</span><span class="st">'ordinal'</span>, strategy<span class="op">=</span><span class="st">'uniform'</span>)</span>
<span id="cb79-51"><a href="#cb79-51" aria-hidden="true" tabindex="-1"></a>X_binned <span class="op">=</span> X.copy()</span>
<span id="cb79-52"><a href="#cb79-52" aria-hidden="true" tabindex="-1"></a>X_binned[<span class="st">"credit_score"</span>] <span class="op">=</span> binner.fit_transform(X[[<span class="st">"credit_score"</span>]]).flatten()</span>
<span id="cb79-53"><a href="#cb79-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-54"><a href="#cb79-54" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 분리 (구간화된 데이터)</span></span>
<span id="cb79-55"><a href="#cb79-55" aria-hidden="true" tabindex="-1"></a>X_train_binned, X_test_binned, y_train, y_test <span class="op">=</span> train_test_split(X_binned, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb79-56"><a href="#cb79-56" aria-hidden="true" tabindex="-1"></a>model_binned <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb79-57"><a href="#cb79-57" aria-hidden="true" tabindex="-1"></a>model_binned.fit(X_train_binned, y_train)</span>
<span id="cb79-58"><a href="#cb79-58" aria-hidden="true" tabindex="-1"></a>binned_preds <span class="op">=</span> model_binned.predict(X_test_binned)</span>
<span id="cb79-59"><a href="#cb79-59" aria-hidden="true" tabindex="-1"></a>binned_accuracy <span class="op">=</span> accuracy_score(y_test, binned_preds)</span>
<span id="cb79-60"><a href="#cb79-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-61"><a href="#cb79-61" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과 출력</span></span>
<span id="cb79-62"><a href="#cb79-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy without binning: </span><span class="sc">{</span>non_binned_accuracy<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb79-63"><a href="#cb79-63" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy with binning: </span><span class="sc">{</span>binned_accuracy<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy without binning: 0.9600
Accuracy with binning: 0.9567</code></pre>
</div>
</div>
</section>
<section id="과제" class="level3">
<h3 class="anchored" data-anchor-id="과제">과제</h3>
<ul>
<li>개인/팀에 따라 주어진 과제 데이터에 대해, <strong>EDA와 전처리</strong> 진행 후, 데이터마트(csv파일) 만들기</li>
<li>데이터를 처음보는(모르는) 사람에게 잘 설명하는 것이 앞으로의 (분석)업무임을 생각하며 진행</li>
<li>위의 과정이 들어간 ipynb파일을 과제로 제출(+만든 csv파일은 계속 활용할 것이므로 잘 가지고 있기)</li>
<li>과제 유형
<ul>
<li>단체 과제 : Home Credit Default Risk (주택담보대출)
<ul>
<li>https://www.kaggle.com/c/home-credit-default-risk/overview</li>
<li>특징
<ul>
<li>실제 현업처럼 데이터가 나뉘어 있음</li>
<li><strong>(분석용 마트를 만들기 위해)먼저 Merge를 한 후, 개인별로 EDA를 하는 경우가 많음</strong></li>
<li>이 과제의 모든 데이터를 쓸 필요는 없음 (좀 더 보고싶은 변수들을 Merge)
<ul>
<li>application_{train|test}.csv 파일만으로도 (y값)제출 진행 가능함</li>
</ul></li>
<li><strong>인코딩을 제외하고는 필수 전처리는 아님. 다만 좋은 결과를 위해서는 추가해야 함</strong></li>
<li>기존에 소개한 산탄데르 과제는 너무 과한 과제로 보여 제외함
<ul>
<li>https://www.kaggle.com/competitions/santander-customer-satisfaction/overview</li>
</ul></li>
</ul></li>
</ul></li>
<li>개인 과제 : 월간 데이콘 신용카드 사용자 연체 예측 AI 경진대회 (신용카드 연체예측)
<ul>
<li>https://dacon.io/competitions/official/235713/overview/description</li>
<li>특징
<ul>
<li>단체 과제보다 컬럼의 수가 적음</li>
</ul></li>
</ul></li>
</ul></li>
</ul>


</section>
</section>
</section>

<p><br><strong>Copyright © 2024 Kibok Park All rights reserved.</strong><br></p></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/kr9268\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="kr9268/giscus_for_blog" data-repo-id="R_kgDOL0Sthw" data-category="General" data-category-id="DIC_kwDOL0Sth84Ce_5h" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<script>
    const baseFontSize = parseFloat(getComputedStyle(document.documentElement).fontSize);
    const watermark = new XWatermark.XWatermark();
    watermark.init("Kibok Park", {
      parentSelector: "body",
      prevent: true,
      observer: true,
      mode: "normal",
      font: "system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', 'Noto Sans', 'Liberation Sans', Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'",
      fontsize: baseFontSize * 1.000000,
      angle: -15.000000,
      color: "#000000",
      alpha: 0.100000,
      cols: 10,
      rows: 50,
      xSpace: baseFontSize * 4.000000,
      ySpace: baseFontSize * 4.000000,
      zIndex: -1
    });
    </script>




</body></html>