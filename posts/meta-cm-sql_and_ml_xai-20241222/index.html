<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kibok Park">
<meta name="dcterms.date" content="2024-12-22">

<title>[DA스터디/1주차] SQL기초 및 실습 – Blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../profile.jpg" rel="icon" type="image/jpeg">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ef56b68f8fa1e9d2ba328e99e439f80.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-6a4c75c897c7090e25337f92bebeec5a.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-53290a7a9d457538af1dff41dbf92c81.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-6a4c75c897c7090e25337f92bebeec5a.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/watermark-1.0.11/watermark.min.js"></script>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-LPL499WQBH"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-LPL499WQBH', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index_dashboards.html"> 
<span class="menu-text">Dashboards</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../index_miniprojects.html"> 
<span class="menu-text">Mini Projects</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/KR9268"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/%EA%B8%B0%EB%B3%B5-%EB%B0%95-573a68268/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">[DA스터디/1주차] SQL기초 및 실습</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Python</div>
                <div class="quarto-category">SQL</div>
                <div class="quarto-category">202412Study_DataAnalysis</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Kibok Park </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 22, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#개요" id="toc-개요" class="nav-link active" data-scroll-target="#개요">개요</a></li>
  <li><a href="#주차-수업정리" id="toc-주차-수업정리" class="nav-link" data-scroll-target="#주차-수업정리">1주차 수업정리</a>
  <ul class="collapse">
  <li><a href="#sql문-실행순서" id="toc-sql문-실행순서" class="nav-link" data-scroll-target="#sql문-실행순서">SQL문 실행순서</a></li>
  <li><a href="#select" id="toc-select" class="nav-link" data-scroll-target="#select">SELECT</a></li>
  <li><a href="#select-실습" id="toc-select-실습" class="nav-link" data-scroll-target="#select-실습">SELECT 실습</a></li>
  <li><a href="#where" id="toc-where" class="nav-link" data-scroll-target="#where">WHERE</a></li>
  <li><a href="#where-심화" id="toc-where-심화" class="nav-link" data-scroll-target="#where-심화">WHERE 심화</a></li>
  <li><a href="#where-실습" id="toc-where-실습" class="nav-link" data-scroll-target="#where-실습">WHERE 실습</a></li>
  <li><a href="#group-by-집계함수" id="toc-group-by-집계함수" class="nav-link" data-scroll-target="#group-by-집계함수">GROUP BY (+집계함수)</a></li>
  <li><a href="#group-by-실습" id="toc-group-by-실습" class="nav-link" data-scroll-target="#group-by-실습">GROUP BY 실습</a></li>
  <li><a href="#having" id="toc-having" class="nav-link" data-scroll-target="#having">HAVING</a></li>
  <li><a href="#having-실습" id="toc-having-실습" class="nav-link" data-scroll-target="#having-실습">HAVING 실습</a></li>
  <li><a href="#order-by정렬" id="toc-order-by정렬" class="nav-link" data-scroll-target="#order-by정렬">ORDER BY(정렬)</a></li>
  <li><a href="#limit" id="toc-limit" class="nav-link" data-scroll-target="#limit">LIMIT</a></li>
  <li><a href="#order-by-limit-실습" id="toc-order-by-limit-실습" class="nav-link" data-scroll-target="#order-by-limit-실습">ORDER BY &amp; LIMIT 실습</a></li>
  <li><a href="#결과를-테이블로-저장" id="toc-결과를-테이블로-저장" class="nav-link" data-scroll-target="#결과를-테이블로-저장">결과를 테이블로 저장</a></li>
  <li><a href="#결과를-테이블로-저장하기-실습" id="toc-결과를-테이블로-저장하기-실습" class="nav-link" data-scroll-target="#결과를-테이블로-저장하기-실습">결과를 테이블로 저장하기 실습</a></li>
  </ul></li>
  <li><a href="#과제" id="toc-과제" class="nav-link" data-scroll-target="#과제">과제</a>
  <ul class="collapse">
  <li><a href="#프로그래머스-과제-풀기" id="toc-프로그래머스-과제-풀기" class="nav-link" data-scroll-target="#프로그래머스-과제-풀기">프로그래머스 과제 풀기</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">






<p>금융권 데이터를 활용한 분석 스터디 - 1주차</p>
<section id="개요" class="level1">
<h1>개요</h1>
<ul>
<li>아래의 목적/이유로 참가한 스터디에 대한 기록
<ul>
<li>SQLD취득 후 장기 미사용 &amp; GPT를 통한 SQL사용 등으로 많이 잊은 SQL을 복기</li>
<li>기존에 사용해 본 Optuna가 아닌 Autogluon이 커리큘럼에 있어 익혀보고자 함</li>
<li>혼자서 postgresql로 DB만들어 써본 적은 있는데, 잘 와닿지 않는 ’데이터마트’생성이 언급되어 있어 개념 정립하고자 함</li>
<li>기존에 관심있던 XAI(설명가능한 AI)를 익히고자 함</li>
</ul></li>
<li>1주차 요약
<ul>
<li>SQL문의 실행순서와 실습</li>
<li>프로그래머스, 해커스랭크의 SQL문제풀이 과제
<ul>
<li>해커스랭크는 문제/풀이 게시에 대한 저작권 내용 확인이 어려워 삭제함</li>
</ul></li>
<li>참고 : 하단 실습코드는 head() 적용되 있음(불필요하게 긴 포스팅 방지)</li>
</ul></li>
</ul>
</section>
<section id="주차-수업정리" class="level1">
<h1>1주차 수업정리</h1>
<section id="sql문-실행순서" class="level2">
<h2 class="anchored" data-anchor-id="sql문-실행순서">SQL문 실행순서</h2>
<ol type="1">
<li>SELECT<br>
</li>
<li>FROM<br>
</li>
<li>JOIN ON<br>
</li>
<li>WHERE<br>
</li>
<li>GROUP BY<br>
</li>
<li>HAVING</li>
<li>ORDER BY<br>
</li>
<li>LIMIT</li>
</ol>
</section>
<section id="select" class="level2">
<h2 class="anchored" data-anchor-id="select">SELECT</h2>
<div id="73b1544e" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>conn <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">'my_database.db'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="8646fdb8" class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 컬럼 지정</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>selected_df <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT idx, y, job FROM my_table;"</span>, conn)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>selected_df.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">y</th>
<th data-quarto-table-cell-role="th">job</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>no</td>
<td>housemaid</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>no</td>
<td>services</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>no</td>
<td>services</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>no</td>
<td>admin.</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>no</td>
<td>services</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="d486f28f" class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 전체 컬럼 (*)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df_all <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * FROM my_table"</span>, conn)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df_all.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">job</th>
<th data-quarto-table-cell-role="th">marital</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">is_default</th>
<th data-quarto-table-cell-role="th">housing</th>
<th data-quarto-table-cell-role="th">loan</th>
<th data-quarto-table-cell-role="th">contact</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">campaign</th>
<th data-quarto-table-cell-role="th">pdays</th>
<th data-quarto-table-cell-role="th">previous</th>
<th data-quarto-table-cell-role="th">poutcome</th>
<th data-quarto-table-cell-role="th">emp_var_rate</th>
<th data-quarto-table-cell-role="th">cons_price_idx</th>
<th data-quarto-table-cell-role="th">cons_conf_idx</th>
<th data-quarto-table-cell-role="th">euribor3m</th>
<th data-quarto-table-cell-role="th">nr_employed</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>56</td>
<td>housemaid</td>
<td>married</td>
<td>basic.4y</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>57</td>
<td>services</td>
<td>married</td>
<td>high.school</td>
<td>unknown</td>
<td>no</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>37</td>
<td>services</td>
<td>married</td>
<td>high.school</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>40</td>
<td>admin.</td>
<td>married</td>
<td>basic.6y</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>56</td>
<td>services</td>
<td>married</td>
<td>high.school</td>
<td>no</td>
<td>no</td>
<td>yes</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
</tbody>
</table>

<p>5 rows × 22 columns</p>
</div>
</div>
</div>
</section>
<section id="select-실습" class="level2">
<h2 class="anchored" data-anchor-id="select-실습">SELECT 실습</h2>
<ul>
<li>my_table에서 idx, martial, education, y를 조회하여 df_trial_1에 할당해봅시다.</li>
</ul>
<div id="dad03b88" class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df_trial_1 <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT idx, marital, education, y FROM my_table"</span>, conn)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df_trial_1.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">marital</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>married</td>
<td>basic.4y</td>
<td>no</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>married</td>
<td>high.school</td>
<td>no</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>married</td>
<td>high.school</td>
<td>no</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>married</td>
<td>basic.6y</td>
<td>no</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>married</td>
<td>high.school</td>
<td>no</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="where" class="level2">
<h2 class="anchored" data-anchor-id="where">WHERE</h2>
<ul>
<li>WHERE에서의 <code>1=1</code>의 사용
<ul>
<li>없어도 되지만 <strong>편의</strong>를 위해 사용. <strong>실무적으로 많이 활용되는 편</strong></li>
<li>괄호를 활용해 우선순위를 부여(명시)해주는 것이 좋음
<ul>
<li>AND(*)가 OR(+)보다 우선순위가 높으나, 헷갈리지 않게 명시</li>
</ul></li>
</ul></li>
</ul>
<div id="ed6311e0" class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> <span class="st">"""SELECT</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="st">    *</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM my_table</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE 1=1</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="st">    AND y = 'no'</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="st">    AND (</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="st">        is_default = 'no'</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="st">        OR campaign &gt; 0</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="st">    );"""</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>df_multicon_2 <span class="op">=</span> pd.read_sql_query(q, conn)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>df_multicon_2.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">job</th>
<th data-quarto-table-cell-role="th">marital</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">is_default</th>
<th data-quarto-table-cell-role="th">housing</th>
<th data-quarto-table-cell-role="th">loan</th>
<th data-quarto-table-cell-role="th">contact</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">campaign</th>
<th data-quarto-table-cell-role="th">pdays</th>
<th data-quarto-table-cell-role="th">previous</th>
<th data-quarto-table-cell-role="th">poutcome</th>
<th data-quarto-table-cell-role="th">emp_var_rate</th>
<th data-quarto-table-cell-role="th">cons_price_idx</th>
<th data-quarto-table-cell-role="th">cons_conf_idx</th>
<th data-quarto-table-cell-role="th">euribor3m</th>
<th data-quarto-table-cell-role="th">nr_employed</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>56</td>
<td>housemaid</td>
<td>married</td>
<td>basic.4y</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>57</td>
<td>services</td>
<td>married</td>
<td>high.school</td>
<td>unknown</td>
<td>no</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>37</td>
<td>services</td>
<td>married</td>
<td>high.school</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>40</td>
<td>admin.</td>
<td>married</td>
<td>basic.6y</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>56</td>
<td>services</td>
<td>married</td>
<td>high.school</td>
<td>no</td>
<td>no</td>
<td>yes</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
</tbody>
</table>

<p>5 rows × 22 columns</p>
</div>
</div>
</div>
</section>
<section id="where-심화" class="level2">
<h2 class="anchored" data-anchor-id="where-심화">WHERE 심화</h2>
<ul>
<li>LIKE : 문자열에서 찾기 (%와 함께 사용해 특정 문자열을 포함한 경우를 찾기도 함)</li>
<li>IN : 특정 목록에 포함된 경우 찾기</li>
<li>BETWEEN : 범위 안에 포함된 경우 찾기</li>
</ul>
<div id="da5c79ec" class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 'LIKE'를 활용해 9가 포함된 값을 찾는 예제</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> <span class="st">"""SELECT</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="st">    *</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM my_table</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE idx LIKE '</span><span class="sc">%9%</span><span class="st">';"""</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>df_idcode_9 <span class="op">=</span> pd.read_sql_query(q, conn)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>df_idcode_9.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">job</th>
<th data-quarto-table-cell-role="th">marital</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">is_default</th>
<th data-quarto-table-cell-role="th">housing</th>
<th data-quarto-table-cell-role="th">loan</th>
<th data-quarto-table-cell-role="th">contact</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">campaign</th>
<th data-quarto-table-cell-role="th">pdays</th>
<th data-quarto-table-cell-role="th">previous</th>
<th data-quarto-table-cell-role="th">poutcome</th>
<th data-quarto-table-cell-role="th">emp_var_rate</th>
<th data-quarto-table-cell-role="th">cons_price_idx</th>
<th data-quarto-table-cell-role="th">cons_conf_idx</th>
<th data-quarto-table-cell-role="th">euribor3m</th>
<th data-quarto-table-cell-role="th">nr_employed</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>9</td>
<td>25</td>
<td>services</td>
<td>single</td>
<td>high.school</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>19</td>
<td>39</td>
<td>management</td>
<td>single</td>
<td>basic.9y</td>
<td>unknown</td>
<td>no</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>29</td>
<td>55</td>
<td>unknown</td>
<td>married</td>
<td>university.degree</td>
<td>unknown</td>
<td>unknown</td>
<td>unknown</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>39</td>
<td>56</td>
<td>technician</td>
<td>married</td>
<td>basic.4y</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>49</td>
<td>45</td>
<td>blue-collar</td>
<td>married</td>
<td>basic.9y</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>2</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
</tbody>
</table>

<p>5 rows × 22 columns</p>
</div>
</div>
</div>
<div id="deaeb940" class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 'IN'을 활용해 특정 목록의 데이터가 포함된 값을 찾는 예제</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>IDS <span class="op">=</span> (<span class="st">'11003'</span>,<span class="st">'12903'</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> <span class="ss">f"""SELECT</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="ss">    *</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="ss">FROM my_table</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="ss">WHERE idx in </span><span class="sc">{</span>IDS<span class="sc">}</span><span class="ss">;"""</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>df_given_ids <span class="op">=</span> pd.read_sql_query(q, conn)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>df_given_ids</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">job</th>
<th data-quarto-table-cell-role="th">marital</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">is_default</th>
<th data-quarto-table-cell-role="th">housing</th>
<th data-quarto-table-cell-role="th">loan</th>
<th data-quarto-table-cell-role="th">contact</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">campaign</th>
<th data-quarto-table-cell-role="th">pdays</th>
<th data-quarto-table-cell-role="th">previous</th>
<th data-quarto-table-cell-role="th">poutcome</th>
<th data-quarto-table-cell-role="th">emp_var_rate</th>
<th data-quarto-table-cell-role="th">cons_price_idx</th>
<th data-quarto-table-cell-role="th">cons_conf_idx</th>
<th data-quarto-table-cell-role="th">euribor3m</th>
<th data-quarto-table-cell-role="th">nr_employed</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>11003</td>
<td>56</td>
<td>retired</td>
<td>married</td>
<td>basic.4y</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>telephone</td>
<td>jun</td>
<td>...</td>
<td>30</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.4</td>
<td>94.465</td>
<td>-41.8</td>
<td>4.962</td>
<td>5228.1</td>
<td>no</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>12903</td>
<td>23</td>
<td>admin.</td>
<td>single</td>
<td>high.school</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>cellular</td>
<td>jul</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.4</td>
<td>93.918</td>
<td>-42.7</td>
<td>4.962</td>
<td>5228.1</td>
<td>no</td>
</tr>
</tbody>
</table>

<p>2 rows × 22 columns</p>
</div>
</div>
</div>
<div id="9ae72e00" class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 'BETWEEN'을 활용해 특정 범위의 데이터를 찾는 예제</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span><span class="st">"""SELECT</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="st">    *</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM my_table</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE campaign BETWEEN 10 AND 20;"""</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>df_between <span class="op">=</span> pd.read_sql_query(q, conn)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>df_between.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">job</th>
<th data-quarto-table-cell-role="th">marital</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">is_default</th>
<th data-quarto-table-cell-role="th">housing</th>
<th data-quarto-table-cell-role="th">loan</th>
<th data-quarto-table-cell-role="th">contact</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">campaign</th>
<th data-quarto-table-cell-role="th">pdays</th>
<th data-quarto-table-cell-role="th">previous</th>
<th data-quarto-table-cell-role="th">poutcome</th>
<th data-quarto-table-cell-role="th">emp_var_rate</th>
<th data-quarto-table-cell-role="th">cons_price_idx</th>
<th data-quarto-table-cell-role="th">cons_conf_idx</th>
<th data-quarto-table-cell-role="th">euribor3m</th>
<th data-quarto-table-cell-role="th">nr_employed</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2183</td>
<td>58</td>
<td>management</td>
<td>married</td>
<td>university.degree</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>10</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2189</td>
<td>56</td>
<td>admin.</td>
<td>married</td>
<td>basic.9y</td>
<td>unknown</td>
<td>no</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>11</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2234</td>
<td>47</td>
<td>management</td>
<td>married</td>
<td>university.degree</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>12</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2553</td>
<td>54</td>
<td>retired</td>
<td>married</td>
<td>high.school</td>
<td>unknown</td>
<td>no</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>10</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.856</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2554</td>
<td>31</td>
<td>admin.</td>
<td>married</td>
<td>high.school</td>
<td>unknown</td>
<td>yes</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>13</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.856</td>
<td>5191.0</td>
<td>no</td>
</tr>
</tbody>
</table>

<p>5 rows × 22 columns</p>
</div>
</div>
</div>
</section>
<section id="where-실습" class="level2">
<h2 class="anchored" data-anchor-id="where-실습">WHERE 실습</h2>
<ul>
<li>문제
<ul>
<li>idx에 7이 들어가며</li>
<li>emp_var_rate가 1보다 크고</li>
<li>연령이 20세 이하거나</li>
<li>연령이 70대 이상인</li>
<li>고객을 구하세요.</li>
</ul></li>
</ul>
<div id="d97f833b" class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span><span class="st">"""SELECT</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="st">    *</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM my_table</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE 1=1</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="st">AND idx Like '</span><span class="sc">%7%</span><span class="st">'</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="st">AND emp_var_rate &gt; 1</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="st">AND (age &lt;= 20 or age &gt;= 70);"""</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>df_q2 <span class="op">=</span> pd.read_sql_query(q, conn)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>df_q2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">job</th>
<th data-quarto-table-cell-role="th">marital</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">is_default</th>
<th data-quarto-table-cell-role="th">housing</th>
<th data-quarto-table-cell-role="th">loan</th>
<th data-quarto-table-cell-role="th">contact</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">campaign</th>
<th data-quarto-table-cell-role="th">pdays</th>
<th data-quarto-table-cell-role="th">previous</th>
<th data-quarto-table-cell-role="th">poutcome</th>
<th data-quarto-table-cell-role="th">emp_var_rate</th>
<th data-quarto-table-cell-role="th">cons_price_idx</th>
<th data-quarto-table-cell-role="th">cons_conf_idx</th>
<th data-quarto-table-cell-role="th">euribor3m</th>
<th data-quarto-table-cell-role="th">nr_employed</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>6575</td>
<td>20</td>
<td>entrepreneur</td>
<td>single</td>
<td>high.school</td>
<td>no</td>
<td>no</td>
<td>yes</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>13407</td>
<td>20</td>
<td>admin.</td>
<td>single</td>
<td>high.school</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>cellular</td>
<td>jul</td>
<td>...</td>
<td>4</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.4</td>
<td>93.918</td>
<td>-42.7</td>
<td>4.962</td>
<td>5228.1</td>
<td>no</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>15798</td>
<td>19</td>
<td>student</td>
<td>single</td>
<td>basic.9y</td>
<td>unknown</td>
<td>yes</td>
<td>no</td>
<td>cellular</td>
<td>jul</td>
<td>...</td>
<td>4</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.4</td>
<td>93.918</td>
<td>-42.7</td>
<td>4.960</td>
<td>5228.1</td>
<td>no</td>
</tr>
</tbody>
</table>

<p>3 rows × 22 columns</p>
</div>
</div>
</div>
</section>
<section id="group-by-집계함수" class="level2">
<h2 class="anchored" data-anchor-id="group-by-집계함수">GROUP BY (+집계함수)</h2>
<ul>
<li>GROUP BY를 활용해 정보를 그룹핑하여 볼 수 있음</li>
<li>SELECT문에 집계함수(SUM 등)를 적어, 해당 컬럼별 집계 가능
<ul>
<li>주의 : 컬럼(변수)이 집계함수나 GROUP BY절 중 한 곳에는 있어야 함</li>
<li>추천 : 집계함수를 적용한 컬럼은 AS로 이름을 지정하는 것이 좋음</li>
</ul></li>
<li>집계함수의 종류
<ul>
<li>SUM : 합</li>
<li>AVG (MEAN) : 평균</li>
<li>MIN / MAX : 최소 / 최대값</li>
<li>COUNT : 개수</li>
</ul></li>
</ul>
<div id="4f2e521c" class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span><span class="st">"""SELECT</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="st">    y, SUM(duration) as sum_dur</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM my_table</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY y;"""</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>df_sum_0 <span class="op">=</span> pd.read_sql_query(q, conn)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>df_sum_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">y</th>
<th data-quarto-table-cell-role="th">sum_dur</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>no</td>
<td>8071436</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>yes</td>
<td>2566807</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="group-by-실습" class="level2">
<h2 class="anchored" data-anchor-id="group-by-실습">GROUP BY 실습</h2>
<ul>
<li>문제
<ul>
<li>y별로</li>
<li>idx에 7이 들어가는 대상에 대해</li>
<li>duration의 합과</li>
<li>campaign의 평균, 최대, 최소값을 구해봅시다</li>
</ul></li>
</ul>
<div id="201bc521" class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span><span class="st">"""SELECT</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="st">    y, SUM(duration) as sum_dur, AVG(campaign) as avg_camp, MIN(campaign) as min_camp, MAX(campaign) as max_camp</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM my_table</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE idx like '</span><span class="sc">%7%</span><span class="st">'</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY y;"""</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>df_sum_0 <span class="op">=</span> pd.read_sql_query(q, conn)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>df_sum_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">y</th>
<th data-quarto-table-cell-role="th">sum_dur</th>
<th data-quarto-table-cell-role="th">avg_camp</th>
<th data-quarto-table-cell-role="th">min_camp</th>
<th data-quarto-table-cell-role="th">max_camp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>no</td>
<td>2680014</td>
<td>2.786460</td>
<td>1</td>
<td>56</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>yes</td>
<td>911542</td>
<td>2.091711</td>
<td>1</td>
<td>17</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="having" class="level2">
<h2 class="anchored" data-anchor-id="having">HAVING</h2>
<ul>
<li>집계함수의 결과의 필터링에 HAVING 사용
<ul>
<li>집계함수는 WHERE절 이후 실행되어 WHERE절에서의 집계함수 필터링은 불가함</li>
</ul></li>
</ul>
<div id="9efd18ad" class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span><span class="st">"""SELECT</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="st">    y, SUM(duration) as sum_dur</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM my_table</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY y</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="st">HAVING SUM(duration) &gt; 5000000;"""</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>df_sum_over_1m <span class="op">=</span> pd.read_sql_query(q, conn)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>df_sum_over_1m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">y</th>
<th data-quarto-table-cell-role="th">sum_dur</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>no</td>
<td>8071436</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="having-실습" class="level2">
<h2 class="anchored" data-anchor-id="having-실습">HAVING 실습</h2>
<ul>
<li>문제
<ul>
<li>y별로</li>
<li>var_0의 평균값이 11보다 큰 y 대해</li>
<li>var_0의 평균을 avg_var_0,</li>
<li>var_100의 최대값을 max_var_100,</li>
<li>var_100의 최소값을 min_var_100</li>
<li>으로 구하는 쿼리를 써봅시다.</li>
</ul></li>
</ul>
<div id="8e95944d" class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span><span class="st">"""SELECT</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="st">    y, SUM(duration) as sum_dur</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM my_table</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY y</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="st">HAVING SUM(duration) &gt; 5000000;"""</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>df_sum_over_1m <span class="op">=</span> pd.read_sql_query(q, conn)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>df_sum_over_1m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">y</th>
<th data-quarto-table-cell-role="th">sum_dur</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>no</td>
<td>8071436</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="order-by정렬" class="level2">
<h2 class="anchored" data-anchor-id="order-by정렬">ORDER BY(정렬)</h2>
<ul>
<li>ORDER BY로 정렬 (SQL마다 다를 수 있으나 기본값은 보통 오름차순)
<ul>
<li>내림차순을 원하는 경우 뒤에 <code>DESC</code>를 붙임</li>
</ul></li>
</ul>
<div id="ba1b0835" class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 오름차순 (기본값) 예제</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span><span class="st">"""SELECT</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="st">    *</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM my_table</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY idx;"""</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>df_var0_order <span class="op">=</span> pd.read_sql_query(q, conn)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>df_var0_order.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">job</th>
<th data-quarto-table-cell-role="th">marital</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">is_default</th>
<th data-quarto-table-cell-role="th">housing</th>
<th data-quarto-table-cell-role="th">loan</th>
<th data-quarto-table-cell-role="th">contact</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">campaign</th>
<th data-quarto-table-cell-role="th">pdays</th>
<th data-quarto-table-cell-role="th">previous</th>
<th data-quarto-table-cell-role="th">poutcome</th>
<th data-quarto-table-cell-role="th">emp_var_rate</th>
<th data-quarto-table-cell-role="th">cons_price_idx</th>
<th data-quarto-table-cell-role="th">cons_conf_idx</th>
<th data-quarto-table-cell-role="th">euribor3m</th>
<th data-quarto-table-cell-role="th">nr_employed</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>56</td>
<td>housemaid</td>
<td>married</td>
<td>basic.4y</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>57</td>
<td>services</td>
<td>married</td>
<td>high.school</td>
<td>unknown</td>
<td>no</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>37</td>
<td>services</td>
<td>married</td>
<td>high.school</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>40</td>
<td>admin.</td>
<td>married</td>
<td>basic.6y</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>56</td>
<td>services</td>
<td>married</td>
<td>high.school</td>
<td>no</td>
<td>no</td>
<td>yes</td>
<td>telephone</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>1.1</td>
<td>93.994</td>
<td>-36.4</td>
<td>4.857</td>
<td>5191.0</td>
<td>no</td>
</tr>
</tbody>
</table>

<p>5 rows × 22 columns</p>
</div>
</div>
</div>
<div id="90b7e4a2" class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 내림차순 예제제</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span><span class="st">"""SELECT</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="st">    *</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM my_table</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY idx;"""</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>df_var0_order <span class="op">=</span> pd.read_sql_query(q, conn)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>df_var0_order.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="limit" class="level2">
<h2 class="anchored" data-anchor-id="limit">LIMIT</h2>
<ul>
<li><strong>위에서부터 N개의 값을 반환</strong>하는, pandas의 .head(N)과 같은 함수</li>
</ul>
<div id="09b8e5fe" class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> <span class="st">"""SELECT</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="st">    *</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM my_table</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 100</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>df_100 <span class="op">=</span> pd.read_sql_query(q, conn)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(df_100)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>100</code></pre>
</div>
</div>
</section>
<section id="order-by-limit-실습" class="level2">
<h2 class="anchored" data-anchor-id="order-by-limit-실습">ORDER BY &amp; LIMIT 실습</h2>
<ul>
<li>pdays가 999가 아닌 경우에 한해서, pdays값이 상위 100개에 해당하는 데이터를 반환하는 쿼리를 짜 봅시다.</li>
</ul>
<div id="ec1b4ca7" class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Write your code</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> <span class="st">"""SELECT</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="st">    *</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM my_table</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE pdays != 999</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY pdays desc</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 100</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>df_100 <span class="op">=</span> pd.read_sql_query(q, conn)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(df_100))</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>df_100.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>100</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">job</th>
<th data-quarto-table-cell-role="th">marital</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">is_default</th>
<th data-quarto-table-cell-role="th">housing</th>
<th data-quarto-table-cell-role="th">loan</th>
<th data-quarto-table-cell-role="th">contact</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">campaign</th>
<th data-quarto-table-cell-role="th">pdays</th>
<th data-quarto-table-cell-role="th">previous</th>
<th data-quarto-table-cell-role="th">poutcome</th>
<th data-quarto-table-cell-role="th">emp_var_rate</th>
<th data-quarto-table-cell-role="th">cons_price_idx</th>
<th data-quarto-table-cell-role="th">cons_conf_idx</th>
<th data-quarto-table-cell-role="th">euribor3m</th>
<th data-quarto-table-cell-role="th">nr_employed</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>40874</td>
<td>41</td>
<td>technician</td>
<td>married</td>
<td>professional.course</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>cellular</td>
<td>oct</td>
<td>...</td>
<td>2</td>
<td>27</td>
<td>1</td>
<td>success</td>
<td>-1.1</td>
<td>94.601</td>
<td>-49.5</td>
<td>0.959</td>
<td>4963.6</td>
<td>yes</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>40243</td>
<td>24</td>
<td>technician</td>
<td>married</td>
<td>professional.course</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>cellular</td>
<td>jul</td>
<td>...</td>
<td>4</td>
<td>26</td>
<td>1</td>
<td>success</td>
<td>-1.7</td>
<td>94.215</td>
<td>-40.3</td>
<td>0.885</td>
<td>4991.6</td>
<td>yes</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>40234</td>
<td>60</td>
<td>admin.</td>
<td>married</td>
<td>basic.9y</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>cellular</td>
<td>jul</td>
<td>...</td>
<td>2</td>
<td>25</td>
<td>2</td>
<td>failure</td>
<td>-1.7</td>
<td>94.215</td>
<td>-40.3</td>
<td>0.884</td>
<td>4991.6</td>
<td>yes</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>39883</td>
<td>28</td>
<td>management</td>
<td>single</td>
<td>university.degree</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>cellular</td>
<td>jun</td>
<td>...</td>
<td>1</td>
<td>22</td>
<td>1</td>
<td>success</td>
<td>-1.7</td>
<td>94.055</td>
<td>-39.8</td>
<td>0.729</td>
<td>4991.6</td>
<td>yes</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>40489</td>
<td>30</td>
<td>admin.</td>
<td>single</td>
<td>high.school</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>telephone</td>
<td>aug</td>
<td>...</td>
<td>1</td>
<td>22</td>
<td>1</td>
<td>success</td>
<td>-1.7</td>
<td>94.027</td>
<td>-38.3</td>
<td>0.899</td>
<td>4991.6</td>
<td>no</td>
</tr>
</tbody>
</table>

<p>5 rows × 22 columns</p>
</div>
</div>
</div>
</section>
<section id="결과를-테이블로-저장" class="level2">
<h2 class="anchored" data-anchor-id="결과를-테이블로-저장">결과를 테이블로 저장</h2>
<p><em><code>CREATE TABLE (테이블이름) AS</code> SELECT </em> FROM TABLE</p>
<div id="2d76d988" class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 특정 쿼리를 테이블 저장</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span><span class="st">"""CREATE TABLE MY_TABLE_ORDERED AS</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="st">    *</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="st">FROM MY_TABLE</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY idx DESC;"""</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>conn.execute(q)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 저정한 테이블 조회</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>q2 <span class="op">=</span><span class="st">"""SELECT * FROM MY_TABLE_ORDERED;"""</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>df_var0_desc_order <span class="op">=</span> pd.read_sql_query(q2, conn)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>df_var0_desc_order.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">job</th>
<th data-quarto-table-cell-role="th">marital</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">is_default</th>
<th data-quarto-table-cell-role="th">housing</th>
<th data-quarto-table-cell-role="th">loan</th>
<th data-quarto-table-cell-role="th">contact</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">campaign</th>
<th data-quarto-table-cell-role="th">pdays</th>
<th data-quarto-table-cell-role="th">previous</th>
<th data-quarto-table-cell-role="th">poutcome</th>
<th data-quarto-table-cell-role="th">emp_var_rate</th>
<th data-quarto-table-cell-role="th">cons_price_idx</th>
<th data-quarto-table-cell-role="th">cons_conf_idx</th>
<th data-quarto-table-cell-role="th">euribor3m</th>
<th data-quarto-table-cell-role="th">nr_employed</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>41187</td>
<td>74</td>
<td>retired</td>
<td>married</td>
<td>professional.course</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>cellular</td>
<td>nov</td>
<td>...</td>
<td>3</td>
<td>999</td>
<td>1</td>
<td>failure</td>
<td>-1.1</td>
<td>94.767</td>
<td>-50.8</td>
<td>1.028</td>
<td>4963.6</td>
<td>no</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>41186</td>
<td>44</td>
<td>technician</td>
<td>married</td>
<td>professional.course</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>cellular</td>
<td>nov</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>-1.1</td>
<td>94.767</td>
<td>-50.8</td>
<td>1.028</td>
<td>4963.6</td>
<td>yes</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>41185</td>
<td>56</td>
<td>retired</td>
<td>married</td>
<td>university.degree</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>cellular</td>
<td>nov</td>
<td>...</td>
<td>2</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>-1.1</td>
<td>94.767</td>
<td>-50.8</td>
<td>1.028</td>
<td>4963.6</td>
<td>no</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>41184</td>
<td>46</td>
<td>blue-collar</td>
<td>married</td>
<td>professional.course</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>cellular</td>
<td>nov</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>-1.1</td>
<td>94.767</td>
<td>-50.8</td>
<td>1.028</td>
<td>4963.6</td>
<td>no</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>41183</td>
<td>73</td>
<td>retired</td>
<td>married</td>
<td>professional.course</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>cellular</td>
<td>nov</td>
<td>...</td>
<td>1</td>
<td>999</td>
<td>0</td>
<td>nonexistent</td>
<td>-1.1</td>
<td>94.767</td>
<td>-50.8</td>
<td>1.028</td>
<td>4963.6</td>
<td>yes</td>
</tr>
</tbody>
</table>

<p>5 rows × 22 columns</p>
</div>
</div>
</div>
<div id="772c8168" class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 저장한 테이블 삭제</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span><span class="st">"""DROP TABLE MY_TABLE_ORDERED;"""</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>conn.execute(q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;sqlite3.Cursor at 0x1eb6a498cc0&gt;</code></pre>
</div>
</div>
</section>
<section id="결과를-테이블로-저장하기-실습" class="level2">
<h2 class="anchored" data-anchor-id="결과를-테이블로-저장하기-실습">결과를 테이블로 저장하기 실습</h2>
<div id="533c0af9" class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 테이블 저장</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span><span class="st">"""CREATE TABLE question6 AS</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="st">    *</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="st">FROM my_table</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE pdays != 999</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY pdays desc</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 100;"""</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>conn.execute(q)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 저장한 테이블 확인</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>q2 <span class="op">=</span> <span class="st">"""SELECT * FROM question6"""</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>result1 <span class="op">=</span> pd.read_sql_query(q2, conn)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>result1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">idx</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">job</th>
<th data-quarto-table-cell-role="th">marital</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">is_default</th>
<th data-quarto-table-cell-role="th">housing</th>
<th data-quarto-table-cell-role="th">loan</th>
<th data-quarto-table-cell-role="th">contact</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">campaign</th>
<th data-quarto-table-cell-role="th">pdays</th>
<th data-quarto-table-cell-role="th">previous</th>
<th data-quarto-table-cell-role="th">poutcome</th>
<th data-quarto-table-cell-role="th">emp_var_rate</th>
<th data-quarto-table-cell-role="th">cons_price_idx</th>
<th data-quarto-table-cell-role="th">cons_conf_idx</th>
<th data-quarto-table-cell-role="th">euribor3m</th>
<th data-quarto-table-cell-role="th">nr_employed</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>40874</td>
<td>41</td>
<td>technician</td>
<td>married</td>
<td>professional.course</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>cellular</td>
<td>oct</td>
<td>...</td>
<td>2</td>
<td>27</td>
<td>1</td>
<td>success</td>
<td>-1.1</td>
<td>94.601</td>
<td>-49.5</td>
<td>0.959</td>
<td>4963.6</td>
<td>yes</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>40243</td>
<td>24</td>
<td>technician</td>
<td>married</td>
<td>professional.course</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>cellular</td>
<td>jul</td>
<td>...</td>
<td>4</td>
<td>26</td>
<td>1</td>
<td>success</td>
<td>-1.7</td>
<td>94.215</td>
<td>-40.3</td>
<td>0.885</td>
<td>4991.6</td>
<td>yes</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>40234</td>
<td>60</td>
<td>admin.</td>
<td>married</td>
<td>basic.9y</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>cellular</td>
<td>jul</td>
<td>...</td>
<td>2</td>
<td>25</td>
<td>2</td>
<td>failure</td>
<td>-1.7</td>
<td>94.215</td>
<td>-40.3</td>
<td>0.884</td>
<td>4991.6</td>
<td>yes</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>39883</td>
<td>28</td>
<td>management</td>
<td>single</td>
<td>university.degree</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>cellular</td>
<td>jun</td>
<td>...</td>
<td>1</td>
<td>22</td>
<td>1</td>
<td>success</td>
<td>-1.7</td>
<td>94.055</td>
<td>-39.8</td>
<td>0.729</td>
<td>4991.6</td>
<td>yes</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>40489</td>
<td>30</td>
<td>admin.</td>
<td>single</td>
<td>high.school</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>telephone</td>
<td>aug</td>
<td>...</td>
<td>1</td>
<td>22</td>
<td>1</td>
<td>success</td>
<td>-1.7</td>
<td>94.027</td>
<td>-38.3</td>
<td>0.899</td>
<td>4991.6</td>
<td>no</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">95</td>
<td>39157</td>
<td>38</td>
<td>blue-collar</td>
<td>single</td>
<td>high.school</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>cellular</td>
<td>mar</td>
<td>...</td>
<td>1</td>
<td>13</td>
<td>2</td>
<td>failure</td>
<td>-1.8</td>
<td>93.369</td>
<td>-34.8</td>
<td>0.655</td>
<td>5008.7</td>
<td>yes</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">96</td>
<td>39243</td>
<td>39</td>
<td>admin.</td>
<td>divorced</td>
<td>university.degree</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>cellular</td>
<td>mar</td>
<td>...</td>
<td>1</td>
<td>13</td>
<td>1</td>
<td>success</td>
<td>-1.8</td>
<td>93.369</td>
<td>-34.8</td>
<td>0.650</td>
<td>5008.7</td>
<td>no</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">97</td>
<td>39315</td>
<td>29</td>
<td>technician</td>
<td>single</td>
<td>professional.course</td>
<td>no</td>
<td>yes</td>
<td>yes</td>
<td>cellular</td>
<td>mar</td>
<td>...</td>
<td>2</td>
<td>13</td>
<td>1</td>
<td>success</td>
<td>-1.8</td>
<td>93.369</td>
<td>-34.8</td>
<td>0.643</td>
<td>5008.7</td>
<td>yes</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">98</td>
<td>39556</td>
<td>38</td>
<td>admin.</td>
<td>single</td>
<td>high.school</td>
<td>no</td>
<td>yes</td>
<td>yes</td>
<td>cellular</td>
<td>apr</td>
<td>...</td>
<td>1</td>
<td>13</td>
<td>1</td>
<td>success</td>
<td>-1.8</td>
<td>93.749</td>
<td>-34.6</td>
<td>0.659</td>
<td>5008.7</td>
<td>yes</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">99</td>
<td>39651</td>
<td>30</td>
<td>admin.</td>
<td>single</td>
<td>high.school</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>cellular</td>
<td>may</td>
<td>...</td>
<td>1</td>
<td>13</td>
<td>1</td>
<td>success</td>
<td>-1.8</td>
<td>93.876</td>
<td>-40.0</td>
<td>0.682</td>
<td>5008.7</td>
<td>no</td>
</tr>
</tbody>
</table>

<p>100 rows × 22 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="과제" class="level1">
<h1>과제</h1>
<section id="프로그래머스-과제-풀기" class="level2">
<h2 class="anchored" data-anchor-id="프로그래머스-과제-풀기">프로그래머스 과제 풀기</h2>
<ul>
<li>저작권 관련 <a href="https://docs.channel.io/grepp_qna/ko/articles/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%8A%A4%EC%9D%98-%EB%AC%B8%EC%A0%9C%EB%A5%BC-%EC%99%B8%EB%B6%80%EC%97%90-%EA%B2%8C%EC%8B%9C%ED%95%A0-%EC%88%98-%EC%9E%88%EB%82%98%EC%9A%94-3f8537c9">프로그래머스 링크</a></li>
</ul>
<pre><code>  코딩 테스트 연습 문제
  코딩테스트 연습에 공개된 문제는 (주)그렙이 저작권을 가지고 있습니다.
  (지문 하단에 별도 저작권 표시 문제 제외)
  코딩테스트 연습 문제의 지문, 테스트케이스, 풀이 등과 같은 정보는 비상업적, 비영리적 용도로 게시할 수 있습니다.
  다만 문제의 지문, 풀이 등과 같은 정보를 단순히 게시하는 것을 넘어, 
  이를 바탕으로 문제를 풀고 채점이 가능하도록 하는 등의 방식으로 활용하는 것은 제한됩니다.

  ※ 2020 KAKAO BLIND RECRUITMENT, Summer/Winter Coding 등의 문제는 기업 코딩 테스트에 나온 문제이나, 
  코딩테스트 연습에 공개된 문제이기 때문에 마찬가지로 비상업적, 비영리적 용도로 게시할 수 있습니다.

  (2021. 01. 08 업데이트)</code></pre>
<ul>
<li><p>https://school.programmers.co.kr/learn/courses/30/lessons/59040 <img src="index_files/figure-html/0f388070-1-Note_week1_1.jpg" class="img-fluid" alt="Note_week1_1.jpg"> <code>bahzo     SELECT ANIMAL_TYPE, COUNT(*)     FROM ANIMAL_INS     GROUP BY ANIMAL_TYPE     ORDER BY ANIMAL_TYPE</code></p></li>
<li><p>https://school.programmers.co.kr/learn/courses/30/lessons/133024<br> <img src="index_files/figure-html/efaef9b8-1-Note_week1_2.jpg" class="img-fluid" alt="Note_week1_2.jpg"> <code>bahzo     SELECT FLAVOR     FROM FIRST_HALF      ORDER BY TOTAL_ORDER DESC, SHIPMENT_ID</code></p></li>
<li><p>https://school.programmers.co.kr/learn/courses/30/lessons/59405<br> <img src="index_files/figure-html/3c71f171-1-Note_week1_3.jpg" class="img-fluid" alt="Note_week1_3.jpg"> <code>bahzo     SELECT NAME     FROM ANIMAL_INS      ORDER BY DATETIME     LIMIT 1</code></p></li>
<li><p>https://school.programmers.co.kr/learn/courses/30/lessons/131697<br> <img src="index_files/figure-html/dad5cd0f-1-Note_week1_4.jpg" class="img-fluid" alt="Note_week1_4.jpg"> <code>bahzo     SELECT MAX(PRICE) AS MAX_PRICE     FROM PRODUCT</code></p></li>
</ul>


</section>
</section>

<p><br><strong>Copyright © 2024 Kibok Park All rights reserved.</strong><br></p></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/kr9268\.github\.io\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      if (authorPrefersDark) {
          [baseTheme, altTheme] = [altTheme, baseTheme];
      }
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "kr9268/giscus_for_blog";
    script.dataset.repoId = "R_kgDOL0Sthw";
    script.dataset.category = "General";
    script.dataset.categoryId = "DIC_kwDOL0Sth84Ce_5h";
    script.dataset.mapping = "title";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "top";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script>
</div> <!-- /content -->
<script>
    const baseFontSize = parseFloat(getComputedStyle(document.documentElement).fontSize);
    const watermark = new XWatermark.XWatermark();
    watermark.init("Kibok Park", {
      parentSelector: "body",
      prevent: true,
      observer: true,
      mode: "normal",
      font: "system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', 'Noto Sans', 'Liberation Sans', Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'",
      fontsize: baseFontSize * 1.000000,
      angle: -15.000000,
      color: "#000000",
      alpha: 0.100000,
      cols: 10,
      rows: 50,
      xSpace: baseFontSize * 4.000000,
      ySpace: baseFontSize * 4.000000,
      zIndex: -1
    });
    </script>




</body></html>