<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.41">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kibok Park">
<meta name="dcterms.date" content="2025-01-07">

<title>[DA스터디/3주차/과제] EDA 및 전처리 – Blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../profile.jpg" rel="icon" type="image/jpeg">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-48ffa3e5b9d089919c6712c39e5b00f2.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-71390cc8b9bae10139428574d3aab2c6.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-c37a40b267d3139d93432c283e34c257.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-bdc1e6ac3e28299057f0fc16b5bab4ae.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/watermark-1.0.11/watermark.min.js"></script>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-LPL499WQBH"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-LPL499WQBH', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index_dashboards.html"> 
<span class="menu-text">Dashboards</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../index_miniprojects.html"> 
<span class="menu-text">Mini Projects</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/KR9268"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/%EA%B8%B0%EB%B3%B5-%EB%B0%95-573a68268/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">[DA스터디/3주차/과제] EDA 및 전처리</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Python</div>
                <div class="quarto-category">EDA</div>
                <div class="quarto-category">Preprocessing</div>
                <div class="quarto-category">202412Study_DataAnalysis</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Kibok Park </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 7, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#개요" id="toc-개요" class="nav-link active" data-scroll-target="#개요">개요</a></li>
  <li><a href="#주차-과제" id="toc-주차-과제" class="nav-link" data-scroll-target="#주차-과제">3주차 과제</a>
  <ul class="collapse">
  <li><a href="#과제-설명" id="toc-과제-설명" class="nav-link" data-scroll-target="#과제-설명">과제 설명</a></li>
  <li><a href="#변수-설명-확인하기" id="toc-변수-설명-확인하기" class="nav-link" data-scroll-target="#변수-설명-확인하기">변수 설명 확인하기</a></li>
  <li><a href="#데이터-읽고-기초적인-정보-확인하기" id="toc-데이터-읽고-기초적인-정보-확인하기" class="nav-link" data-scroll-target="#데이터-읽고-기초적인-정보-확인하기">데이터 읽고 기초적인 정보 확인하기</a></li>
  <li><a href="#eda-수치형-변수-기초-통계량-확인" id="toc-eda-수치형-변수-기초-통계량-확인" class="nav-link" data-scroll-target="#eda-수치형-변수-기초-통계량-확인">[EDA] 수치형 변수 : 기초 통계량 확인</a>
  <ul class="collapse">
  <li><a href="#왜도" id="toc-왜도" class="nav-link" data-scroll-target="#왜도">왜도</a></li>
  <li><a href="#첨도" id="toc-첨도" class="nav-link" data-scroll-target="#첨도">첨도</a></li>
  <li><a href="#히스토그램-시각화" id="toc-히스토그램-시각화" class="nav-link" data-scroll-target="#히스토그램-시각화">히스토그램 시각화</a></li>
  <li><a href="#이상치" id="toc-이상치" class="nav-link" data-scroll-target="#이상치">이상치</a></li>
  </ul></li>
  <li><a href="#eda-범주형-변수-시각화-확인" id="toc-eda-범주형-변수-시각화-확인" class="nav-link" data-scroll-target="#eda-범주형-변수-시각화-확인">[EDA] 범주형 변수 : 시각화 확인</a></li>
  <li><a href="#y값-불균형도-확인" id="toc-y값-불균형도-확인" class="nav-link" data-scroll-target="#y값-불균형도-확인">y값 불균형도 확인</a></li>
  <li><a href="#전처리-결측이상치-처리-및-표준화정규화-등" id="toc-전처리-결측이상치-처리-및-표준화정규화-등" class="nav-link" data-scroll-target="#전처리-결측이상치-처리-및-표준화정규화-등">[전처리] 결측/이상치 처리 및 표준화/정규화 등</a>
  <ul class="collapse">
  <li><a href="#결측치-대체-공통" id="toc-결측치-대체-공통" class="nav-link" data-scroll-target="#결측치-대체-공통">결측치 대체 (공통)</a></li>
  <li><a href="#수치형-변수-전처리" id="toc-수치형-변수-전처리" class="nav-link" data-scroll-target="#수치형-변수-전처리">수치형 변수 전처리</a></li>
  <li><a href="#범주형-변수-전처리" id="toc-범주형-변수-전처리" class="nav-link" data-scroll-target="#범주형-변수-전처리">범주형 변수 전처리</a></li>
  </ul></li>
  <li><a href="#전처리된-데이터-저장" id="toc-전처리된-데이터-저장" class="nav-link" data-scroll-target="#전처리된-데이터-저장">전처리된 데이터 저장</a></li>
  <li><a href="#향후-test데이터셋에-쓰기위한-전처리-코드-정리" id="toc-향후-test데이터셋에-쓰기위한-전처리-코드-정리" class="nav-link" data-scroll-target="#향후-test데이터셋에-쓰기위한-전처리-코드-정리">향후 Test데이터셋에 쓰기위한 전처리 코드 정리</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>금융권 데이터를 활용한 분석 스터디 - 3주차</p>
<section id="개요" class="level1">
<h1>개요</h1>
<ul>
<li>아래의 목적/이유로 참가한 스터디에 대한 기록
<ul>
<li>SQLD취득 후 장기 미사용 &amp; GPT를 통한 SQL사용 등으로 많이 잊은 SQL을 복기</li>
<li>기존에 사용해 본 Optuna가 아닌 Autogluon이 커리큘럼에 있어 익혀보고자 함</li>
<li>기존에 관심있던 XAI(설명가능한 AI)를 익히고자 함</li>
</ul></li>
<li>3주차 과제 진행
<ul>
<li>지정과제에 대한 EDA, 전처리, 데이터마트(CSV파일)만들기
<ul>
<li>데이터마트는 sqlite3으로 DB형태로 만듦</li>
</ul></li>
<li>변수에 대한 설명 확인</li>
<li>수치/명목형 변수로 나누어 EDA 및 전처리 진행</li>
<li>향후 Test데이터 등에도 사용하기 위해 전처리 함수로 정리</li>
</ul></li>
</ul>
</section>
<section id="주차-과제" class="level1">
<h1>3주차 과제</h1>
<section id="과제-설명" class="level2">
<h2 class="anchored" data-anchor-id="과제-설명">과제 설명</h2>
<ul>
<li>과제 : 월간 데이콘 신용카드 사용자 연체 예측 AI 경진대회
<ul>
<li>https://dacon.io/competitions/official/235713/overview/description</li>
</ul></li>
<li>EDA, 전처리, 데이터마트(CSV파일 등)만들고, 그 과정이 담긴 ipynb제출</li>
</ul>
</section>
<section id="변수-설명-확인하기" class="level2">
<h2 class="anchored" data-anchor-id="변수-설명-확인하기">변수 설명 확인하기</h2>
<ul>
<li><a href="https://www.dacon.io/competitions/official/235713/talkboard/402821/?_gl=1%2a1qi5pgu%2a_gcl_au%2aMTY1MzAzMjUwMi4xNzMyNDU0MDQ2%2a_ga%2aNTU2Mjg0MDUwLjE3MjQxMzkwODk.%2a_ga_35PZM515YN%2aMTczNjI1MzI0NS4xOC4xLjE3MzYyNTMyNjQuNDEuMC4w">원본링크</a></li>
<li>변수별 설명
<ul>
<li>gender: 성별</li>
<li>car: 차량 소유 여부</li>
<li>reality: 부동산 소유 여부</li>
<li>child_num: 자녀 수</li>
<li>income_total: 연간 소득</li>
<li>income_type: 소득 분류
<ul>
<li>[‘Commercial associate’, ‘Working’, ‘State servant’, ‘Pensioner’, ‘Student’]</li>
</ul></li>
<li>edu_type: 교육 수준
<ul>
<li>[‘Higher education’ ,‘Secondary / secondary special’, ‘Incomplete higher’, ‘Lower secondary’, ‘Academic degree’]</li>
</ul></li>
<li>family_type: 결혼 여부
<ul>
<li>[‘Married’, ‘Civil marriage’, ‘Separated’, ‘Single / not married’, ‘Widow’]</li>
</ul></li>
<li>house_type: 생활 방식
<ul>
<li>[‘Municipal apartment’, ‘House / apartment’, ‘With parents’, ‘Co-op apartment’, ‘Rented apartment’, ‘Office apartment’]</li>
</ul></li>
<li>DAYS_BIRTH: 출생일
<ul>
<li>데이터 수집 당시 (0)부터 역으로 셈, 즉, -1은 데이터 수집일 하루 전에 태어났음을 의미</li>
</ul></li>
<li>DAYS_EMPLOYED: 업무 시작일
<ul>
<li>데이터 수집 당시 (0)부터 역으로 셈, 즉, -1은 데이터 수집일 하루 전부터 일을 시작함을 의미</li>
<li>양수 값은 고용되지 않은 상태를 의미함</li>
</ul></li>
<li>FLAG_MOBIL: 핸드폰 소유 여부</li>
<li>work_phone: 업무용 전화 소유 여부</li>
<li>phone: 전화 소유 여부</li>
<li>email: 이메일 소유 여부</li>
<li>occyp_type: 직업 유형<br>
</li>
<li>family_size: 가족 규모</li>
<li>begin_month: 신용카드 발급 월
<ul>
<li>데이터 수집 당시 (0)부터 역으로 셈, 즉, -1은 데이터 수집일 한 달 전에 신용카드를 발급함을 의미</li>
</ul></li>
<li><strong>credit</strong>: 사용자의 신용카드 대금 연체를 기준으로 한 신용도
<ul>
<li>낮을 수록 높은 신용의 신용카드 사용자를 의미함</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="데이터-읽고-기초적인-정보-확인하기" class="level2">
<h2 class="anchored" data-anchor-id="데이터-읽고-기초적인-정보-확인하기">데이터 읽고 기초적인 정보 확인하기</h2>
<ul>
<li>데이터 로딩하기</li>
</ul>
<div id="58b7fd70" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pkb_sqlite3 <span class="im">import</span> DB_sqlite3</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>db_controller <span class="op">=</span> DB_sqlite3(<span class="st">'Dacon_creditcard_overdue.db'</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>df_train <span class="op">=</span> db_controller.search_db_show_df(<span class="st">'SELECT * FROM train'</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> db_controller.search_db_show_df(<span class="st">'SELECT * FROM test'</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>df_sample_submission <span class="op">=</span> db_controller.search_db_show_df(<span class="st">'SELECT * FROM sample_submission'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="acdebd11" class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 형태(잘 로딩되었는지 확인)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"""</span><span class="sc">{</span>df_train<span class="sc">.</span>shape<span class="sc">}</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>df_test<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(26457, 20)
(10000, 19)</code></pre>
</div>
</div>
<ul>
<li>describe()를 활용해 정보 확인하기
<ul>
<li>count값을 보면, occyp_type에만 Null(결측치)값이 있음
<ul>
<li>occyp_type : 결측치가 8천여개로 Drop이 아닌 대체 필요</li>
</ul></li>
<li>Unique값이 있는 컬럼들은 범주형 변수로 추측</li>
<li>count/unique/freq값을 보면, 데이터가 편향된 컬럼 있음
<ul>
<li>예를 들어, gender는 26,457 중 17,697로 약 65%로 F값이 많음(top)</li>
</ul></li>
<li>DAYS_BIRTH나 begin_month는 음수 변수로 로그변환 제외</li>
</ul></li>
</ul>
<div id="32691f73" class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df_train.describe(include<span class="op">=</span><span class="st">'all'</span>).transpose().reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">unique</th>
<th data-quarto-table-cell-role="th">top</th>
<th data-quarto-table-cell-role="th">freq</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>index</td>
<td>26457.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>13228.0</td>
<td>7637.622372</td>
<td>0.0</td>
<td>6614.0</td>
<td>13228.0</td>
<td>19842.0</td>
<td>26456.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>gender</td>
<td>26457</td>
<td>2</td>
<td>F</td>
<td>17697</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>car</td>
<td>26457</td>
<td>2</td>
<td>N</td>
<td>16410</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>reality</td>
<td>26457</td>
<td>2</td>
<td>Y</td>
<td>17830</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>child_num</td>
<td>26457.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.428658</td>
<td>0.747326</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>19.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>income_total</td>
<td>26457.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>187306.524493</td>
<td>101878.367995</td>
<td>27000.0</td>
<td>121500.0</td>
<td>157500.0</td>
<td>225000.0</td>
<td>1575000.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>income_type</td>
<td>26457</td>
<td>5</td>
<td>Working</td>
<td>13645</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>edu_type</td>
<td>26457</td>
<td>5</td>
<td>Secondary / secondary special</td>
<td>17995</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>family_type</td>
<td>26457</td>
<td>5</td>
<td>Married</td>
<td>18196</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>house_type</td>
<td>26457</td>
<td>6</td>
<td>House / apartment</td>
<td>23653</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>DAYS_BIRTH</td>
<td>26457.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>-15958.053899</td>
<td>4201.589022</td>
<td>-25152.0</td>
<td>-19431.0</td>
<td>-15547.0</td>
<td>-12446.0</td>
<td>-7705.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>DAYS_EMPLOYED</td>
<td>26457.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>59068.750728</td>
<td>137475.427503</td>
<td>-15713.0</td>
<td>-3153.0</td>
<td>-1539.0</td>
<td>-407.0</td>
<td>365243.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>FLAG_MOBIL</td>
<td>26457.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>work_phone</td>
<td>26457.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.224742</td>
<td>0.41742</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>phone</td>
<td>26457.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.294251</td>
<td>0.455714</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>email</td>
<td>26457.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.09128</td>
<td>0.288013</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>occyp_type</td>
<td>18286</td>
<td>18</td>
<td>Laborers</td>
<td>4512</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>family_size</td>
<td>26457.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2.196848</td>
<td>0.916717</td>
<td>1.0</td>
<td>2.0</td>
<td>2.0</td>
<td>3.0</td>
<td>20.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>begin_month</td>
<td>26457.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>-26.123294</td>
<td>16.55955</td>
<td>-60.0</td>
<td>-39.0</td>
<td>-24.0</td>
<td>-12.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>credit</td>
<td>26457.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.51956</td>
<td>0.702283</td>
<td>0.0</td>
<td>1.0</td>
<td>2.0</td>
<td>2.0</td>
<td>2.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="018cdd7a" class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 나누기</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> df_train[<span class="st">'credit'</span>].copy()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>x_train <span class="op">=</span> df_train.drop(<span class="st">'credit'</span>,axis<span class="op">=</span><span class="dv">1</span>).copy()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"""</span><span class="sc">{</span>x_train<span class="sc">.</span>shape<span class="sc">}</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>y_train<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(26457, 19)
(26457,)</code></pre>
</div>
</div>
</section>
<section id="eda-수치형-변수-기초-통계량-확인" class="level2">
<h2 class="anchored" data-anchor-id="eda-수치형-변수-기초-통계량-확인">[EDA] 수치형 변수 : 기초 통계량 확인</h2>
<section id="왜도" class="level3">
<h3 class="anchored" data-anchor-id="왜도">왜도</h3>
<ul>
<li>왜도를 구해 표로 정리했으며, 시각화를 통해 추가 확인하기로 함</li>
</ul>
<div id="63333ced" class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x_numerical <span class="op">=</span> x_train.select_dtypes(include<span class="op">=</span>[<span class="st">'float64'</span>, <span class="st">'int64'</span>])</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>numeric_skew <span class="op">=</span> x_numerical.skew().reset_index() <span class="co"># skew() 함수로 왜도 구하기</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>numeric_skew</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>index</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>child_num</td>
<td>2.852376</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>income_total</td>
<td>2.659271</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>DAYS_BIRTH</td>
<td>-0.185986</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>DAYS_EMPLOYED</td>
<td>1.777596</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>FLAG_MOBIL</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>work_phone</td>
<td>1.318953</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>phone</td>
<td>0.903042</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>email</td>
<td>2.838422</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>family_size</td>
<td>1.431759</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>begin_month</td>
<td>-0.290050</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="첨도" class="level3">
<h3 class="anchored" data-anchor-id="첨도">첨도</h3>
<ul>
<li>첨도를 구해 표로 정리했으며, 시각화를 통해 추가 확인하기로 함</li>
</ul>
<div id="16863eff" class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>numeric_kurt <span class="op">=</span> x_numerical.kurtosis().reset_index()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>numeric_kurt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>index</td>
<td>-1.200000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>child_num</td>
<td>29.172394</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>income_total</td>
<td>16.359621</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>DAYS_BIRTH</td>
<td>-1.046188</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>DAYS_EMPLOYED</td>
<td>1.161734</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>FLAG_MOBIL</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>work_phone</td>
<td>-0.260383</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>phone</td>
<td>-1.184604</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>email</td>
<td>6.057100</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>family_size</td>
<td>10.578051</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>begin_month</td>
<td>-1.041906</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="히스토그램-시각화" class="level3">
<h3 class="anchored" data-anchor-id="히스토그램-시각화">히스토그램 시각화</h3>
<ul>
<li>히스토그램으로 시각화했고, 일부 분포의 판단이 힘든 값에 대해서는 재조정하여 시각화</li>
<li>아래 변수들은 유무를 0,1로만 표현한 변수로, 추가적인 시각화에서 제외함
<ul>
<li>work_phone, phone, email</li>
</ul></li>
</ul>
<div id="1580340c" class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 설정: 가로 그래프 개수</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>num_vars <span class="op">=</span> <span class="bu">len</span>(x_numerical.columns)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> math.ceil(num_vars <span class="op">/</span> cols)  <span class="co"># 필요한 행(row) 수 계산</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 서브플롯 생성</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(rows, cols, figsize<span class="op">=</span>(<span class="dv">15</span>, rows <span class="op">*</span> <span class="dv">3</span>))  <span class="co"># 전체 figure 크기 조정</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()  <span class="co"># 2D 배열을 1D로 변환하여 인덱싱 편리하게</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 그래프 그리기</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var_idx, var_nm <span class="kw">in</span> <span class="bu">enumerate</span>(x_numerical.columns):</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> axes[var_idx]</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    ax.hist(x_numerical.iloc[:, var_idx], bins<span class="op">=</span><span class="st">'auto'</span>, color<span class="op">=</span><span class="st">'skyblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'</span><span class="sc">{</span>var_nm<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 빈 서브플롯 숨기기</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_vars, <span class="bu">len</span>(axes)):</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    axes[i].axis(<span class="st">'off'</span>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>재조정하여 시각화한 내용을 기반으로, 아래와 같이 결정함
<ul>
<li>뚜렷하게 쏠림(높은 왜도)을 보이는 ’DAYS_EMPLOYED’에 대해 로그변환 진행</li>
<li>첨도가 3보다 낮은, ’DAYS_BIRTH’와 ’begin_month에 대해 표준화 진행</li>
</ul></li>
</ul>
<div id="333a9550" class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 설정: 가로 그래프 개수와 세로 그래프 개수</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 서브플롯 생성</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(rows, cols, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">10</span>))  <span class="co"># 전체 figure 크기 조정</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()  <span class="co"># 2D 배열을 1D로 변환하여 인덱싱 편리하게</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 그래프 그리기</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>plot_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var_idx, var_nm <span class="kw">in</span> <span class="bu">enumerate</span>(x_numerical.columns):</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> var_nm <span class="kw">in</span> [<span class="st">'child_num'</span>, <span class="st">'income_total'</span>, <span class="st">'DAYS_EMPLOYED'</span>, <span class="st">'family_size'</span>]:</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> axes[plot_count]</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> x_numerical.iloc[:, var_idx]</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 이상치 제외를 위한 사분위수 계산</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>        Q1 <span class="op">=</span> np.percentile(data, <span class="dv">25</span>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        Q3 <span class="op">=</span> np.percentile(data, <span class="dv">75</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>        IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>        lower_bound <span class="op">=</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>        upper_bound <span class="op">=</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 이상치를 제외한 데이터</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>        filtered_data <span class="op">=</span> data[(data <span class="op">&gt;=</span> lower_bound) <span class="op">&amp;</span> (data <span class="op">&lt;=</span> upper_bound)]</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>        ax.hist(filtered_data, bins<span class="op">=</span><span class="st">'auto'</span>, color<span class="op">=</span><span class="st">'skyblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="ss">f'</span><span class="sc">{</span>var_nm<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>        ax.set_xlim(filtered_data.<span class="bu">min</span>(), filtered_data.<span class="bu">max</span>())  <span class="co"># x축의 최소값과 최대값 설정</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>        plot_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 빈 서브플롯 숨기기</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(plot_count, <span class="bu">len</span>(axes)):</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>    axes[i].axis(<span class="st">'off'</span>)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="이상치" class="level3">
<h3 class="anchored" data-anchor-id="이상치">이상치</h3>
<ul>
<li>전체 26,457 row중, 일부 이상치가 많아보이는 컬럼 있음
<ul>
<li>대상 : child_num, income_total, DAYS_EMPLOYED, work_phone, email, family_size</li>
</ul></li>
<li>변수 설명 내용 중 ’소유 여부’인 변수(work_phone, email)를 확인 결과, 0 &amp; 1만 있어 제외
<ul>
<li>남은 대상 : child_num, income_total, DAYS_EMPLOYED, family_size</li>
</ul></li>
<li>Box plot을 그려보았으나, 시각화만으로는 판단이 어려워 추가적으로 확인하기로 함</li>
</ul>
<div id="20b7a3ed" class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 수업시간에 사용한 IQR기준 이상치함수 활용</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> detect_outliers_fast(df):</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate IQR without NaN values</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    Q1 <span class="op">=</span> df.quantile(<span class="fl">0.25</span>, interpolation<span class="op">=</span><span class="st">'midpoint'</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    Q3 <span class="op">=</span> df.quantile(<span class="fl">0.75</span>, interpolation<span class="op">=</span><span class="st">'midpoint'</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    lower_bound <span class="op">=</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    upper_bound <span class="op">=</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vectorized outlier detection with NaN handling</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    outlier_flags <span class="op">=</span> df.<span class="bu">apply</span>(</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> col: <span class="op">~</span>col.between(lower_bound[col.name], upper_bound[col.name]) <span class="op">&amp;</span> col.notna()</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> outlier_flags</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 구한 이상치가 0인 경우를 제외하고 표기</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>x_outliers <span class="op">=</span> detect_outliers_fast(x_numerical)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>outliers_to_see <span class="op">=</span> x_outliers.<span class="bu">sum</span>()[x_outliers.<span class="bu">sum</span>()<span class="op">&gt;</span><span class="dv">0</span>]</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>outliers_to_see</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>child_num         369
income_total     1129
DAYS_EMPLOYED    5726
work_phone       5946
email            2415
family_size       350
dtype: int64</code></pre>
</div>
</div>
<div id="71ea2ee8" class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 설정: 가로 그래프 개수</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>num_vars <span class="op">=</span> <span class="bu">len</span>(outliers_to_see.index)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> math.ceil(num_vars <span class="op">/</span> cols)  <span class="co"># 필요한 행(row) 수 계산</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 서브플롯 생성</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(rows, cols, figsize<span class="op">=</span>(<span class="dv">18</span>, rows <span class="op">*</span> <span class="dv">4</span>))  <span class="co"># 전체 figure 크기 조정</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()  <span class="co"># 2D 배열을 1D로 변환하여 인덱싱 편리하게</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 그래프 그리기</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var_idx, var_nm <span class="kw">in</span> <span class="bu">enumerate</span>(outliers_to_see.index):</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> axes[var_idx]</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    sns.boxplot(x<span class="op">=</span>x_numerical[var_nm], ax<span class="op">=</span>ax, color<span class="op">=</span><span class="st">'lightblue'</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'</span><span class="sc">{</span>var_nm<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(var_nm)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 빈 서브플롯 숨기기</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_vars, <span class="bu">len</span>(axes)):</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    axes[i].axis(<span class="st">'off'</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>각 변수에 대해 확인한 결과 아래와 같으며, 제외할지 등에 대한 판단이 어려움
<ul>
<li>child_num : 자녀가 19명인 경우는 확실히 이상치라는 느낌이지만, 3명의 경우는 이상치로 보기 어려워 보임</li>
<li>family_size : 가족구성원이 5명인 경우도 이상치라고 해야할지 모호함</li>
<li>DAYS_EMPLOYED는 추가로 확인해보니 미취업여부를 나타내기 위한 양수인 365243 다음으로 큰 수가 -17.
<ul>
<li>불필요하게 큰 숫자로, 1로 대체</li>
</ul></li>
</ul></li>
<li>각 변수의 이상치에 대해, 값 Drop이 아닌 변환 진행</li>
</ul>
<div id="d95d9ab2" class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> summarize_unique_outliers(x_numerical, x_outliers):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 각 컬럼별로 이상치의 고유값을 추출하여 딕셔너리로 저장</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    unique_outliers <span class="op">=</span> x_numerical[x_outliers].<span class="bu">apply</span>(<span class="kw">lambda</span> col: col.unique().tolist())</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 딕셔너리 형태로 반환</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    unique_outliers_dict <span class="op">=</span> unique_outliers.to_dict()</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> unique_outliers_dict</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>unique_outliers <span class="op">=</span> summarize_unique_outliers(x_numerical, x_outliers)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"""* 이상치로 판명된 Unique값 현황</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="ss">child_num : </span><span class="sc">{</span>unique_outliers[<span class="st">'child_num'</span>]<span class="sc">}</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="ss">income_total : </span><span class="sc">{</span>unique_outliers[<span class="st">'income_total'</span>]<span class="sc">}</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="ss">DAYS_EMPLOYED : </span><span class="sc">{</span>unique_outliers[<span class="st">'DAYS_EMPLOYED'</span>]<span class="sc">}</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="ss">family_size : </span><span class="sc">{</span>unique_outliers[<span class="st">'family_size'</span>]<span class="sc">}</span><span class="ss">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>* 이상치로 판명된 Unique값 현황
child_num : [nan, 3.0, 4.0, 5.0, 14.0, 19.0, 7.0]
income_total : [nan, 450000.0, 405000.0, 585000.0, 495000.0, 382500.0, 387000.0, 540000.0, 459000.0, 720000.0, 427500.0, 562500.0, 630000.0, 463500.0, 432000.0, 787500.0, 900000.0, 391500.0, 716323.5, 675000.0, 990000.0, 612000.0, 1575000.0, 652500.0, 945000.0, 418500.0, 634500.0, 423000.0, 742500.0, 517500.0, 560250.0, 810000.0, 445500.0, 616500.0, 765000.0, 396000.0, 472500.0, 594000.0, 468000.0, 661500.0, 441000.0, 494100.0, 531000.0, 607500.0, 414000.0, 697500.0, 1125000.0, 1350000.0]
DAYS_EMPLOYED : [nan, 365243.0, -9391.0, -9404.0, -12332.0, -8491.0, -9988.0, -11940.0, -7400.0, -10993.0, -9870.0, -8091.0, -9957.0, -7310.0, -11062.0, -7679.0, -7514.0, -8671.0, -10773.0, -8284.0, -10121.0, -7369.0, -12278.0, -7415.0, -7401.0, -10050.0, -8553.0, -7593.0, -11494.0, -9052.0, -9269.0, -7835.0, -9683.0, -9858.0, -7346.0, -10490.0, -9925.0, -9029.0, -7838.0, -7553.0, -7379.0, -8171.0, -8375.0, -7536.0, -10600.0, -7851.0, -9575.0, -9422.0, -9255.0, -8298.0, -8163.0, -7734.0, -12179.0, -13245.0, -8172.0, -8325.0, -9258.0, -8100.0, -10384.0, -10821.0, -8538.0, -8772.0, -9359.0, -15072.0, -7733.0, -7979.0, -7471.0, -11951.0, -8412.0, -7824.0, -11589.0, -10094.0, -10758.0, -12169.0, -7840.0, -8022.0, -9181.0, -8316.0, -10290.0, -9485.0, -7624.0, -9751.0, -10149.0, -8953.0, -11451.0, -9325.0, -10454.0, -9479.0, -11183.0, -7591.0, -10079.0, -9866.0, -8109.0, -8684.0, -7465.0, -11157.0, -11083.0, -15038.0, -8643.0, -7371.0, -8479.0, -8469.0, -11906.0, -8760.0, -12490.0, -10689.0, -12455.0, -7752.0, -8737.0, -8855.0, -10236.0, -7627.0, -8794.0, -9136.0, -8063.0, -12423.0, -10437.0, -13102.0, -7288.0, -7718.0, -12148.0, -7866.0, -7827.0, -9947.0, -7341.0, -7830.0, -14810.0, -7804.0, -12949.0, -14473.0, -7614.0, -8808.0, -8377.0, -9046.0, -8131.0, -9447.0, -7513.0, -7404.0, -12827.0, -8649.0, -8369.0, -9178.0, -8405.0, -12621.0, -10780.0, -8175.0, -9225.0, -11884.0, -10936.0, -9748.0, -9745.0, -7698.0, -8497.0, -7364.0, -8624.0, -8083.0, -10364.0, -12870.0, -11389.0, -8460.0, -10994.0, -11907.0, -8348.0, -8206.0, -7888.0, -13800.0, -7778.0, -8448.0, -8862.0, -8015.0, -9379.0, -7551.0, -8714.0, -8509.0, -9482.0, -9975.0, -7347.0, -8803.0, -7811.0, -7413.0, -8157.0, -10110.0, -8143.0, -13735.0, -9195.0, -7747.0, -11693.0, -8040.0, -8691.0, -9076.0, -8033.0, -8875.0, -12647.0, -10762.0, -7557.0, -8838.0, -15661.0, -11398.0, -8601.0, -11552.0, -8756.0, -7522.0, -7738.0, -11542.0, -8290.0, -9152.0, -8987.0, -9239.0, -8859.0, -8140.0, -7949.0, -7622.0, -15713.0, -9349.0, -7278.0, -7500.0, -9260.0, -9724.0, -8036.0, -14887.0, -8767.0, -8443.0, -7871.0, -7566.0, -13415.0, -14018.0, -8966.0, -9044.0, -9240.0, -7276.0, -9564.0, -8044.0, -7900.0, -7494.0, -9385.0, -8376.0, -14413.0, -8647.0, -7786.0, -8254.0, -12995.0, -7676.0, -8995.0, -9756.0, -10155.0, -9389.0, -9236.0, -8710.0, -9419.0, -9559.0, -10909.0, -8071.0, -7343.0, -9581.0, -11954.0, -10475.0, -10217.0, -9363.0, -8861.0, -7373.0, -9131.0, -10361.0, -7756.0, -9508.0, -10147.0, -8535.0, -8870.0, -8664.0, -7640.0, -8152.0, -11202.0, -9830.0, -14536.0, -7765.0, -8507.0, -9194.0, -9698.0, -8801.0, -9794.0, -10843.0, -9094.0, -11555.0, -8230.0, -8618.0, -12591.0, -7280.0, -9270.0, -10629.0, -7916.0, -7563.0, -7504.0, -8923.0, -12032.0, -11272.0, -11785.0, -10353.0, -8072.0, -9311.0, -8757.0, -8411.0, -10647.0, -8892.0, -11061.0, -14338.0, -9574.0, -8011.0, -10047.0, -10370.0, -9320.0, -7314.0, -10692.0, -7864.0, -11332.0, -9527.0, -10305.0, -13010.0, -10746.0, -7953.0, -12917.0, -7706.0, -10052.0, -9316.0, -7677.0, -11603.0, -8130.0, -10688.0, -8410.0, -11692.0, -7518.0, -14775.0, -8894.0, -10202.0, -12513.0, -8256.0, -10259.0, -8342.0, -11683.0, -8510.0, -8189.0, -7704.0, -10232.0, -8863.0, -12462.0, -10627.0, -12163.0, -9989.0, -10452.0, -7736.0, -11448.0, -8205.0, -12253.0, -8066.0, -10657.0, -9019.0, -10777.0]
family_size : [nan, 5.0, 6.0, 7.0, 15.0, 20.0, 9.0]</code></pre>
</div>
</div>
</section>
</section>
<section id="eda-범주형-변수-시각화-확인" class="level2">
<h2 class="anchored" data-anchor-id="eda-범주형-변수-시각화-확인">[EDA] 범주형 변수 : 시각화 확인</h2>
<ul>
<li>edu_type(교육 수준)은 순서가 중요한 변수이므로 Label Encoder로 우선순위를 지정하는 것을 고려</li>
<li>이외 변수는 모델의 혼동(상위관계 여부)을 방지하고자 One-hot인코딩 고려
<ul>
<li>대다수의 변수가 2~6개의 unique값을 가져 크게 어려움은 없을 것으로 보임</li>
<li>그러나 occyp_type(직업유형)의 경우는 값이 많은 관계로 좀 더 고민이 필요할 것으로 보임</li>
</ul></li>
<li>구간화는 도메인지식이 많지 않으므로 진행하지 않음</li>
</ul>
<div id="f9453645" class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 범주형 변수 추리기</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>x_categorical <span class="op">=</span> x_train.select_dtypes(include<span class="op">=</span>[<span class="st">'object'</span>])</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>x_categorical.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">car</th>
<th data-quarto-table-cell-role="th">reality</th>
<th data-quarto-table-cell-role="th">income_type</th>
<th data-quarto-table-cell-role="th">edu_type</th>
<th data-quarto-table-cell-role="th">family_type</th>
<th data-quarto-table-cell-role="th">house_type</th>
<th data-quarto-table-cell-role="th">occyp_type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>F</td>
<td>N</td>
<td>N</td>
<td>Commercial associate</td>
<td>Higher education</td>
<td>Married</td>
<td>Municipal apartment</td>
<td>None</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>F</td>
<td>N</td>
<td>Y</td>
<td>Commercial associate</td>
<td>Secondary / secondary special</td>
<td>Civil marriage</td>
<td>House / apartment</td>
<td>Laborers</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>M</td>
<td>Y</td>
<td>Y</td>
<td>Working</td>
<td>Higher education</td>
<td>Married</td>
<td>House / apartment</td>
<td>Managers</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>F</td>
<td>N</td>
<td>Y</td>
<td>Commercial associate</td>
<td>Secondary / secondary special</td>
<td>Married</td>
<td>House / apartment</td>
<td>Sales staff</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>F</td>
<td>Y</td>
<td>Y</td>
<td>State servant</td>
<td>Higher education</td>
<td>Married</td>
<td>House / apartment</td>
<td>Managers</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="167e1456" class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># credit 데이터 합치기</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>combined_data <span class="op">=</span> x_categorical.copy()</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>combined_data[<span class="st">'credit'</span>] <span class="op">=</span> y_train.copy()  <span class="co"># 동일한 인덱스를 기준으로 credit 추가</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 범주형 변수 설정</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="op">=</span> [<span class="st">'gender'</span>, <span class="st">'car'</span>, <span class="st">'reality'</span>, <span class="st">'income_type'</span>, <span class="st">'edu_type'</span>, <span class="st">'family_type'</span>, <span class="st">'house_type'</span>, <span class="st">'occyp_type'</span>]</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>num_vars <span class="op">=</span> <span class="bu">len</span>(categorical_columns)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> math.ceil(num_vars <span class="op">/</span> cols)  <span class="co"># 필요한 행(row) 수 계산</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 서브플롯 생성</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(rows, cols, figsize<span class="op">=</span>(<span class="dv">18</span>, rows <span class="op">*</span> <span class="dv">5</span>))  <span class="co"># 전체 figure 크기 조정</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()  <span class="co"># 2D 배열을 1D로 변환하여 인덱싱 편리하게</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 그래프 그리기</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, var_nm <span class="kw">in</span> <span class="bu">enumerate</span>(categorical_columns):</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> axes[idx]</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 데이터 그룹화 및 스택 데이터 계산</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    stacked_data <span class="op">=</span> combined_data.groupby([var_nm, <span class="st">'credit'</span>]).size().unstack(fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 각 카테고리의 막대 그래프 그리기</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    bottom_values <span class="op">=</span> np.zeros(<span class="bu">len</span>(stacked_data))</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> credit_value <span class="kw">in</span> stacked_data.columns:</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>        ax.bar(stacked_data.index, stacked_data[credit_value], bottom<span class="op">=</span>bottom_values, label<span class="op">=</span><span class="ss">f'Credit </span><span class="sc">{</span>credit_value<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>        bottom_values <span class="op">+=</span> stacked_data[credit_value]</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 그래프 설정</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f'Stacked Bar Plot of </span><span class="sc">{</span>var_nm<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(var_nm)</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Count'</span>)</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    ax.legend(title<span class="op">=</span><span class="st">'Credit'</span>, loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="co"># 빈 서브플롯 숨기기</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_vars, <span class="bu">len</span>(axes)):</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>    axes[i].axis(<span class="st">'off'</span>)</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>occyp_type(직업유형)
<ul>
<li>occyp_type의 경우는 앞서 확인했을 때, 유일하게 결측치가 있으면서 결측치가 많았음</li>
<li>따라서 삭제가 아닌 대체가 필요한데, 결측치의 처리를 위해 결측치가 가지는 의미나 맥락을 고민해봄
<ul>
<li>’무직’이라는 컬럼이 없는데, 결측치가 ’무직’을 의미하는 것은 아닐지 확인
<ul>
<li>DAYS_EMPLOYED변수가 양수인(직업이 없는) 경우를 제외해도, 여전히 Null값이 존재</li>
<li>무직이어서 Null인 값도 있지만, 무직이 아님에도 Null인 경우도 있음</li>
<li>Null값에 따른 평균/최대/최소 임금 등을 시각해보았으나 별도의 인사이트는 얻지 못함</li>
</ul></li>
</ul></li>
<li><strong>occyp_type(직업유형)의 결측치 중, DAYS_EMPLOYED변수가 양수인 경우는 ‘NoJob’, 이외는 ’Missing’으로 대체</strong>하기로 함
<ul>
<li>sklearn의 SimpleImputer라는 것도 있었으나, 최빈값 대체할 것은 아니므로 사용하지 않음</li>
</ul></li>
</ul></li>
</ul>
<div id="77f4b65e" class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># occyp_type(직업유형)의 값 확인</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>x_categorical.occyp_type.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>occyp_type
Laborers                 4512
Core staff               2646
Sales staff              2539
Managers                 2167
Drivers                  1575
High skill tech staff    1040
Accountants               902
Medicine staff            864
Cooking staff             457
Security staff            424
Cleaning staff            403
Private service staff     243
Low-skill Laborers        127
Waiters/barmen staff      124
Secretaries                97
Realty agents              63
HR staff                   62
IT staff                   41
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="a8275572" class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Null값에 따른 평균/최대/최소 임금 시각화. 별도의 인사이트는 얻지 못함</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 결측 여부 컬럼 추가</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>x_train_temp <span class="op">=</span> x_train[(x_train[<span class="st">'DAYS_EMPLOYED'</span>]<span class="op">!=</span><span class="dv">365243</span>)].copy()</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>x_train_temp[<span class="st">'occyp_type_isnull'</span>] <span class="op">=</span> x_train_temp[<span class="st">'occyp_type'</span>].isnull()</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 그룹별 income_total의 평균, 최대, 최소 계산</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="op">=</span> x_train_temp.groupby(<span class="st">'occyp_type_isnull'</span>)[<span class="st">'income_total'</span>].agg([<span class="st">'mean'</span>, <span class="st">'max'</span>, <span class="st">'min'</span>]).reset_index()</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>summary_stats.columns <span class="op">=</span> [<span class="st">'IsNull'</span>, <span class="st">'Mean'</span>, <span class="st">'Max'</span>, <span class="st">'Min'</span>]</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Boolean 값을 문자열로 변환</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>summary_stats[<span class="st">'IsNull'</span>] <span class="op">=</span> summary_stats[<span class="st">'IsNull'</span>].astype(<span class="bu">str</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 서브플롯 생성</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>))  <span class="co"># 1행 2열의 서브플롯 생성</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 왼쪽 플롯: 평균(Mean)</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>sns.barplot(ax<span class="op">=</span>axes[<span class="dv">0</span>], x<span class="op">=</span><span class="st">'IsNull'</span>, y<span class="op">=</span><span class="st">'Mean'</span>, data<span class="op">=</span>summary_stats, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> summary_stats.iterrows():</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].text(i, row[<span class="st">'Mean'</span>], <span class="ss">f"</span><span class="sc">{</span>row[<span class="st">'Mean'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>, color<span class="op">=</span><span class="st">'black'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Income Total - Mean by Null Status'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'Occyp Type is Null'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Mean Income Total'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(axis<span class="op">=</span><span class="st">'y'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="co"># 오른쪽 플롯: 최대(Max)와 최소(Min)</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(summary_stats[<span class="st">'IsNull'</span>], summary_stats[<span class="st">'Max'</span>], color<span class="op">=</span><span class="st">'red'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">'Max'</span>)</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(summary_stats[<span class="st">'IsNull'</span>], summary_stats[<span class="st">'Min'</span>], color<span class="op">=</span><span class="st">'blue'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">'Min'</span>)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> summary_stats.iterrows():</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].text(i, row[<span class="st">'Max'</span>], <span class="ss">f"</span><span class="sc">{</span>row[<span class="st">'Max'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>, color<span class="op">=</span><span class="st">'red'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].text(i, row[<span class="st">'Min'</span>], <span class="ss">f"</span><span class="sc">{</span>row[<span class="st">'Min'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>, color<span class="op">=</span><span class="st">'blue'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'top'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'Income Total - Max &amp; Min by Null Status'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'Occyp Type is Null'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'Income Total'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend(title<span class="op">=</span><span class="st">'Statistics'</span>, loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(axis<span class="op">=</span><span class="st">'y'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 레이아웃 조정 및 출력</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="y값-불균형도-확인" class="level2">
<h2 class="anchored" data-anchor-id="y값-불균형도-확인">y값 불균형도 확인</h2>
<ul>
<li>(변수 설명에 따르면)숫자가 낮을수록 신용도가 높은데, 신용도가 낮은 경우가 64%로 많은편임</li>
</ul>
<div id="c61225d3" class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>y_train.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>credit
2.0    16968
1.0     6267
0.0     3222
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="451b6ad2" class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>y_train.value_counts(normalize<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>credit
2.0    0.641343
1.0    0.236875
0.0    0.121783
Name: proportion, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="전처리-결측이상치-처리-및-표준화정규화-등" class="level2">
<h2 class="anchored" data-anchor-id="전처리-결측이상치-처리-및-표준화정규화-등">[전처리] 결측/이상치 처리 및 표준화/정규화 등</h2>
<section id="결측치-대체-공통" class="level3">
<h3 class="anchored" data-anchor-id="결측치-대체-공통">결측치 대체 (공통)</h3>
<ul>
<li>모든(수치형/범주형) 변수를 통틀어 1개의 변수만 가지고 있던 결측치를 먼저 대체
<ul>
<li>범주형 변수 중 occyp_type(직업유형)의 결측치를 조건에 따라 ‘NoJob’ 또는 ’Missing’으로 대체</li>
<li>결측치 대체 후, Unique값 array 값이 아래와 같이 변경되었음</li>
</ul></li>
</ul>
<div id="a5059649" class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 결측치 대체 전</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Unique data수 : </span><span class="sc">{</span><span class="bu">len</span>(x_train.occyp_type.unique())<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>x_train.occyp_type.unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unique data수 : 19</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>array([None, 'Laborers', 'Managers', 'Sales staff',
       'High skill tech staff', 'Core staff', 'Drivers', 'Medicine staff',
       'Accountants', 'Realty agents', 'Security staff', 'Cleaning staff',
       'Private service staff', 'Cooking staff', 'Secretaries',
       'HR staff', 'IT staff', 'Low-skill Laborers',
       'Waiters/barmen staff'], dtype=object)</code></pre>
</div>
</div>
<div id="c8e914f1" class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 결측치 대체 후</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fill_occyp_type(row):</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.isna(row[<span class="st">'occyp_type'</span>]):</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> row[<span class="st">'DAYS_EMPLOYED'</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">'NoJob'</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">'Missing'</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> row[<span class="st">'occyp_type'</span>]</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>x_train[<span class="st">'occyp_type'</span>] <span class="op">=</span> x_train.<span class="bu">apply</span>(fill_occyp_type, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 변화 확인</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Unique data수 : </span><span class="sc">{</span><span class="bu">len</span>(x_train.occyp_type.unique())<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>x_train.occyp_type.unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unique data수 : 20</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>array(['Missing', 'Laborers', 'Managers', 'Sales staff',
       'High skill tech staff', 'Core staff', 'Drivers', 'Medicine staff',
       'Accountants', 'NoJob', 'Realty agents', 'Security staff',
       'Cleaning staff', 'Private service staff', 'Cooking staff',
       'Secretaries', 'HR staff', 'IT staff', 'Low-skill Laborers',
       'Waiters/barmen staff'], dtype=object)</code></pre>
</div>
</div>
<div id="477691b0" class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 범주형, 수치형 변수로 나누어 작업</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>x_categorical <span class="op">=</span> x_train.select_dtypes(include<span class="op">=</span>[<span class="st">'object'</span>])</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>x_numerical <span class="op">=</span> x_train.select_dtypes(include<span class="op">=</span>[<span class="st">'float64'</span>, <span class="st">'int64'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="수치형-변수-전처리" class="level3">
<h3 class="anchored" data-anchor-id="수치형-변수-전처리">수치형 변수 전처리</h3>
<ul>
<li>값이 0, 1로 유무만을 나타내는 변수는 처리하지 않음
<ul>
<li>대상 : FLAG_MOBIL, work_phone, phone, email</li>
</ul></li>
<li>값이 음수인 변수(역산하는 변수)는 아래와 같이 처리
<ul>
<li>대상 : DAYS_BIRTH, DAYS_EMPLOYED, begin_month</li>
<li>(공통) 표준화/정규화/로그변환 전, 최소값 조정 진행</li>
<li><strong>로그변환</strong> : <code>DAYS_EMPLOYED</code>
<ul>
<li>무직임을 표현하려면 양수이기만 하면 되므로, 기준의 365243을 1로 대체</li>
<li>IQR기준 이상치가 있는 것으로 판명되긴하나, 값이 많고 처리기준을 정하기 어려워, 양수를 1로 대체하여 숫자 범위를 한번 줄인 후, 로그변환 진행</li>
</ul></li>
<li><strong>표준화</strong> : <code>DAYS_BIRTH</code>, <code>begin_month</code>
<ul>
<li>IQR기준 이상치를 보지 못했으며, 첨도가 -1정도로 <strong>표준화</strong> 진행</li>
<li>향후 사용할 모델에 따라 변경할 수 있음</li>
<li>아래 기준은 GPT로 1차적으로 받아본 기준이며, 실제 진행 전에 좀 더 알아보고 결정
<ul>
<li>표준화 : 선형모델, SVM, KNN</li>
<li>정규화 : 거리기반 모델(클러스터링, KNN)</li>
</ul></li>
</ul></li>
</ul></li>
<li>이외의 변수는 정규화/표준화 중, 아래의 관점을 기준으로 <strong>정규화를 적용</strong>하기로 함
<ul>
<li>대상 : child_num, income_total, family_size</li>
<li>분포상 중심에서 떨어진 이상치를 보유하고있으며, 이상치 대체를 선행하기엔 영향을 알기 어려워 진행하지 않음</li>
<li>표준화는 이상치의 영향을 많이 받을 수 있다는 점에서 정규화로 선택함</li>
</ul></li>
</ul>
<div id="9aa5f62a" class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 수치형변수 현황 확인</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>x_numerical.describe().transpose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">index</td>
<td>26457.0</td>
<td>13228.000000</td>
<td>7637.622372</td>
<td>0.0</td>
<td>6614.0</td>
<td>13228.0</td>
<td>19842.0</td>
<td>26456.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">child_num</td>
<td>26457.0</td>
<td>0.428658</td>
<td>0.747326</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>19.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">income_total</td>
<td>26457.0</td>
<td>187306.524493</td>
<td>101878.367995</td>
<td>27000.0</td>
<td>121500.0</td>
<td>157500.0</td>
<td>225000.0</td>
<td>1575000.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">DAYS_BIRTH</td>
<td>26457.0</td>
<td>-15958.053899</td>
<td>4201.589022</td>
<td>-25152.0</td>
<td>-19431.0</td>
<td>-15547.0</td>
<td>-12446.0</td>
<td>-7705.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">DAYS_EMPLOYED</td>
<td>26457.0</td>
<td>59068.750728</td>
<td>137475.427503</td>
<td>-15713.0</td>
<td>-3153.0</td>
<td>-1539.0</td>
<td>-407.0</td>
<td>365243.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">FLAG_MOBIL</td>
<td>26457.0</td>
<td>1.000000</td>
<td>0.000000</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">work_phone</td>
<td>26457.0</td>
<td>0.224742</td>
<td>0.417420</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">phone</td>
<td>26457.0</td>
<td>0.294251</td>
<td>0.455714</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">email</td>
<td>26457.0</td>
<td>0.091280</td>
<td>0.288013</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">family_size</td>
<td>26457.0</td>
<td>2.196848</td>
<td>0.916717</td>
<td>1.0</td>
<td>2.0</td>
<td>2.0</td>
<td>3.0</td>
<td>20.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">begin_month</td>
<td>26457.0</td>
<td>-26.123294</td>
<td>16.559550</td>
<td>-60.0</td>
<td>-39.0</td>
<td>-24.0</td>
<td>-12.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="이상치-대체days_employed" class="level4">
<h4 class="anchored" data-anchor-id="이상치-대체days_employed">이상치 대체(DAYS_EMPLOYED)</h4>
<div id="119de0cf" class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 이상치 대체 전</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>x_numerical[<span class="st">'DAYS_EMPLOYED'</span>].<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>365243</code></pre>
</div>
</div>
<div id="6f3ceabb" class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 이상치 대체 후</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># DAYS_EMPLOYED : 365243를 1로 대체</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>x_numerical[<span class="st">'DAYS_EMPLOYED'</span>] <span class="op">=</span> x_numerical[<span class="st">'DAYS_EMPLOYED'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x <span class="op">==</span> <span class="fl">365243.0</span> <span class="cf">else</span> x)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>x_numerical[<span class="st">'DAYS_EMPLOYED'</span>].<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>1</code></pre>
</div>
</div>
</section>
<section id="최소값-조정음수변수들-days_birth-days_employed-begin_month" class="level4">
<h4 class="anchored" data-anchor-id="최소값-조정음수변수들-days_birth-days_employed-begin_month">최소값 조정(음수변수들 : DAYS_BIRTH, DAYS_EMPLOYED, begin_month)</h4>
<div id="a653540f" class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 최소값 변환 전</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>x_numerical[[<span class="st">'DAYS_BIRTH'</span>, <span class="st">'DAYS_EMPLOYED'</span>, <span class="st">'begin_month'</span>]].<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>DAYS_BIRTH      -25152.0
DAYS_EMPLOYED   -15713.0
begin_month        -60.0
dtype: float64</code></pre>
</div>
</div>
<div id="fe30fec2" class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 최소값 변환 후</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># min() * -1  을 더하여 변환</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>x_numerical[[<span class="st">'DAYS_BIRTH'</span>, <span class="st">'DAYS_EMPLOYED'</span>, <span class="st">'begin_month'</span>]] <span class="op">=</span> x_numerical[[<span class="st">'DAYS_BIRTH'</span>, <span class="st">'DAYS_EMPLOYED'</span>, <span class="st">'begin_month'</span>]] <span class="op">+</span> x_numerical[[<span class="st">'DAYS_BIRTH'</span>, <span class="st">'DAYS_EMPLOYED'</span>, <span class="st">'begin_month'</span>]].<span class="bu">min</span>()<span class="op">*-</span><span class="dv">1</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>x_numerical[[<span class="st">'DAYS_BIRTH'</span>, <span class="st">'DAYS_EMPLOYED'</span>, <span class="st">'begin_month'</span>]].<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>DAYS_BIRTH       0.0
DAYS_EMPLOYED    0.0
begin_month      0.0
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="로그변환days_employed" class="level4">
<h4 class="anchored" data-anchor-id="로그변환days_employed">로그변환(‘DAYS_EMPLOYED’)</h4>
<div id="c11bbb0a" class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 로그변환 전</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>x_numerical[<span class="st">'DAYS_EMPLOYED'</span>].head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0    11004.0
1    14173.0
2    11279.0
3    13621.0
4    13608.0
Name: DAYS_EMPLOYED, dtype: float64</code></pre>
</div>
</div>
<div id="0af47af9" class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 로그변환 후</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>x_numerical[<span class="st">'DAYS_EMPLOYED'</span>] <span class="op">=</span> x_numerical[<span class="st">'DAYS_EMPLOYED'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x : np.log1p(x))</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>x_numerical[<span class="st">'DAYS_EMPLOYED'</span>].head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0    9.306105
1    9.559165
2    9.330787
3    9.519441
4    9.518487
Name: DAYS_EMPLOYED, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="표준화-적용days_birth-begin_month" class="level4">
<h4 class="anchored" data-anchor-id="표준화-적용days_birth-begin_month">표준화 적용(‘DAYS_BIRTH’, ‘begin_month’)</h4>
<div id="6232ee76" class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 표준화 적용 전</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>x_numerical[[<span class="st">'DAYS_BIRTH'</span>, <span class="st">'begin_month'</span>]].head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">DAYS_BIRTH</th>
<th data-quarto-table-cell-role="th">begin_month</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>11253.0</td>
<td>54.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>13772.0</td>
<td>55.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>6065.0</td>
<td>38.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>10064.0</td>
<td>23.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>10115.0</td>
<td>34.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="a6a7af1a" class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 표준화 적용 후</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>std_scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>x_numerical[[<span class="st">'DAYS_BIRTH'</span>, <span class="st">'begin_month'</span>]] <span class="op">=</span> std_scaler.fit_transform(x_numerical[[<span class="st">'DAYS_BIRTH'</span>, <span class="st">'begin_month'</span>]])</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>x_numerical[[<span class="st">'DAYS_BIRTH'</span>, <span class="st">'begin_month'</span>]].head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">DAYS_BIRTH</th>
<th data-quarto-table-cell-role="th">begin_month</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.490075</td>
<td>1.215231</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.089621</td>
<td>1.275620</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.744719</td>
<td>0.249003</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.207081</td>
<td>-0.656836</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.219220</td>
<td>0.007446</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="정규화-적용child_num-income_total-family_size" class="level4">
<h4 class="anchored" data-anchor-id="정규화-적용child_num-income_total-family_size">정규화 적용(child_num, income_total, family_size)</h4>
<div id="40e749cf" class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 정규화 적용 전</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>x_numerical[[<span class="st">'child_num'</span>, <span class="st">'income_total'</span>, <span class="st">'family_size'</span>]].head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">child_num</th>
<th data-quarto-table-cell-role="th">income_total</th>
<th data-quarto-table-cell-role="th">family_size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>202500.0</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>247500.0</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0</td>
<td>450000.0</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0</td>
<td>202500.0</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
<td>157500.0</td>
<td>2.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="25e83fe1" class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 정규화 적용 후</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>min_max_scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>x_numerical[[<span class="st">'child_num'</span>, <span class="st">'income_total'</span>, <span class="st">'family_size'</span>]]  <span class="op">=</span> min_max_scaler.fit_transform(x_numerical[[<span class="st">'child_num'</span>, <span class="st">'income_total'</span>, <span class="st">'family_size'</span>]] )</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>x_numerical[[<span class="st">'child_num'</span>, <span class="st">'income_total'</span>, <span class="st">'family_size'</span>]].head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">child_num</th>
<th data-quarto-table-cell-role="th">income_total</th>
<th data-quarto-table-cell-role="th">family_size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.000000</td>
<td>0.113372</td>
<td>0.052632</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.052632</td>
<td>0.142442</td>
<td>0.105263</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.000000</td>
<td>0.273256</td>
<td>0.052632</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.000000</td>
<td>0.113372</td>
<td>0.052632</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.000000</td>
<td>0.084302</td>
<td>0.052632</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="범주형-변수-전처리" class="level3">
<h3 class="anchored" data-anchor-id="범주형-변수-전처리">범주형 변수 전처리</h3>
<ul>
<li>Ordinal변수에 대해서는 Label인코딩 적용
<ul>
<li>대상 : edu_type</li>
</ul></li>
<li>Unique값이 2~6개인 변수에 대해서는 One-hot Encoding 적용
<ul>
<li>대상 : ‘gender’, ‘car’, ‘reality’, ‘income_type’, ‘family_type’, ‘house_type’</li>
<li>22개 컬럼(변수) 추가될 것으로 예상</li>
</ul></li>
<li>Unique값이 20개인 변수에 대해서는, 아래의 방법을 적용
<ul>
<li>대상 : ‘occyp_type’</li>
<li>변수의 과도한 증가와, 상하관계 착각을 막기위해 다른 방법을 고민</li>
<li>Target인코딩이라는 것을 적용해보기로 함 (with LeaveOneOutEncoder)
<ul>
<li>향후 적용여부에 따라 모델성능이 저하되거나 유의미하지 않다면 변수 제외를 고려(계산복잡성 등을 고려함)</li>
</ul></li>
</ul></li>
</ul>
<div id="804293d7" class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>x_categorical.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">car</th>
<th data-quarto-table-cell-role="th">reality</th>
<th data-quarto-table-cell-role="th">income_type</th>
<th data-quarto-table-cell-role="th">edu_type</th>
<th data-quarto-table-cell-role="th">family_type</th>
<th data-quarto-table-cell-role="th">house_type</th>
<th data-quarto-table-cell-role="th">occyp_type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>26457</td>
<td>26457</td>
<td>26457</td>
<td>26457</td>
<td>26457</td>
<td>26457</td>
<td>26457</td>
<td>26457</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">unique</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>6</td>
<td>20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">top</td>
<td>F</td>
<td>N</td>
<td>Y</td>
<td>Working</td>
<td>Secondary / secondary special</td>
<td>Married</td>
<td>House / apartment</td>
<td>Laborers</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">freq</td>
<td>17697</td>
<td>16410</td>
<td>17830</td>
<td>13645</td>
<td>17995</td>
<td>18196</td>
<td>23653</td>
<td>4512</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="label인코딩-ordinal변수" class="level4">
<h4 class="anchored" data-anchor-id="label인코딩-ordinal변수">Label인코딩 : Ordinal변수</h4>
<div id="df1a3af9" class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Label인코딩 전</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>x_categorical[<span class="st">'edu_type'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array(['Higher education', 'Secondary / secondary special',
       'Incomplete higher', 'Lower secondary', 'Academic degree'],
      dtype=object)</code></pre>
</div>
</div>
<div id="bef8c0b9" class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Label인코딩 후 (Order값은 낮은 것부터 입력)</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OrdinalEncoder</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> [</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Lower secondary'</span>,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Secondary / secondary special'</span>,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Incomplete higher'</span>,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Higher education'</span>,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Academic degree'</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>o_encoder <span class="op">=</span> OrdinalEncoder(categories<span class="op">=</span>[order])</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>oe_df <span class="op">=</span> o_encoder.fit_transform(x_categorical[[<span class="st">'edu_type'</span>]])</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>x_categorical[<span class="st">'edu_type'</span>] <span class="op">=</span> oe_df.flatten()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fc91f1d2" class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>x_categorical[<span class="st">'edu_type'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([3., 1., 2., 0., 4.])</code></pre>
</div>
</div>
</section>
<section id="one-hot인코딩-unique값이-26개인-변수" class="level4">
<h4 class="anchored" data-anchor-id="one-hot인코딩-unique값이-26개인-변수">One-hot인코딩 : Unique값이 2~6개인 변수</h4>
<div id="aad51006" class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One-hot인코딩 전</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>x_categorical.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['gender', 'car', 'reality', 'income_type', 'edu_type', 'family_type',
       'house_type', 'occyp_type'],
      dtype='object')</code></pre>
</div>
</div>
<div id="a6e05cc0" class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One-hot 인코딩 데이터프레임 생성</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>one_hot_columns <span class="op">=</span> [<span class="st">'gender'</span>, <span class="st">'car'</span>, <span class="st">'reality'</span>, <span class="st">'income_type'</span>, <span class="st">'family_type'</span>, <span class="st">'house_type'</span>]</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>oh_encoder <span class="op">=</span> OneHotEncoder(sparse_output<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>onehot_encoded <span class="op">=</span> oh_encoder.fit_transform(x_categorical[one_hot_columns])</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>encoded_col_names <span class="op">=</span> oh_encoder.get_feature_names_out(input_features<span class="op">=</span>one_hot_columns)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>df_onehot_encoded <span class="op">=</span> pd.DataFrame(onehot_encoded, columns<span class="op">=</span>encoded_col_names, index<span class="op">=</span>x_categorical.index)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>df_onehot_encoded.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['gender_F', 'gender_M', 'car_N', 'car_Y', 'reality_N', 'reality_Y',
       'income_type_Commercial associate', 'income_type_Pensioner',
       'income_type_State servant', 'income_type_Student',
       'income_type_Working', 'family_type_Civil marriage',
       'family_type_Married', 'family_type_Separated',
       'family_type_Single / not married', 'family_type_Widow',
       'house_type_Co-op apartment', 'house_type_House / apartment',
       'house_type_Municipal apartment', 'house_type_Office apartment',
       'house_type_Rented apartment', 'house_type_With parents'],
      dtype='object')</code></pre>
</div>
</div>
<div id="21979b67" class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ont-hot인코딩 대상 컬럼 미리 Drop (별도로 생성한 인코딩된 데이터프레임을 다시 합칠 예정)</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>x_categorical.drop(one_hot_columns, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>x_categorical.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['edu_type', 'occyp_type'], dtype='object')</code></pre>
</div>
</div>
<div id="cbfa26af" class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One-hot인코딩 후</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ont-hot인코딩된 데이터프레임 Concat</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>x_categorical <span class="op">=</span> pd.concat([x_categorical, df_onehot_encoded], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Ont-hot인코딩된 최종컬럼 확인</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>x_categorical.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['edu_type', 'occyp_type', 'gender_F', 'gender_M', 'car_N', 'car_Y',
       'reality_N', 'reality_Y', 'income_type_Commercial associate',
       'income_type_Pensioner', 'income_type_State servant',
       'income_type_Student', 'income_type_Working',
       'family_type_Civil marriage', 'family_type_Married',
       'family_type_Separated', 'family_type_Single / not married',
       'family_type_Widow', 'house_type_Co-op apartment',
       'house_type_House / apartment', 'house_type_Municipal apartment',
       'house_type_Office apartment', 'house_type_Rented apartment',
       'house_type_With parents'],
      dtype='object')</code></pre>
</div>
</div>
</section>
<section id="target인코딩-ordinal이-아니고-unique값이-많은-변수" class="level4">
<h4 class="anchored" data-anchor-id="target인코딩-ordinal이-아니고-unique값이-많은-변수">Target인코딩 : Ordinal이 아니고 Unique값이 많은 변수</h4>
<div id="43d20d07" class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Target인코딩 전</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>x_categorical[<span class="st">'occyp_type'</span>].<span class="fu">__len__</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;bound method Series.__len__ of 0               Missing
1              Laborers
2              Managers
3           Sales staff
4              Managers
              ...      
26452        Core staff
26453           Missing
26454        Core staff
26455          Laborers
26456    Security staff
Name: occyp_type, Length: 26457, dtype: object&gt;</code></pre>
</div>
</div>
<div id="7fa62d48" class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Target인코딩 후</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> category_encoders <span class="im">as</span> ce</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> joblib</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>x_column <span class="op">=</span> <span class="st">'occyp_type'</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>leave_one_out_encoder <span class="op">=</span> ce.LeaveOneOutEncoder(cols<span class="op">=</span>x_column, sigma<span class="op">=</span><span class="fl">0.1</span>, return_df<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>df_target_encoded <span class="op">=</span> leave_one_out_encoder.fit_transform(x_categorical[x_column], y_train)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>joblib.dump(leave_one_out_encoder, <span class="st">'encoder_leave_one_out.pkl'</span>)</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>df_target_encoded[<span class="st">'occyp_type'</span>].<span class="fu">__len__</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;bound method Series.__len__ of 0        1.570514
1        1.621321
2        1.552459
3        1.461605
4        1.727354
           ...   
26452    1.405981
26453    1.556405
26454    1.389829
26455    1.376017
26456    1.597510
Name: occyp_type, Length: 26457, dtype: float64&gt;</code></pre>
</div>
</div>
<div id="3f199672" class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>x_categorical[<span class="st">'occyp_type'</span>] <span class="op">=</span> df_target_encoded[<span class="st">'occyp_type'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="전처리된-데이터-저장" class="level2">
<h2 class="anchored" data-anchor-id="전처리된-데이터-저장">전처리된 데이터 저장</h2>
<div id="20d860a3" class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 범주형/수치형 변수로 나누어 작업한 파일 합치기</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>x_train_preprocessed <span class="op">=</span> pd.concat([x_categorical, x_numerical], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>x_train_preprocessed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">edu_type</th>
<th data-quarto-table-cell-role="th">occyp_type</th>
<th data-quarto-table-cell-role="th">gender_F</th>
<th data-quarto-table-cell-role="th">gender_M</th>
<th data-quarto-table-cell-role="th">car_N</th>
<th data-quarto-table-cell-role="th">car_Y</th>
<th data-quarto-table-cell-role="th">reality_N</th>
<th data-quarto-table-cell-role="th">reality_Y</th>
<th data-quarto-table-cell-role="th">income_type_Commercial associate</th>
<th data-quarto-table-cell-role="th">income_type_Pensioner</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">child_num</th>
<th data-quarto-table-cell-role="th">income_total</th>
<th data-quarto-table-cell-role="th">DAYS_BIRTH</th>
<th data-quarto-table-cell-role="th">DAYS_EMPLOYED</th>
<th data-quarto-table-cell-role="th">FLAG_MOBIL</th>
<th data-quarto-table-cell-role="th">work_phone</th>
<th data-quarto-table-cell-role="th">phone</th>
<th data-quarto-table-cell-role="th">email</th>
<th data-quarto-table-cell-role="th">family_size</th>
<th data-quarto-table-cell-role="th">begin_month</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>3.0</td>
<td>1.570514</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.000000</td>
<td>0.113372</td>
<td>0.490075</td>
<td>9.306105</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.052632</td>
<td>1.215231</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.0</td>
<td>1.621321</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.052632</td>
<td>0.142442</td>
<td>1.089621</td>
<td>9.559165</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0.105263</td>
<td>1.275620</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3.0</td>
<td>1.552459</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.000000</td>
<td>0.273256</td>
<td>-0.744719</td>
<td>9.330787</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0.052632</td>
<td>0.249003</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1.0</td>
<td>1.461605</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.000000</td>
<td>0.113372</td>
<td>0.207081</td>
<td>9.519441</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0.052632</td>
<td>-0.656836</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3.0</td>
<td>1.727354</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.000000</td>
<td>0.084302</td>
<td>0.219220</td>
<td>9.518487</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.052632</td>
<td>0.007446</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26452</td>
<td>1.0</td>
<td>1.405981</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.105263</td>
<td>0.127907</td>
<td>0.923252</td>
<td>9.527338</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.157895</td>
<td>1.456788</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26453</td>
<td>3.0</td>
<td>1.556405</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.052632</td>
<td>0.098837</td>
<td>0.158765</td>
<td>9.490922</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.052632</td>
<td>-1.260729</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26454</td>
<td>1.0</td>
<td>1.389829</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.000000</td>
<td>0.171512</td>
<td>1.398558</td>
<td>9.525078</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.052632</td>
<td>0.067835</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26455</td>
<td>2.0</td>
<td>1.376017</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.000000</td>
<td>0.093023</td>
<td>1.383563</td>
<td>9.655475</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.000000</td>
<td>-1.985400</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26456</td>
<td>1.0</td>
<td>1.597510</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.000000</td>
<td>0.034884</td>
<td>-0.859440</td>
<td>9.595671</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.052632</td>
<td>1.034063</td>
</tr>
</tbody>
</table>

<p>26457 rows × 35 columns</p>
</div>
</div>
</div>
<div id="94d7a981" class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CSV저장</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>x_train_preprocessed.to_csv(<span class="st">'train_preprocessed.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b5d41d7f" class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DB저장</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>db_controller.df_to_table(<span class="st">'train_pre'</span>, x_train_preprocessed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="2e2959ad" class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DB저장된 내용 확인</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>db_controller.search_db_show_df(<span class="st">"SELECT * FROM train_pre"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">edu_type</th>
<th data-quarto-table-cell-role="th">occyp_type</th>
<th data-quarto-table-cell-role="th">gender_F</th>
<th data-quarto-table-cell-role="th">gender_M</th>
<th data-quarto-table-cell-role="th">car_N</th>
<th data-quarto-table-cell-role="th">car_Y</th>
<th data-quarto-table-cell-role="th">reality_N</th>
<th data-quarto-table-cell-role="th">reality_Y</th>
<th data-quarto-table-cell-role="th">income_type_Commercial associate</th>
<th data-quarto-table-cell-role="th">income_type_Pensioner</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">child_num</th>
<th data-quarto-table-cell-role="th">income_total</th>
<th data-quarto-table-cell-role="th">DAYS_BIRTH</th>
<th data-quarto-table-cell-role="th">DAYS_EMPLOYED</th>
<th data-quarto-table-cell-role="th">FLAG_MOBIL</th>
<th data-quarto-table-cell-role="th">work_phone</th>
<th data-quarto-table-cell-role="th">phone</th>
<th data-quarto-table-cell-role="th">email</th>
<th data-quarto-table-cell-role="th">family_size</th>
<th data-quarto-table-cell-role="th">begin_month</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>3.0</td>
<td>1.570514</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.000000</td>
<td>0.113372</td>
<td>0.490075</td>
<td>9.306105</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.052632</td>
<td>1.215231</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.0</td>
<td>1.621321</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.052632</td>
<td>0.142442</td>
<td>1.089621</td>
<td>9.559165</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0.105263</td>
<td>1.275620</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3.0</td>
<td>1.552459</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.000000</td>
<td>0.273256</td>
<td>-0.744719</td>
<td>9.330787</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0.052632</td>
<td>0.249003</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1.0</td>
<td>1.461605</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.000000</td>
<td>0.113372</td>
<td>0.207081</td>
<td>9.519441</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0.052632</td>
<td>-0.656836</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3.0</td>
<td>1.727354</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.000000</td>
<td>0.084302</td>
<td>0.219220</td>
<td>9.518487</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.052632</td>
<td>0.007446</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26452</td>
<td>1.0</td>
<td>1.405981</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.105263</td>
<td>0.127907</td>
<td>0.923252</td>
<td>9.527338</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.157895</td>
<td>1.456788</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26453</td>
<td>3.0</td>
<td>1.556405</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.052632</td>
<td>0.098837</td>
<td>0.158765</td>
<td>9.490922</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.052632</td>
<td>-1.260729</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26454</td>
<td>1.0</td>
<td>1.389829</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.000000</td>
<td>0.171512</td>
<td>1.398558</td>
<td>9.525078</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.052632</td>
<td>0.067835</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26455</td>
<td>2.0</td>
<td>1.376017</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.000000</td>
<td>0.093023</td>
<td>1.383563</td>
<td>9.655475</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.000000</td>
<td>-1.985400</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26456</td>
<td>1.0</td>
<td>1.597510</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.000000</td>
<td>0.034884</td>
<td>-0.859440</td>
<td>9.595671</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.052632</td>
<td>1.034063</td>
</tr>
</tbody>
</table>

<p>26457 rows × 35 columns</p>
</div>
</div>
</div>
</section>
<section id="향후-test데이터셋에-쓰기위한-전처리-코드-정리" class="level2">
<h2 class="anchored" data-anchor-id="향후-test데이터셋에-쓰기위한-전처리-코드-정리">향후 Test데이터셋에 쓰기위한 전처리 코드 정리</h2>
<div id="b981f1f4" class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas <span class="im">import</span> DataFrame</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler, StandardScaler, OrdinalEncoder, OneHotEncoder</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> category_encoders <span class="im">as</span> ce</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> joblib</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pkb_sqlite3 <span class="im">import</span> DB_sqlite3</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> preprocess_x_data(train_or_test:<span class="bu">str</span>, dataset:<span class="bu">list</span>[DataFrame], output_name:<span class="bu">dict</span>)<span class="op">-&gt;</span><span class="va">None</span>:</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 파라메터 검증 및 데이터셋 복사</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> train_or_test <span class="op">==</span> <span class="st">'train'</span>:</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(dataset) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>            x_train <span class="op">=</span> dataset[<span class="dv">0</span>].copy()</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>            y_train <span class="op">=</span> dataset[<span class="dv">1</span>].copy()</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">'train인 경우 x,y 데이터가 필요합니다'</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> train_or_test <span class="op">==</span> <span class="st">'test'</span>:</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(dataset) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>            x_train <span class="op">=</span> dataset[<span class="dv">0</span>].copy()</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">'test인 경우 x 데이터만 필요합니다'</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'train 또는 test만 입력 가능합니다'</span></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (공통)결측치 대체 : occyp_type</span></span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fill_occyp_type(row):</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pd.isna(row[<span class="st">'occyp_type'</span>]):</span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> row[<span class="st">'DAYS_EMPLOYED'</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="st">'NoJob'</span></span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="st">'Missing'</span></span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> row[<span class="st">'occyp_type'</span>]</span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>    x_train[<span class="st">'occyp_type'</span>] <span class="op">=</span> x_train.<span class="bu">apply</span>(fill_occyp_type, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 범주형/수치형 변수로 분할하여 작업</span></span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>    x_numerical <span class="op">=</span> x_train.select_dtypes(include<span class="op">=</span>[<span class="st">'float64'</span>, <span class="st">'int64'</span>])</span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a>    x_categorical <span class="op">=</span> x_train.select_dtypes(include<span class="op">=</span>[<span class="st">'object'</span>])</span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (수치형변수 전처리) 이상치 대체   *** 주의 : 표준화 전에 수행되어야 함</span></span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a>    x_numerical[<span class="st">'DAYS_EMPLOYED'</span>] <span class="op">=</span> x_numerical[<span class="st">'DAYS_EMPLOYED'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x <span class="op">==</span> <span class="fl">365243.0</span> <span class="cf">else</span> x)</span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (수치형변수 전처리) 최소값 조정</span></span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a>    x_numerical[[<span class="st">'DAYS_BIRTH'</span>, <span class="st">'DAYS_EMPLOYED'</span>, <span class="st">'begin_month'</span>]] <span class="op">=</span> x_numerical[[<span class="st">'DAYS_BIRTH'</span>, <span class="st">'DAYS_EMPLOYED'</span>, <span class="st">'begin_month'</span>]] <span class="op">+</span> x_numerical[[<span class="st">'DAYS_BIRTH'</span>, <span class="st">'DAYS_EMPLOYED'</span>, <span class="st">'begin_month'</span>]].<span class="bu">min</span>()<span class="op">*-</span><span class="dv">1</span></span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (수치형변수 전처리) 로그변환</span></span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a>    x_numerical[<span class="st">'DAYS_EMPLOYED'</span>] <span class="op">=</span> x_numerical[<span class="st">'DAYS_EMPLOYED'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x : np.log1p(x))</span>
<span id="cb72-50"><a href="#cb72-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-51"><a href="#cb72-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (수치형변수 전처리) 표준화</span></span>
<span id="cb72-52"><a href="#cb72-52" aria-hidden="true" tabindex="-1"></a>    std_scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb72-53"><a href="#cb72-53" aria-hidden="true" tabindex="-1"></a>    x_numerical[[<span class="st">'DAYS_BIRTH'</span>, <span class="st">'begin_month'</span>]] <span class="op">=</span> std_scaler.fit_transform(x_numerical[[<span class="st">'DAYS_BIRTH'</span>, <span class="st">'begin_month'</span>]])</span>
<span id="cb72-54"><a href="#cb72-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-55"><a href="#cb72-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (수치형변수 전처리) 정규화</span></span>
<span id="cb72-56"><a href="#cb72-56" aria-hidden="true" tabindex="-1"></a>    min_max_scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb72-57"><a href="#cb72-57" aria-hidden="true" tabindex="-1"></a>    x_numerical[[<span class="st">'child_num'</span>, <span class="st">'income_total'</span>, <span class="st">'family_size'</span>]]  <span class="op">=</span> min_max_scaler.fit_transform(x_numerical[[<span class="st">'child_num'</span>, <span class="st">'income_total'</span>, <span class="st">'family_size'</span>]] )</span>
<span id="cb72-58"><a href="#cb72-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-59"><a href="#cb72-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (범주형변수 전처리) Label인코딩 (Ordinal변수)</span></span>
<span id="cb72-60"><a href="#cb72-60" aria-hidden="true" tabindex="-1"></a>    order <span class="op">=</span> [</span>
<span id="cb72-61"><a href="#cb72-61" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Lower secondary'</span>,</span>
<span id="cb72-62"><a href="#cb72-62" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Secondary / secondary special'</span>,</span>
<span id="cb72-63"><a href="#cb72-63" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Incomplete higher'</span>,</span>
<span id="cb72-64"><a href="#cb72-64" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Higher education'</span>,</span>
<span id="cb72-65"><a href="#cb72-65" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Academic degree'</span></span>
<span id="cb72-66"><a href="#cb72-66" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb72-67"><a href="#cb72-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-68"><a href="#cb72-68" aria-hidden="true" tabindex="-1"></a>    o_encoder <span class="op">=</span> OrdinalEncoder(categories<span class="op">=</span>[order])</span>
<span id="cb72-69"><a href="#cb72-69" aria-hidden="true" tabindex="-1"></a>    oe_df <span class="op">=</span> o_encoder.fit_transform(x_categorical[[<span class="st">'edu_type'</span>]])</span>
<span id="cb72-70"><a href="#cb72-70" aria-hidden="true" tabindex="-1"></a>    x_categorical[<span class="st">'edu_type'</span>] <span class="op">=</span> oe_df.flatten()</span>
<span id="cb72-71"><a href="#cb72-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-72"><a href="#cb72-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (범주형변수 전처리) One-hot인코딩 (Unique값 6개 이하)</span></span>
<span id="cb72-73"><a href="#cb72-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-74"><a href="#cb72-74" aria-hidden="true" tabindex="-1"></a>    <span class="co">## One-hot 인코딩 데이터프레임 생성</span></span>
<span id="cb72-75"><a href="#cb72-75" aria-hidden="true" tabindex="-1"></a>    one_hot_columns <span class="op">=</span> [<span class="st">'gender'</span>, <span class="st">'car'</span>, <span class="st">'reality'</span>, <span class="st">'income_type'</span>, <span class="st">'family_type'</span>, <span class="st">'house_type'</span>]</span>
<span id="cb72-76"><a href="#cb72-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-77"><a href="#cb72-77" aria-hidden="true" tabindex="-1"></a>    oh_encoder <span class="op">=</span> OneHotEncoder(sparse_output<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb72-78"><a href="#cb72-78" aria-hidden="true" tabindex="-1"></a>    onehot_encoded <span class="op">=</span> oh_encoder.fit_transform(x_categorical[one_hot_columns])</span>
<span id="cb72-79"><a href="#cb72-79" aria-hidden="true" tabindex="-1"></a>    encoded_col_names <span class="op">=</span> oh_encoder.get_feature_names_out(input_features<span class="op">=</span>one_hot_columns)</span>
<span id="cb72-80"><a href="#cb72-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-81"><a href="#cb72-81" aria-hidden="true" tabindex="-1"></a>    df_onehot_encoded <span class="op">=</span> pd.DataFrame(onehot_encoded, columns<span class="op">=</span>encoded_col_names, index<span class="op">=</span>x_categorical.index)</span>
<span id="cb72-82"><a href="#cb72-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-83"><a href="#cb72-83" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Ont-hot인코딩 대상 컬럼 미리 Drop (별도로 생성한 인코딩된 데이터프레임을 다시 합칠 예정)</span></span>
<span id="cb72-84"><a href="#cb72-84" aria-hidden="true" tabindex="-1"></a>    x_categorical.drop(one_hot_columns, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb72-85"><a href="#cb72-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-86"><a href="#cb72-86" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Ont-hot인코딩된 데이터프레임 Concat</span></span>
<span id="cb72-87"><a href="#cb72-87" aria-hidden="true" tabindex="-1"></a>    x_categorical <span class="op">=</span> pd.concat([x_categorical, df_onehot_encoded], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb72-88"><a href="#cb72-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-89"><a href="#cb72-89" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (범주형변수 전처리) Target인코딩 (Ordinal이 아니면서 Unique값이 많은 경우)</span></span>
<span id="cb72-90"><a href="#cb72-90" aria-hidden="true" tabindex="-1"></a>    x_column <span class="op">=</span> <span class="st">'occyp_type'</span></span>
<span id="cb72-91"><a href="#cb72-91" aria-hidden="true" tabindex="-1"></a>                                </span>
<span id="cb72-92"><a href="#cb72-92" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 파일로 저장해둔 인코더가 있으면 로딩, 아니면 생성</span></span>
<span id="cb72-93"><a href="#cb72-93" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> os.path.isfile(<span class="st">'encoder_leave_one_out.pkl'</span>):</span>
<span id="cb72-94"><a href="#cb72-94" aria-hidden="true" tabindex="-1"></a>        leave_one_out_encoder <span class="op">=</span> joblib.load(<span class="st">'encoder_leave_one_out.pkl'</span>)</span>
<span id="cb72-95"><a href="#cb72-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb72-96"><a href="#cb72-96" aria-hidden="true" tabindex="-1"></a>        leave_one_out_encoder <span class="op">=</span> ce.LeaveOneOutEncoder(cols<span class="op">=</span>x_column, sigma<span class="op">=</span><span class="fl">0.1</span>, return_df<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb72-97"><a href="#cb72-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-98"><a href="#cb72-98" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 인코딩된 데이터 생성 및 인코더 업데이트</span></span>
<span id="cb72-99"><a href="#cb72-99" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> train_or_test <span class="op">==</span> <span class="st">'train'</span>:</span>
<span id="cb72-100"><a href="#cb72-100" aria-hidden="true" tabindex="-1"></a>        df_target_encoded <span class="op">=</span> leave_one_out_encoder.fit_transform(x_categorical[x_column], y_train)</span>
<span id="cb72-101"><a href="#cb72-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> train_or_test <span class="op">==</span> <span class="st">'test'</span>:</span>
<span id="cb72-102"><a href="#cb72-102" aria-hidden="true" tabindex="-1"></a>        df_target_encoded <span class="op">=</span> leave_one_out_encoder.transform(x_categorical[x_column])</span>
<span id="cb72-103"><a href="#cb72-103" aria-hidden="true" tabindex="-1"></a>    joblib.dump(leave_one_out_encoder, <span class="st">'encoder_leave_one_out.pkl'</span>)</span>
<span id="cb72-104"><a href="#cb72-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-105"><a href="#cb72-105" aria-hidden="true" tabindex="-1"></a>    x_categorical[<span class="st">'occyp_type'</span>] <span class="op">=</span> df_target_encoded[<span class="st">'occyp_type'</span>]</span>
<span id="cb72-106"><a href="#cb72-106" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb72-107"><a href="#cb72-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-108"><a href="#cb72-108" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 나누어 작업한 수치형/범주형 변수 합치고 저장</span></span>
<span id="cb72-109"><a href="#cb72-109" aria-hidden="true" tabindex="-1"></a>    x_train_preprocessed <span class="op">=</span> pd.concat([x_categorical, x_numerical], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb72-110"><a href="#cb72-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-111"><a href="#cb72-111" aria-hidden="true" tabindex="-1"></a>    <span class="co">## CSV저장 </span></span>
<span id="cb72-112"><a href="#cb72-112" aria-hidden="true" tabindex="-1"></a>    x_train_preprocessed.to_csv(output_name[<span class="st">'csv_file_name'</span>]) <span class="co"># 'train_preprocessed.csv'</span></span>
<span id="cb72-113"><a href="#cb72-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-114"><a href="#cb72-114" aria-hidden="true" tabindex="-1"></a>    <span class="co">## DB저장 (아래 함수는 이미 테이블이 있는 경우 덮어씀)</span></span>
<span id="cb72-115"><a href="#cb72-115" aria-hidden="true" tabindex="-1"></a>    db_controller.df_to_table(output_name[<span class="st">'db_table_name'</span>], x_train_preprocessed) <span class="co"># 'train_pre'</span></span>
<span id="cb72-116"><a href="#cb72-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-117"><a href="#cb72-117" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'작업이 완료되었습니다'</span></span>
<span id="cb72-118"><a href="#cb72-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-119"><a href="#cb72-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-120"><a href="#cb72-120" aria-hidden="true" tabindex="-1"></a><span class="co"># DB로딩 및 데이터 가져오기</span></span>
<span id="cb72-121"><a href="#cb72-121" aria-hidden="true" tabindex="-1"></a>db_controller <span class="op">=</span> DB_sqlite3(<span class="st">'Dacon_creditcard_overdue.db'</span>)</span>
<span id="cb72-122"><a href="#cb72-122" aria-hidden="true" tabindex="-1"></a>df_train <span class="op">=</span> db_controller.search_db_show_df(<span class="st">'SELECT * FROM train'</span>)</span>
<span id="cb72-123"><a href="#cb72-123" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> db_controller.search_db_show_df(<span class="st">'SELECT * FROM test'</span>)</span>
<span id="cb72-124"><a href="#cb72-124" aria-hidden="true" tabindex="-1"></a>df_sample_submission <span class="op">=</span> db_controller.search_db_show_df(<span class="st">'SELECT * FROM sample_submission'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b1b63821" class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># train 데이터 전처리</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> df_train[<span class="st">'credit'</span>].copy()</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>x_train <span class="op">=</span> df_train.drop(<span class="st">'credit'</span>,axis<span class="op">=</span><span class="dv">1</span>).copy()</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>preprocess_x_data(train_or_test<span class="op">=</span><span class="st">'train'</span>, </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>                  dataset<span class="op">=</span>[x_train, y_train], </span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>                  output_name<span class="op">=</span>{<span class="st">'csv_file_name'</span>:<span class="st">'train_preprocessed.csv'</span>, </span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>                               <span class="st">'db_table_name'</span>:<span class="st">'train_pre'</span>}</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>                  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'작업이 완료되었습니다'</code></pre>
</div>
</div>
<div id="49912dc1" class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 전처리된 데이터 확인</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>db_controller.search_db_show_df(<span class="st">"SELECT * FROM train_pre"</span>).head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">edu_type</th>
<th data-quarto-table-cell-role="th">occyp_type</th>
<th data-quarto-table-cell-role="th">gender_F</th>
<th data-quarto-table-cell-role="th">gender_M</th>
<th data-quarto-table-cell-role="th">car_N</th>
<th data-quarto-table-cell-role="th">car_Y</th>
<th data-quarto-table-cell-role="th">reality_N</th>
<th data-quarto-table-cell-role="th">reality_Y</th>
<th data-quarto-table-cell-role="th">income_type_Commercial associate</th>
<th data-quarto-table-cell-role="th">income_type_Pensioner</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">child_num</th>
<th data-quarto-table-cell-role="th">income_total</th>
<th data-quarto-table-cell-role="th">DAYS_BIRTH</th>
<th data-quarto-table-cell-role="th">DAYS_EMPLOYED</th>
<th data-quarto-table-cell-role="th">FLAG_MOBIL</th>
<th data-quarto-table-cell-role="th">work_phone</th>
<th data-quarto-table-cell-role="th">phone</th>
<th data-quarto-table-cell-role="th">email</th>
<th data-quarto-table-cell-role="th">family_size</th>
<th data-quarto-table-cell-role="th">begin_month</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>3.0</td>
<td>1.477037</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.000000</td>
<td>0.113372</td>
<td>0.556662</td>
<td>11004.0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0.052632</td>
<td>1.215231</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.0</td>
<td>1.417380</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.052632</td>
<td>0.142442</td>
<td>0.870181</td>
<td>14173.0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0.105263</td>
<td>1.275620</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3.0</td>
<td>1.452349</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.000000</td>
<td>0.273256</td>
<td>-0.402621</td>
<td>11279.0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0.052632</td>
<td>0.249003</td>
</tr>
</tbody>
</table>

<p>3 rows × 35 columns</p>
</div>
</div>
</div>
<div id="2930c4e1" class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test 데이터 전처리</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> db_controller.search_db_show_df(<span class="st">'SELECT * FROM test'</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>preprocess_x_data(train_or_test<span class="op">=</span><span class="st">'test'</span>, </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>                  dataset<span class="op">=</span>[df_test], </span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>                  output_name<span class="op">=</span>{<span class="st">'csv_file_name'</span>:<span class="st">'test_preprocessed.csv'</span>, </span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>                               <span class="st">'db_table_name'</span>:<span class="st">'test_pre'</span>}</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>                  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'작업이 완료되었습니다'</code></pre>
</div>
</div>
<div id="2a47510d" class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 전처리된 데이터 확인</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>db_controller.search_db_show_df(<span class="st">"SELECT * FROM test_pre"</span>).head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">edu_type</th>
<th data-quarto-table-cell-role="th">occyp_type</th>
<th data-quarto-table-cell-role="th">gender_F</th>
<th data-quarto-table-cell-role="th">gender_M</th>
<th data-quarto-table-cell-role="th">car_N</th>
<th data-quarto-table-cell-role="th">car_Y</th>
<th data-quarto-table-cell-role="th">reality_N</th>
<th data-quarto-table-cell-role="th">reality_Y</th>
<th data-quarto-table-cell-role="th">income_type_Commercial associate</th>
<th data-quarto-table-cell-role="th">income_type_Pensioner</th>
<th data-quarto-table-cell-role="th">income_type_State servant</th>
<th data-quarto-table-cell-role="th">income_type_Student</th>
<th data-quarto-table-cell-role="th">income_type_Working</th>
<th data-quarto-table-cell-role="th">family_type_Civil marriage</th>
<th data-quarto-table-cell-role="th">family_type_Married</th>
<th data-quarto-table-cell-role="th">family_type_Separated</th>
<th data-quarto-table-cell-role="th">family_type_Single / not married</th>
<th data-quarto-table-cell-role="th">family_type_Widow</th>
<th data-quarto-table-cell-role="th">house_type_Co-op apartment</th>
<th data-quarto-table-cell-role="th">house_type_House / apartment</th>
<th data-quarto-table-cell-role="th">house_type_Municipal apartment</th>
<th data-quarto-table-cell-role="th">house_type_Office apartment</th>
<th data-quarto-table-cell-role="th">house_type_Rented apartment</th>
<th data-quarto-table-cell-role="th">house_type_With parents</th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">child_num</th>
<th data-quarto-table-cell-role="th">income_total</th>
<th data-quarto-table-cell-role="th">DAYS_BIRTH</th>
<th data-quarto-table-cell-role="th">DAYS_EMPLOYED</th>
<th data-quarto-table-cell-role="th">FLAG_MOBIL</th>
<th data-quarto-table-cell-role="th">work_phone</th>
<th data-quarto-table-cell-role="th">phone</th>
<th data-quarto-table-cell-role="th">email</th>
<th data-quarto-table-cell-role="th">family_size</th>
<th data-quarto-table-cell-role="th">begin_month</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.0</td>
<td>1.514196</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>26457</td>
<td>-0.596243</td>
<td>-0.714468</td>
<td>0.179018</td>
<td>15662.0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>-0.225667</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3.0</td>
<td>1.502646</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>26458</td>
<td>-0.596243</td>
<td>-0.492869</td>
<td>0.350337</td>
<td>6990.0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>-0.225667</td>
<td>0.400000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1.0</td>
<td>1.500443</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>26459</td>
<td>-0.596243</td>
<td>-1.139229</td>
<td>0.524543</td>
<td>15444.0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>-0.225667</td>
<td>0.333333</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="c41678fa" class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DB연결해제</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>db_controller.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

<p><br><strong>Copyright © 2024 Kibok Park All rights reserved.</strong><br></p></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/kr9268\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="kr9268/giscus_for_blog" data-repo-id="R_kgDOL0Sthw" data-category="General" data-category-id="DIC_kwDOL0Sth84Ce_5h" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<script>
    const baseFontSize = parseFloat(getComputedStyle(document.documentElement).fontSize);
    const watermark = new XWatermark.XWatermark();
    watermark.init("Kibok Park", {
      parentSelector: "body",
      prevent: true,
      observer: true,
      mode: "normal",
      font: "system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', 'Noto Sans', 'Liberation Sans', Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'",
      fontsize: baseFontSize * 1.000000,
      angle: -15.000000,
      color: "#000000",
      alpha: 0.100000,
      cols: 10,
      rows: 50,
      xSpace: baseFontSize * 4.000000,
      ySpace: baseFontSize * 4.000000,
      zIndex: -1
    });
    </script>




</body></html>