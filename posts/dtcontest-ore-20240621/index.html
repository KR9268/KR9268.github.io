<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kibok Park">
<meta name="dcterms.date" content="2024-06-21">

<title>Blog - [공모전] 공공데이터 공모전-6(니켈기준 Plot짜보기)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../profile.jpg" rel="icon" type="image/jpeg">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/watermark-1.0.11/watermark.min.js"></script>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-LPL499WQBH"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-LPL499WQBH', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index_dashboards.html"> 
<span class="menu-text">Dashboards</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../index_miniprojects.html"> 
<span class="menu-text">Mini Projects</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/KR9268"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/%EA%B8%B0%EB%B3%B5-%EB%B0%95-573a68268/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">[공모전] 공공데이터 공모전-6(니켈기준 Plot짜보기)</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">공모전</div>
                <div class="quarto-category">공공데이터</div>
                <div class="quarto-category">분석</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Kibok Park </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 21, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#개요" id="toc-개요" class="nav-link active" data-scroll-target="#개요">개요</a></li>
  <li><a href="#내용정리" id="toc-내용정리" class="nav-link" data-scroll-target="#내용정리">내용정리</a>
  <ul class="collapse">
  <li><a href="#지난-회의정리" id="toc-지난-회의정리" class="nav-link" data-scroll-target="#지난-회의정리">지난 회의정리</a></li>
  <li><a href="#회의내용에-대한-self고찰-및-아이디어-develope" id="toc-회의내용에-대한-self고찰-및-아이디어-develope" class="nav-link" data-scroll-target="#회의내용에-대한-self고찰-및-아이디어-develope">회의내용에 대한 Self고찰 및 아이디어 Develope</a></li>
  <li><a href="#보고내용-jupyter작성-초안" id="toc-보고내용-jupyter작성-초안" class="nav-link" data-scroll-target="#보고내용-jupyter작성-초안">보고내용 Jupyter작성 초안</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>2024년 12회 산업통상자원부 공공데이터 활용 아이디어 공모전 참가 기록.(니켈기준 Plot짜보기)</p>
<section id="개요" class="level2">
<h2 class="anchored" data-anchor-id="개요">개요</h2>
<ul>
<li>2024년 12회 산업통상자원부 공공데이터 활용 아이디어 공모전 참가해보기로 함
<ul>
<li>https://datacontest.kr/apply/applyAdd/3</li>
</ul></li>
<li>각자 광물 하나씩 담당해서 러프하게 보고서 Plot짜보기</li>
</ul>
</section>
<section id="내용정리" class="level2">
<h2 class="anchored" data-anchor-id="내용정리">내용정리</h2>
<section id="지난-회의정리" class="level3">
<h3 class="anchored" data-anchor-id="지난-회의정리">지난 회의정리</h3>
<ul>
<li>국제거래 관련 데이터는 <code>UN Comtrade database</code> 활용하기</li>
<li>아래 4개 광물에 대해 분석 진행하고, HSCODE기준 적용
<ul>
<li><code>리튬</code> : 산화/수산화리튬(282520), 탄산리튬(283691)</li>
<li><code>코발트</code> : 산화/수산화코발트(282200), 황산코발트(283329)</li>
<li><code>망간</code> : 이산화망간(850610)</li>
<li><code>니켈</code> : 산화/수산화니켈(282540), 황산니켈(283324)</li>
</ul></li>
<li>각자 광물을 1~2개 담당해서 <code>공모전 보고서 양식</code>에 맞게 고민해보기
<ul>
<li>분석 배경</li>
<li>어떤 Feature와 모델 사용</li>
<li>기대효과</li>
</ul></li>
</ul>
</section>
<section id="회의내용에-대한-self고찰-및-아이디어-develope" class="level3">
<h3 class="anchored" data-anchor-id="회의내용에-대한-self고찰-및-아이디어-develope">회의내용에 대한 Self고찰 및 아이디어 Develope</h3>
<ul>
<li><p>기존에 니켈에 대해 분석한게 있어서 해당 내용으로 정리해보기</p>
<ul>
<li><p><code>제안배경</code></p>
<ul>
<li>니켈의 용도</li>
<li>니켈의 국가별 소비량 급증(공공데이터포털의 데이터 기준)
<ul>
<li>2011년 대비 2배이상 전체 소비량 증가</li>
<li>중국, 인도네시아를 중심으로 소비량이 대폭 증가함</li>
</ul></li>
<li>니켈의 국가별 생산량 편중(공공데이터포털의 데이터 기준)
<ul>
<li>데이터에 Mine, Refined로 2종류가 있었음</li>
<li>니켈은 해외에서 가공된 형태를 수입하여 사용, 국산화 진행중
<ul>
<li>Refined만 추려서 산출하기로 함</li>
</ul></li>
<li>중국 34.3%, 인도네시아 20.3%로 2개 국가가 과반수</li>
</ul></li>
</ul></li>
<li><p><code>제안배경 요약</code> : 니켈의 소비량 증가와 생산량 편중으로, 공급 리스크가 큰 상황에서 위기요소 탐지의 필요성 대두</p></li>
<li><p><code>고려요소(사용하고자 한 Feature)</code></p>
<ul>
<li><code>생산국 수출량</code> : 광물의 특정 생산국 비중이 높은 점을 고려하여, 해당 국가의 광물 수출량의 이상탐지</li>
<li><code>수입국 수입량</code> : 광물을 수입하는 타 국가의 수입량 증감을 확인하여 이상탐지</li>
<li><code>생산국 판매액</code> : 주요 생산국의 대외 판매액을 기준으로 광물의 가격변동을 탐지
<ul>
<li>기준 : FOB가격(물류나 보험료를 제외한 순수 물품가격)을 판매량으로 나누어 kg당 가격 산출
<ul>
<li>다만 데이터를 보니 Null인 경우가 있어 primaryvalue라는 가격컬럼을 사용키로 함</li>
</ul></li>
</ul></li>
<li><code>BDI(Baltic Dry Index)</code> : 광물이 수입을 통해 조달된다는 점과, 광물운송은 벌크선을 통해 진행됨을 착안하여 물류문제에 대한 이상탐지 요소로 포함
<ul>
<li>벌크선의 수요/가격에 대한 측면뿐 아니라 경기선행지표로도 사용되고 있음(원자재의 이동을 통해 생산증가 등의 예측)</li>
</ul></li>
</ul></li>
<li><p><code>각 Feature의 전처리 방안</code></p>
<ul>
<li><code>Period를 기준으로</code> 국가별 합산(groupby)</li>
<li>사용하고자 하는 컬럼(가격, 수출입량)이 null인 경우에만 drop</li>
<li><code>Exponential smoothing 모델</code>에 넣어 예측값 산출예정으로 yyyymmdd포맷으로 날짜 처리</li>
<li>실제값+예측값을 합친 후 Anomality패키지(<code>R의 AnomalyDetection 이상탐지 패키지</code>)로 이상탐지</li>
<li>각 Period별로 이상치가 발생한 <code>Feature의 수를 합산하여 구간척도로 위기구간을 제안</code> (정상/경계/주의/위기 등)</li>
</ul></li>
<li><p><code>기대효과</code>는 시간부족으로 향후 고민</p>
<ul>
<li>모델에서 예측한 미래구간에서 위기가 탐지되는 경우, 사전 구매 등 광물의 비축 등을 미리 진행</li>
<li>위의 사항을 통한 공급망리스크 회피 및 자국 핵심산업 경쟁력 확보</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="보고내용-jupyter작성-초안" class="level3">
<h3 class="anchored" data-anchor-id="보고내용-jupyter작성-초안">보고내용 Jupyter작성 초안</h3>
<section id="제안배경" class="level4">
<h4 class="anchored" data-anchor-id="제안배경">제안배경</h4>
<ul>
<li>작성시 참고사항 : 관련 현황 및 문제점 등 빅데이터 분석을 구상하고 제안한 배경에 대해서 작성 (활용 분야, 활용빈도, 중요성 등)</li>
</ul>
<ol type="1">
<li><p>니켈은 배터리 및 연료전지 소재, 다양한 촉매, 태양광 지지대의 도금, 내부식성이 필요한 해양구조물 등에 사용 (재생에너지, 친황경자동차 분야에 필수적)</p></li>
<li><p>니켈의 국가별 소비량은 급증하고 있음 (보고서는 하단의 시각화 그래프만 사용)</p></li>
</ol>
<ul>
<li>4차 핵심사업에 소요되는 광물로 2011년 대비 소비량 약 2배 증가</li>
</ul>
<div id="0ad9e571" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 한국광해광업공단_광종별 소비현황에 대한 주소를 하단 `데이터 현황`에서 url부분에 붙여넣기</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/KR9268/db_datagokr/main/komir_consume.csv'</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>df_consume <span class="op">=</span> pd.read_csv(url, encoding<span class="op">=</span><span class="st">'cp949'</span>, low_memory<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>df_consume_nickel <span class="op">=</span> df_consume[df_consume[<span class="st">'광종'</span>]<span class="op">==</span><span class="st">'니켈'</span>]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>df_consume_nickel.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">2011 소비량</th>
<th data-quarto-table-cell-role="th">2012 소비량</th>
<th data-quarto-table-cell-role="th">2013 소비량</th>
<th data-quarto-table-cell-role="th">2014 소비량</th>
<th data-quarto-table-cell-role="th">2015 소비량</th>
<th data-quarto-table-cell-role="th">2016 소비량</th>
<th data-quarto-table-cell-role="th">2017 소비량</th>
<th data-quarto-table-cell-role="th">2018 소비량</th>
<th data-quarto-table-cell-role="th">2019 소비량</th>
<th data-quarto-table-cell-role="th">2020 소비량</th>
<th data-quarto-table-cell-role="th">2021 소비량</th>
<th data-quarto-table-cell-role="th">2022 소비량</th>
<th data-quarto-table-cell-role="th">2023 소비량</th>
<th data-quarto-table-cell-role="th">광종</th>
<th data-quarto-table-cell-role="th">국가</th>
<th data-quarto-table-cell-role="th">단위</th>
<th data-quarto-table-cell-role="th">대륙</th>
<th data-quarto-table-cell-role="th">품목</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">224</td>
<td>9.334</td>
<td>8.391</td>
<td>7.965</td>
<td>7.571</td>
<td>6.667</td>
<td>7.021</td>
<td>8.423</td>
<td>7.978</td>
<td>9.052</td>
<td>10.016</td>
<td>6.101</td>
<td>7.152</td>
<td>8.386</td>
<td>니켈</td>
<td>Austria</td>
<td>천톤</td>
<td>EUROPE</td>
<td>refined</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">225</td>
<td>29.794</td>
<td>18.827</td>
<td>26.000</td>
<td>29.129</td>
<td>35.022</td>
<td>31.415</td>
<td>29.080</td>
<td>34.137</td>
<td>35.190</td>
<td>33.392</td>
<td>34.046</td>
<td>25.826</td>
<td>34.825</td>
<td>니켈</td>
<td>Belgium</td>
<td>천톤</td>
<td>EUROPE</td>
<td>refined</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">226</td>
<td>0.157</td>
<td>0.125</td>
<td>0.141</td>
<td>0.137</td>
<td>0.167</td>
<td>0.120</td>
<td>0.114</td>
<td>0.134</td>
<td>0.149</td>
<td>0.179</td>
<td>0.211</td>
<td>0.185</td>
<td>0.149</td>
<td>니켈</td>
<td>Bulgaria</td>
<td>천톤</td>
<td>EUROPE</td>
<td>refined</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">227</td>
<td>3.595</td>
<td>1.891</td>
<td>0.410</td>
<td>3.011</td>
<td>2.882</td>
<td>2.997</td>
<td>2.870</td>
<td>2.163</td>
<td>2.223</td>
<td>2.000</td>
<td>2.297</td>
<td>1.513</td>
<td>1.827</td>
<td>니켈</td>
<td>Czech Republic</td>
<td>천톤</td>
<td>EUROPE</td>
<td>refined</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">228</td>
<td>0.046</td>
<td>0.189</td>
<td>0.063</td>
<td>0.056</td>
<td>0.242</td>
<td>0.372</td>
<td>0.346</td>
<td>0.589</td>
<td>0.544</td>
<td>0.397</td>
<td>0.269</td>
<td>0.560</td>
<td>0.517</td>
<td>니켈</td>
<td>Denmark</td>
<td>천톤</td>
<td>EUROPE</td>
<td>refined</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="d69095dd" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 단위가 여럿인 경우 등 확인 후 통일</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> each_column <span class="kw">in</span> df_consume_nickel.columns:</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'소비량'</span> <span class="kw">not</span> <span class="kw">in</span> each_column:</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>each_column<span class="sc">}</span><span class="ss"> : </span><span class="sc">{</span>df_consume_nickel[each_column]<span class="sc">.</span>unique()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>광종 : ['니켈']
국가 : ['Austria' 'Belgium' 'Bulgaria' 'Czech Republic' 'Denmark' 'Finland'
 'France' 'Germany' 'Greece' 'Hungary' 'Italy' 'Macedonia' 'Norway'
 'Poland' 'Portugal' 'Romania' 'Russia' 'Serbia' 'Slovenia' 'Spain'
 'Sweden' 'Switzerland' 'Ukraine' 'United Kingdom' 'South Africa' 'China'
 'Hong Kong' 'India' 'Indonesia' 'Japan' 'Kazakhstan' 'Malaysia'
 'North Korea' 'Philippines' 'Saudi Arabia' 'Singapore' 'South Korea'
 'Taiwan' 'Thailand' 'Turkey' 'United Arab Emirates' 'Vietnam' 'Argentina'
 'Brazil' 'Canada' 'Chile' 'Cuba' 'Mexico' 'U.S.A.' 'Australia'
 'New Zealand']
단위 : ['천톤']
대륙 : ['EUROPE' 'AFRICA' 'ASIA' 'AMERICA' 'OCEANIA']
품목 : ['refined']</code></pre>
</div>
</div>
<div id="b9cade0e" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 단일 항목인 광종, 단위, 품목 제거 (메모리확보 7.6+ KB → 6.4+ KB)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df_consume_nickel <span class="op">=</span> df_consume_nickel[[<span class="st">'2011 소비량'</span>, <span class="st">'2012 소비량'</span>, <span class="st">'2013 소비량'</span>, <span class="st">'2014 소비량'</span>, <span class="st">'2015 소비량'</span>, <span class="st">'2016 소비량'</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'2017 소비량'</span>, <span class="st">'2018 소비량'</span>, <span class="st">'2019 소비량'</span>, <span class="st">'2020 소비량'</span>, <span class="st">'2021 소비량'</span>, <span class="st">'2022 소비량'</span>, <span class="st">'2023 소비량'</span>, <span class="st">'국가'</span>, <span class="st">'대륙'</span>,<span class="st">'품목'</span>]]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>df_consume_nickel.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">2011 소비량</th>
<th data-quarto-table-cell-role="th">2012 소비량</th>
<th data-quarto-table-cell-role="th">2013 소비량</th>
<th data-quarto-table-cell-role="th">2014 소비량</th>
<th data-quarto-table-cell-role="th">2015 소비량</th>
<th data-quarto-table-cell-role="th">2016 소비량</th>
<th data-quarto-table-cell-role="th">2017 소비량</th>
<th data-quarto-table-cell-role="th">2018 소비량</th>
<th data-quarto-table-cell-role="th">2019 소비량</th>
<th data-quarto-table-cell-role="th">2020 소비량</th>
<th data-quarto-table-cell-role="th">2021 소비량</th>
<th data-quarto-table-cell-role="th">2022 소비량</th>
<th data-quarto-table-cell-role="th">2023 소비량</th>
<th data-quarto-table-cell-role="th">국가</th>
<th data-quarto-table-cell-role="th">대륙</th>
<th data-quarto-table-cell-role="th">품목</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">224</td>
<td>9.334</td>
<td>8.391</td>
<td>7.965</td>
<td>7.571</td>
<td>6.667</td>
<td>7.021</td>
<td>8.423</td>
<td>7.978</td>
<td>9.052</td>
<td>10.016</td>
<td>6.101</td>
<td>7.152</td>
<td>8.386</td>
<td>Austria</td>
<td>EUROPE</td>
<td>refined</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">225</td>
<td>29.794</td>
<td>18.827</td>
<td>26.000</td>
<td>29.129</td>
<td>35.022</td>
<td>31.415</td>
<td>29.080</td>
<td>34.137</td>
<td>35.190</td>
<td>33.392</td>
<td>34.046</td>
<td>25.826</td>
<td>34.825</td>
<td>Belgium</td>
<td>EUROPE</td>
<td>refined</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">226</td>
<td>0.157</td>
<td>0.125</td>
<td>0.141</td>
<td>0.137</td>
<td>0.167</td>
<td>0.120</td>
<td>0.114</td>
<td>0.134</td>
<td>0.149</td>
<td>0.179</td>
<td>0.211</td>
<td>0.185</td>
<td>0.149</td>
<td>Bulgaria</td>
<td>EUROPE</td>
<td>refined</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">227</td>
<td>3.595</td>
<td>1.891</td>
<td>0.410</td>
<td>3.011</td>
<td>2.882</td>
<td>2.997</td>
<td>2.870</td>
<td>2.163</td>
<td>2.223</td>
<td>2.000</td>
<td>2.297</td>
<td>1.513</td>
<td>1.827</td>
<td>Czech Republic</td>
<td>EUROPE</td>
<td>refined</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">228</td>
<td>0.046</td>
<td>0.189</td>
<td>0.063</td>
<td>0.056</td>
<td>0.242</td>
<td>0.372</td>
<td>0.346</td>
<td>0.589</td>
<td>0.544</td>
<td>0.397</td>
<td>0.269</td>
<td>0.560</td>
<td>0.517</td>
<td>Denmark</td>
<td>EUROPE</td>
<td>refined</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>전체 소비량 증가</li>
</ul>
<div id="07ee4287" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> koreanize_matplotlib</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">4</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>sns.lineplot(df_consume_nickel.<span class="bu">sum</span>(numeric_only<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'니켈 소비량 추이'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>Text(0.5, 1.0, '니켈 소비량 추이')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-5-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>국가별 소비량 증가
<ul>
<li>중국, 인도네시아를 중심으로 2011년 대비 소비량 대폭 증가</li>
</ul></li>
</ul>
<div id="918334d3" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>nickel_by_country <span class="op">=</span> df_consume_nickel.groupby(<span class="st">'국가'</span>).<span class="bu">sum</span>(numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>nickel_by_country.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">2011 소비량</th>
<th data-quarto-table-cell-role="th">2012 소비량</th>
<th data-quarto-table-cell-role="th">2013 소비량</th>
<th data-quarto-table-cell-role="th">2014 소비량</th>
<th data-quarto-table-cell-role="th">2015 소비량</th>
<th data-quarto-table-cell-role="th">2016 소비량</th>
<th data-quarto-table-cell-role="th">2017 소비량</th>
<th data-quarto-table-cell-role="th">2018 소비량</th>
<th data-quarto-table-cell-role="th">2019 소비량</th>
<th data-quarto-table-cell-role="th">2020 소비량</th>
<th data-quarto-table-cell-role="th">2021 소비량</th>
<th data-quarto-table-cell-role="th">2022 소비량</th>
<th data-quarto-table-cell-role="th">2023 소비량</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">국가</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Argentina</td>
<td>0.974</td>
<td>0.806</td>
<td>0.892</td>
<td>0.501</td>
<td>0.528</td>
<td>0.475</td>
<td>0.535</td>
<td>0.523</td>
<td>0.526</td>
<td>0.274</td>
<td>0.544</td>
<td>0.443</td>
<td>0.452</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Australia</td>
<td>1.600</td>
<td>1.600</td>
<td>1.600</td>
<td>1.600</td>
<td>1.608</td>
<td>1.600</td>
<td>1.600</td>
<td>1.600</td>
<td>1.600</td>
<td>1.600</td>
<td>1.600</td>
<td>1.600</td>
<td>1.600</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Austria</td>
<td>9.334</td>
<td>8.391</td>
<td>7.965</td>
<td>7.571</td>
<td>6.667</td>
<td>7.021</td>
<td>8.423</td>
<td>7.978</td>
<td>9.052</td>
<td>10.016</td>
<td>6.101</td>
<td>7.152</td>
<td>8.386</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Belgium</td>
<td>29.794</td>
<td>18.827</td>
<td>26.000</td>
<td>29.129</td>
<td>35.022</td>
<td>31.415</td>
<td>29.080</td>
<td>34.137</td>
<td>35.190</td>
<td>33.392</td>
<td>34.046</td>
<td>25.826</td>
<td>34.825</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Brazil</td>
<td>26.910</td>
<td>22.455</td>
<td>21.180</td>
<td>26.616</td>
<td>18.062</td>
<td>25.506</td>
<td>22.269</td>
<td>22.376</td>
<td>16.480</td>
<td>12.062</td>
<td>17.697</td>
<td>17.782</td>
<td>11.645</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="114a7124" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 표준편차가 상위 10개 국가 추출</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>described_nickel_by_country <span class="op">=</span> nickel_by_country.transpose().describe()</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>std_described_nickel_by_country <span class="op">=</span> described_nickel_by_country.loc[<span class="st">'std'</span>].sort_values(ascending<span class="op">=</span><span class="va">False</span>)[<span class="dv">0</span>:<span class="dv">10</span>]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>std_described_nickel_by_country</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>국가
China           440.092028
Indonesia       154.306424
India            18.577287
U.S.A.           16.972706
Taiwan           16.607094
South Africa     12.951598
Germany          12.118787
Japan             9.753820
South Korea       9.739035
Italy             9.129311
Name: std, dtype: float64</code></pre>
</div>
</div>
<div id="1c08c664" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 표준편차 상위 10개국 그래프</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>index_country <span class="op">=</span> std_described_nickel_by_country.index.tolist()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">5</span>))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>sns.lineplot(nickel_by_country.transpose()[index_country])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="1aac79af" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 표준편차 상위 10개국 중 중국제외한 그래프</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>index_country.remove(<span class="st">'China'</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">5</span>))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>sns.lineplot(nickel_by_country.transpose()[index_country])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="052117df" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 표준편차 상위 10개국 중 인도네시아 제외한 그래프</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>index_country.remove(<span class="st">'Indonesia'</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">5</span>))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>sns.lineplot(nickel_by_country.transpose()[index_country])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<ol start="3" type="1">
<li>니켈의 생산량</li>
</ol>
<ul>
<li>주요 2개국 생산량이 58.3%로 편중(인도네시아, 중국, Refined니켈 기준)</li>
</ul>
<div id="6f88a14b" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 한국광해광업공단_광종별 소비현황에 대한 주소를 하단 `데이터 현황`에서 url부분에 붙여넣기</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/KR9268/db_datagokr/main/komir_product_country.csv'</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>df_product <span class="op">=</span> pd.read_csv(url, encoding<span class="op">=</span><span class="st">'cp949'</span>, low_memory<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>df_product.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">2011 생산량</th>
<th data-quarto-table-cell-role="th">2012 생산량</th>
<th data-quarto-table-cell-role="th">2013 생산량</th>
<th data-quarto-table-cell-role="th">2014 생산량</th>
<th data-quarto-table-cell-role="th">2015 생산량</th>
<th data-quarto-table-cell-role="th">2016 생산량</th>
<th data-quarto-table-cell-role="th">2017 생산량</th>
<th data-quarto-table-cell-role="th">2018 생산량</th>
<th data-quarto-table-cell-role="th">2019 생산량</th>
<th data-quarto-table-cell-role="th">2020 생산량</th>
<th data-quarto-table-cell-role="th">2021 생산량</th>
<th data-quarto-table-cell-role="th">2022 생산량</th>
<th data-quarto-table-cell-role="th">2023 생산량</th>
<th data-quarto-table-cell-role="th">광종</th>
<th data-quarto-table-cell-role="th">국가</th>
<th data-quarto-table-cell-role="th">단위</th>
<th data-quarto-table-cell-role="th">대륙</th>
<th data-quarto-table-cell-role="th">품목</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>561.354</td>
<td>800.316</td>
<td>657.1</td>
<td>605.215</td>
<td>787.404</td>
<td>738.612</td>
<td>740.380</td>
<td>760.244</td>
<td>1043.343</td>
<td>619.748</td>
<td>675.269</td>
<td>669.926</td>
<td>542.114</td>
<td>알루미늄</td>
<td>Bosnia</td>
<td>천톤</td>
<td>EUROPE</td>
<td>bauxite</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.000</td>
<td>0.000</td>
<td>0.0</td>
<td>0.000</td>
<td>11.900</td>
<td>9.800</td>
<td>12.200</td>
<td>11.800</td>
<td>14.300</td>
<td>14.100</td>
<td>14.500</td>
<td>13.800</td>
<td>13.800</td>
<td>알루미늄</td>
<td>Croatia</td>
<td>천톤</td>
<td>EUROPE</td>
<td>bauxite</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>80.800</td>
<td>90.129</td>
<td>100.0</td>
<td>71.100</td>
<td>70.000</td>
<td>110.000</td>
<td>110.000</td>
<td>110.000</td>
<td>120.760</td>
<td>123.496</td>
<td>142.764</td>
<td>120.000</td>
<td>120.000</td>
<td>알루미늄</td>
<td>France</td>
<td>천톤</td>
<td>EUROPE</td>
<td>bauxite</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2324.000</td>
<td>1815.328</td>
<td>1844.0</td>
<td>1876.000</td>
<td>1831.270</td>
<td>1880.000</td>
<td>1927.145</td>
<td>1559.360</td>
<td>1379.123</td>
<td>1428.639</td>
<td>1227.000</td>
<td>1173.000</td>
<td>869.100</td>
<td>알루미늄</td>
<td>Greece</td>
<td>천톤</td>
<td>EUROPE</td>
<td>bauxite</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>277.800</td>
<td>255.100</td>
<td>93.7</td>
<td>14.400</td>
<td>8.300</td>
<td>16.700</td>
<td>4.000</td>
<td>5.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>알루미늄</td>
<td>Hungary</td>
<td>천톤</td>
<td>EUROPE</td>
<td>bauxite</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="2d4b90eb" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df_nickel_product <span class="op">=</span> df_product[df_product[<span class="st">'광종'</span>]<span class="op">==</span><span class="st">'니켈'</span>]</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>df_nickel_product.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">2011 생산량</th>
<th data-quarto-table-cell-role="th">2012 생산량</th>
<th data-quarto-table-cell-role="th">2013 생산량</th>
<th data-quarto-table-cell-role="th">2014 생산량</th>
<th data-quarto-table-cell-role="th">2015 생산량</th>
<th data-quarto-table-cell-role="th">2016 생산량</th>
<th data-quarto-table-cell-role="th">2017 생산량</th>
<th data-quarto-table-cell-role="th">2018 생산량</th>
<th data-quarto-table-cell-role="th">2019 생산량</th>
<th data-quarto-table-cell-role="th">2020 생산량</th>
<th data-quarto-table-cell-role="th">2021 생산량</th>
<th data-quarto-table-cell-role="th">2022 생산량</th>
<th data-quarto-table-cell-role="th">2023 생산량</th>
<th data-quarto-table-cell-role="th">광종</th>
<th data-quarto-table-cell-role="th">국가</th>
<th data-quarto-table-cell-role="th">단위</th>
<th data-quarto-table-cell-role="th">대륙</th>
<th data-quarto-table-cell-role="th">품목</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">442</td>
<td>3.528</td>
<td>0.728</td>
<td>2.086</td>
<td>4.889</td>
<td>6.309</td>
<td>3.952</td>
<td>5.301</td>
<td>4.204</td>
<td>2.830</td>
<td>3.764</td>
<td>3.615</td>
<td>1.423</td>
<td>0.548</td>
<td>니켈</td>
<td>Albania</td>
<td>천톤</td>
<td>EUROPE</td>
<td>mine</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">443</td>
<td>19.081</td>
<td>19.955</td>
<td>19.579</td>
<td>19.830</td>
<td>10.643</td>
<td>22.034</td>
<td>36.201</td>
<td>43.572</td>
<td>38.530</td>
<td>41.429</td>
<td>42.098</td>
<td>60.360</td>
<td>69.568</td>
<td>니켈</td>
<td>Finland</td>
<td>천톤</td>
<td>EUROPE</td>
<td>mine</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">444</td>
<td>21.100</td>
<td>21.550</td>
<td>19.350</td>
<td>21.410</td>
<td>19.750</td>
<td>19.394</td>
<td>19.080</td>
<td>17.890</td>
<td>13.715</td>
<td>7.060</td>
<td>4.755</td>
<td>1.680</td>
<td>0.000</td>
<td>니켈</td>
<td>Greece</td>
<td>천톤</td>
<td>EUROPE</td>
<td>mine</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">445</td>
<td>7.632</td>
<td>4.436</td>
<td>7.607</td>
<td>6.724</td>
<td>6.650</td>
<td>4.306</td>
<td>7.120</td>
<td>4.791</td>
<td>3.314</td>
<td>3.958</td>
<td>4.735</td>
<td>0.339</td>
<td>0.360</td>
<td>니켈</td>
<td>Kosovo</td>
<td>천톤</td>
<td>EUROPE</td>
<td>mine</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">446</td>
<td>3.600</td>
<td>1.704</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>니켈</td>
<td>Macedonia</td>
<td>천톤</td>
<td>EUROPE</td>
<td>mine</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="4362d7d9" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 단위가 여럿인 경우 등 확인 후 통일</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> each_column <span class="kw">in</span> df_nickel_product.columns:</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'생산량'</span> <span class="kw">not</span> <span class="kw">in</span> each_column:</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>each_column<span class="sc">}</span><span class="ss"> : </span><span class="sc">{</span>df_nickel_product[each_column]<span class="sc">.</span>unique()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>광종 : ['니켈']
국가 : ['Albania' 'Finland' 'Greece' 'Kosovo' 'Macedonia' 'Norway' 'Poland'
 'Russia' 'Spain' 'Botswana' 'Ivory Coast' 'Madagascar' 'Morocco'
 'South Africa' 'Zambia' 'Zimbabwe' 'China' 'Indonesia' 'Kazakhstan'
 'Myanmar' 'Philippines' 'Turkey' 'Vietnam' 'Brazil' 'Canada' 'Colombia'
 'Cuba' 'Dominican Republic' 'Guatemala' 'U.S.A.' 'Venezuela' 'Australia'
 'New Caledonia' 'Papua New Guinea' 'Austria' 'France' 'Ukraine'
 'United Kingdom' 'India' 'Japan' 'South Korea']
단위 : ['천톤']
대륙 : ['EUROPE' 'AFRICA' 'ASIA' 'AMERICA' 'OCEANIA']
품목 : ['mine' 'refined']</code></pre>
</div>
</div>
<div id="05b44f43" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 단일 항목인 광종, 단위, 품목 제거 (메모리확보 9.4+ KB → 8.4+ KB)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df_nickel_product <span class="op">=</span> df_nickel_product[[<span class="st">'2011 생산량'</span>, <span class="st">'2012 생산량'</span>, <span class="st">'2013 생산량'</span>, <span class="st">'2014 생산량'</span>, <span class="st">'2015 생산량'</span>, <span class="st">'2016 생산량'</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'2017 생산량'</span>, <span class="st">'2018 생산량'</span>, <span class="st">'2019 생산량'</span>, <span class="st">'2020 생산량'</span>, <span class="st">'2021 생산량'</span>, <span class="st">'2022 생산량'</span>, <span class="st">'2023 생산량'</span>, <span class="st">'국가'</span>, <span class="st">'대륙'</span>,<span class="st">'품목'</span>]]</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>df_nickel_product.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">2011 생산량</th>
<th data-quarto-table-cell-role="th">2012 생산량</th>
<th data-quarto-table-cell-role="th">2013 생산량</th>
<th data-quarto-table-cell-role="th">2014 생산량</th>
<th data-quarto-table-cell-role="th">2015 생산량</th>
<th data-quarto-table-cell-role="th">2016 생산량</th>
<th data-quarto-table-cell-role="th">2017 생산량</th>
<th data-quarto-table-cell-role="th">2018 생산량</th>
<th data-quarto-table-cell-role="th">2019 생산량</th>
<th data-quarto-table-cell-role="th">2020 생산량</th>
<th data-quarto-table-cell-role="th">2021 생산량</th>
<th data-quarto-table-cell-role="th">2022 생산량</th>
<th data-quarto-table-cell-role="th">2023 생산량</th>
<th data-quarto-table-cell-role="th">국가</th>
<th data-quarto-table-cell-role="th">대륙</th>
<th data-quarto-table-cell-role="th">품목</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">442</td>
<td>3.528</td>
<td>0.728</td>
<td>2.086</td>
<td>4.889</td>
<td>6.309</td>
<td>3.952</td>
<td>5.301</td>
<td>4.204</td>
<td>2.830</td>
<td>3.764</td>
<td>3.615</td>
<td>1.423</td>
<td>0.548</td>
<td>Albania</td>
<td>EUROPE</td>
<td>mine</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">443</td>
<td>19.081</td>
<td>19.955</td>
<td>19.579</td>
<td>19.830</td>
<td>10.643</td>
<td>22.034</td>
<td>36.201</td>
<td>43.572</td>
<td>38.530</td>
<td>41.429</td>
<td>42.098</td>
<td>60.360</td>
<td>69.568</td>
<td>Finland</td>
<td>EUROPE</td>
<td>mine</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">444</td>
<td>21.100</td>
<td>21.550</td>
<td>19.350</td>
<td>21.410</td>
<td>19.750</td>
<td>19.394</td>
<td>19.080</td>
<td>17.890</td>
<td>13.715</td>
<td>7.060</td>
<td>4.755</td>
<td>1.680</td>
<td>0.000</td>
<td>Greece</td>
<td>EUROPE</td>
<td>mine</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">445</td>
<td>7.632</td>
<td>4.436</td>
<td>7.607</td>
<td>6.724</td>
<td>6.650</td>
<td>4.306</td>
<td>7.120</td>
<td>4.791</td>
<td>3.314</td>
<td>3.958</td>
<td>4.735</td>
<td>0.339</td>
<td>0.360</td>
<td>Kosovo</td>
<td>EUROPE</td>
<td>mine</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">446</td>
<td>3.600</td>
<td>1.704</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>0.000</td>
<td>Macedonia</td>
<td>EUROPE</td>
<td>mine</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="5149be8b" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 니켈에 대한 국가별 생산량</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df2_produce_country_mine <span class="op">=</span> df_nickel_product[df_nickel_product[<span class="st">'품목'</span>]<span class="op">==</span><span class="st">'mine'</span>].groupby(by<span class="op">=</span>[<span class="st">'국가'</span>])[[<span class="st">'2011 생산량'</span>, <span class="st">'2012 생산량'</span>, <span class="st">'2013 생산량'</span>, <span class="st">'2014 생산량'</span>, <span class="st">'2015 생산량'</span>, <span class="st">'2016 생산량'</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'2017 생산량'</span>, <span class="st">'2018 생산량'</span>, <span class="st">'2019 생산량'</span>, <span class="st">'2020 생산량'</span>, <span class="st">'2021 생산량'</span>, <span class="st">'2022 생산량'</span>, <span class="st">'2023 생산량'</span>]].<span class="bu">sum</span>()</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>df2_produce_country_refined <span class="op">=</span> df_nickel_product[df_nickel_product[<span class="st">'품목'</span>]<span class="op">==</span><span class="st">'refined'</span>].groupby(by<span class="op">=</span>[<span class="st">'국가'</span>])[[<span class="st">'2011 생산량'</span>, <span class="st">'2012 생산량'</span>, <span class="st">'2013 생산량'</span>, <span class="st">'2014 생산량'</span>, <span class="st">'2015 생산량'</span>, <span class="st">'2016 생산량'</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>       <span class="st">'2017 생산량'</span>, <span class="st">'2018 생산량'</span>, <span class="st">'2019 생산량'</span>, <span class="st">'2020 생산량'</span>, <span class="st">'2021 생산량'</span>, <span class="st">'2022 생산량'</span>, <span class="st">'2023 생산량'</span>]].<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="7954effe" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 니켈에 대한 국가별 생산량의 총 합계(Mine)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df2_produce_country_total_mine <span class="op">=</span> df2_produce_country_mine[[<span class="st">'2011 생산량'</span>, <span class="st">'2012 생산량'</span>, <span class="st">'2013 생산량'</span>, <span class="st">'2014 생산량'</span>, <span class="st">'2015 생산량'</span>, <span class="st">'2016 생산량'</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'2017 생산량'</span>, <span class="st">'2018 생산량'</span>, <span class="st">'2019 생산량'</span>, <span class="st">'2020 생산량'</span>, <span class="st">'2021 생산량'</span>, <span class="st">'2022 생산량'</span>, <span class="st">'2023 생산량'</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>).sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>df2_produce_country_total_mine[<span class="dv">0</span>:<span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>국가
Indonesia        9543.539
Philippines      4762.154
Russia           3057.635
Australia        2612.548
New Caledonia    2453.547
Canada           2448.002
China            1274.216
Brazil            988.699
Cuba              680.208
South Africa      561.815
dtype: float64</code></pre>
</div>
</div>
<div id="c1d29fbf" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 니켈에 대한 국가별 생산량의 총 합계(Refined)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>df2_produce_country_total_refined <span class="op">=</span> df2_produce_country_refined[[<span class="st">'2011 생산량'</span>, <span class="st">'2012 생산량'</span>, <span class="st">'2013 생산량'</span>, <span class="st">'2014 생산량'</span>, <span class="st">'2015 생산량'</span>, <span class="st">'2016 생산량'</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'2017 생산량'</span>, <span class="st">'2018 생산량'</span>, <span class="st">'2019 생산량'</span>, <span class="st">'2020 생산량'</span>, <span class="st">'2021 생산량'</span>, <span class="st">'2022 생산량'</span>, <span class="st">'2023 생산량'</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>).sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>df2_produce_country_total_refined[<span class="dv">0</span>:<span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>국가
China            8813.411
Indonesia        5204.761
Russia           2458.088
Japan            2295.233
Canada           1742.140
Australia        1521.416
Norway           1178.114
New Caledonia     936.948
Brazil            809.897
Finland           712.412
dtype: float64</code></pre>
</div>
</div>
<div id="2a9f86e8" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 니켈 총생산량 내림차순 기준 상위 10개국 Pie chart (Refined한정)</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>target_country <span class="op">=</span>df2_produce_country_total_refined[<span class="dv">0</span>:<span class="dv">10</span>][<span class="dv">0</span>:<span class="dv">10</span>].index.tolist()</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>df2_produce_country_total_refined.loc[target_country].plot(kind<span class="op">=</span><span class="st">'pie'</span>,startangle<span class="op">=</span><span class="dv">145</span>, autopct<span class="op">=</span><span class="st">'</span><span class="sc">%.1f%%</span><span class="st">'</span>, pctdistance<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'국가별 니켈 총생산량 비중(2011~2023,  Refined)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>Text(0.5, 1.0, '국가별 니켈 총생산량 비중(2011~2023,  Refined)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-18-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="분석-내용-및-분석-결과" class="level4">
<h4 class="anchored" data-anchor-id="분석-내용-및-분석-결과">분석 내용 및 분석 결과</h4>
<ul>
<li>작성시 참고사항 : 구체적인 내용을 자유롭게 기술하되, 세부적이고 구체적으로 작성</li>
</ul>
<section id="고려사항사용하고자-한-feature" class="level5">
<h5 class="anchored" data-anchor-id="고려사항사용하고자-한-feature">고려사항(사용하고자 한 Feature)</h5>
<ul>
<li>아래의 상황을 모델에 포함하여 고려하고자 하였습니다
<ul>
<li>생산국 수출량 : 광물의 특정 생산국 비중이 높은 점을 고려하여, 해당 국가의 광물 수출량의 이상탐지</li>
<li>수입국 수입량 : 광물을 수입하는 타 국가의 수입량 증감을 확인하여 이상탐지</li>
<li>생산국 판매액 : 주요 생산국의 대외 판매액을 기준으로 광물의 가격변동을 탐지
<ul>
<li>기준 : FOB가격(물류나 보험료를 제외한 순수 물품가격)을 판매량으로 나누어 kg당 가격 산출</li>
</ul></li>
<li>BDI(Baltic Dry Index) : 광물이 수입을 통해 조달된다는 점과, 광물운송은 벌크선을 통해 진행됨을 착안하여 물류문제에 대한 이상탐지 요소로 포함</li>
</ul></li>
</ul>
<div id="23243eb4" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xlwings <span class="im">as</span> xw</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> filter_df(df:pd.DataFrame, from_country:<span class="bu">str</span>, export:<span class="bu">bool</span>, returnvalue:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, to_country:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>):</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co">        dataframe에서 특정 옵션 데이터를 필터링 하기 위한 함수</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    flowCode <span class="op">=</span> <span class="st">'X'</span> <span class="cf">if</span> export <span class="kw">is</span> <span class="va">True</span> <span class="cf">else</span> <span class="st">'M'</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    filter_to_country <span class="op">=</span> (df[<span class="st">'partnerDesc'</span>]<span class="op">==</span>to_country) <span class="cf">if</span> to_country <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="cf">else</span> <span class="va">True</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># DataFrame복사</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    df_copy <span class="op">=</span> df[(df[<span class="st">'reporterDesc'</span>]<span class="op">==</span>from_country) <span class="op">&amp;</span> filter_to_country <span class="op">&amp;</span> (df[<span class="st">'flowCode'</span>]<span class="op">==</span>flowCode)].copy()</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># DataFrame전처리 : 날짜값 변환(str로변환, 연/월 분리)</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    df_copy[<span class="st">'period'</span>] <span class="op">=</span> df_copy[<span class="st">'period'</span>].astype(<span class="st">'int'</span>).astype(<span class="st">'str'</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    df_copy[<span class="st">'period_year'</span>] <span class="op">=</span> df_copy[<span class="st">'period'</span>].<span class="bu">str</span>[:<span class="dv">4</span>]</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    df_copy[<span class="st">'period_month'</span>] <span class="op">=</span> df_copy[<span class="st">'period'</span>].<span class="bu">str</span>[<span class="op">-</span><span class="dv">2</span>:]</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    df_copy[<span class="st">'period_dateformat'</span>] <span class="op">=</span> pd.to_datetime(df_copy[<span class="st">'refPeriodId'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'%Y%m</span><span class="sc">%d</span><span class="st">'</span>)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 반환 컬럼</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> returnvalue <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>        df_copy <span class="op">=</span> df_copy[returnvalue]</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_copy</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> preprocessing_kpi_uscomtrade(df:pd.DataFrame, <span class="bu">type</span>:<span class="bu">str</span>):</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    df[[<span class="st">'netWgt'</span>,<span class="st">'primaryValue'</span>]] <span class="op">=</span> df[[<span class="st">'netWgt'</span>,<span class="st">'primaryValue'</span>]].dropna()</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 출발국가에 따라 기준값 세팅</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> df[<span class="st">'reporterDesc'</span>].unique() <span class="kw">in</span> [<span class="st">'China'</span>,<span class="st">'Indonesia'</span>]:</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>        criteria_wt <span class="op">=</span> <span class="st">'netWgt'</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>        criteria_value <span class="op">=</span> <span class="st">'primaryValue'</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>        criteria_wt <span class="op">=</span> <span class="st">'netWgt'</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>        criteria_value <span class="op">=</span> <span class="st">'primaryValue'</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 기간(period출력)</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">#period = 'period'</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>    period <span class="op">=</span> <span class="st">'period_dateformat'</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 산출</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span> <span class="op">==</span> <span class="st">'Price'</span>:</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>        df_return <span class="op">=</span> df.groupby(period).<span class="bu">sum</span>(numeric_only<span class="op">=</span><span class="va">True</span>)[criteria_value] <span class="op">/</span> df.groupby(period).<span class="bu">sum</span>(numeric_only<span class="op">=</span><span class="va">True</span>)[criteria_wt]</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">type</span> <span class="op">==</span> <span class="st">'ExportQty'</span>:</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>        df_return <span class="op">=</span> df.groupby(period).<span class="bu">sum</span>(numeric_only<span class="op">=</span><span class="va">True</span>)[criteria_wt]</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">type</span> <span class="op">==</span> <span class="st">'ImportQty'</span>:</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>        temp_dict <span class="op">=</span> {}</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> each_country <span class="kw">in</span> df[<span class="st">'partnerDesc'</span>].unique():</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> each_country <span class="op">!=</span> <span class="st">'World'</span>:</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>                temp_df <span class="op">=</span> df[df[<span class="st">'partnerDesc'</span>]<span class="op">==</span>each_country]</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>                temp_dict[each_country] <span class="op">=</span> temp_df.groupby(period).<span class="bu">sum</span>(numeric_only<span class="op">=</span><span class="va">True</span>)[<span class="st">'netWgt'</span>]</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> temp_dict</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_return</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="지표별-데이터-전처리null제거-및-기준별-groupby-및-계산처리" class="level5">
<h5 class="anchored" data-anchor-id="지표별-데이터-전처리null제거-및-기준별-groupby-및-계산처리">지표별 데이터 전처리(Null제거 및 기준별 Groupby 및 계산처리)</h5>
<ul>
<li>중국과 인도네시아의 수출가격(니켈)</li>
<li>중국과 인도네시아의 수출량(니켈)</li>
<li>국가별 수입량(니켈)</li>
</ul>
<div id="eed2c811" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>wb <span class="op">=</span> xw.Book(<span class="st">'Z:</span><span class="ch">\\</span><span class="st">GoogleDrive</span><span class="ch">\\</span><span class="st">공공데이터 활용 아이디어 공모전</span><span class="ch">\\</span><span class="st">282540,283324_merged.csv'</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>sht <span class="op">=</span> wb.sheets[<span class="dv">0</span>]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>range_df <span class="op">=</span> sht.<span class="bu">range</span>(<span class="st">'A2:BL'</span><span class="op">+</span><span class="bu">str</span>(sht.used_range.last_cell.row))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>df_un_nickel_all <span class="op">=</span> sht.used_range.options(pd.DataFrame,index<span class="op">=</span><span class="dv">0</span>).value</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>wb.close()</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>df_un_nickel_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">typeCode</th>
<th data-quarto-table-cell-role="th">freqCode</th>
<th data-quarto-table-cell-role="th">refPeriodId</th>
<th data-quarto-table-cell-role="th">refYear</th>
<th data-quarto-table-cell-role="th">refMonth</th>
<th data-quarto-table-cell-role="th">period</th>
<th data-quarto-table-cell-role="th">reporterCode</th>
<th data-quarto-table-cell-role="th">reporterISO</th>
<th data-quarto-table-cell-role="th">reporterDesc</th>
<th data-quarto-table-cell-role="th">flowCode</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">netWgt</th>
<th data-quarto-table-cell-role="th">isNetWgtEstimated</th>
<th data-quarto-table-cell-role="th">grossWgt</th>
<th data-quarto-table-cell-role="th">isGrossWgtEstimated</th>
<th data-quarto-table-cell-role="th">cifvalue</th>
<th data-quarto-table-cell-role="th">fobvalue</th>
<th data-quarto-table-cell-role="th">primaryValue</th>
<th data-quarto-table-cell-role="th">legacyEstimationFlag</th>
<th data-quarto-table-cell-role="th">isReported</th>
<th data-quarto-table-cell-role="th">isAggregate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>C</td>
<td>M</td>
<td>20110101.0</td>
<td>2011.0</td>
<td>1.0</td>
<td>201101.0</td>
<td>32.0</td>
<td>ARG</td>
<td>Argentina</td>
<td>M</td>
<td>...</td>
<td>1500.000</td>
<td>False</td>
<td>0.0</td>
<td>False</td>
<td>4.060111e+04</td>
<td>0.000</td>
<td>4.060111e+04</td>
<td>0.0</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>C</td>
<td>M</td>
<td>20110101.0</td>
<td>2011.0</td>
<td>1.0</td>
<td>201101.0</td>
<td>36.0</td>
<td>AUS</td>
<td>Australia</td>
<td>M</td>
<td>...</td>
<td>120.000</td>
<td>False</td>
<td>0.0</td>
<td>False</td>
<td>1.844344e+04</td>
<td>0.000</td>
<td>1.844344e+04</td>
<td>0.0</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>C</td>
<td>M</td>
<td>20110101.0</td>
<td>2011.0</td>
<td>1.0</td>
<td>201101.0</td>
<td>36.0</td>
<td>AUS</td>
<td>Australia</td>
<td>X</td>
<td>...</td>
<td>12000.000</td>
<td>False</td>
<td>0.0</td>
<td>False</td>
<td>0.000000e+00</td>
<td>11942.675</td>
<td>1.194267e+04</td>
<td>0.0</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>C</td>
<td>M</td>
<td>20110101.0</td>
<td>2011.0</td>
<td>1.0</td>
<td>201101.0</td>
<td>40.0</td>
<td>AUT</td>
<td>Austria</td>
<td>M</td>
<td>...</td>
<td>0.000</td>
<td>False</td>
<td>0.0</td>
<td>False</td>
<td>5.477600e+02</td>
<td>0.000</td>
<td>5.477600e+02</td>
<td>0.0</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>C</td>
<td>M</td>
<td>20110101.0</td>
<td>2011.0</td>
<td>1.0</td>
<td>201101.0</td>
<td>56.0</td>
<td>BEL</td>
<td>Belgium</td>
<td>M</td>
<td>...</td>
<td>6609.260</td>
<td>False</td>
<td>0.0</td>
<td>False</td>
<td>1.813610e+05</td>
<td>0.000</td>
<td>1.813610e+05</td>
<td>0.0</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">105246</td>
<td>C</td>
<td>M</td>
<td>20240401.0</td>
<td>2024.0</td>
<td>4.0</td>
<td>202404.0</td>
<td>392.0</td>
<td>JPN</td>
<td>Japan</td>
<td>X</td>
<td>...</td>
<td>90547.000</td>
<td>False</td>
<td>0.0</td>
<td>False</td>
<td>NaN</td>
<td>294094.768</td>
<td>2.940948e+05</td>
<td>0.0</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">105247</td>
<td>C</td>
<td>M</td>
<td>20240401.0</td>
<td>2024.0</td>
<td>4.0</td>
<td>202404.0</td>
<td>376.0</td>
<td>ISR</td>
<td>Israel</td>
<td>M</td>
<td>...</td>
<td>3178.379</td>
<td>True</td>
<td>0.0</td>
<td>False</td>
<td>1.800000e+04</td>
<td>NaN</td>
<td>1.800000e+04</td>
<td>6.0</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">105248</td>
<td>C</td>
<td>M</td>
<td>20240401.0</td>
<td>2024.0</td>
<td>4.0</td>
<td>202404.0</td>
<td>376.0</td>
<td>ISR</td>
<td>Israel</td>
<td>M</td>
<td>...</td>
<td>529.730</td>
<td>True</td>
<td>0.0</td>
<td>False</td>
<td>3.000000e+03</td>
<td>NaN</td>
<td>3.000000e+03</td>
<td>6.0</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">105249</td>
<td>C</td>
<td>M</td>
<td>20240401.0</td>
<td>2024.0</td>
<td>4.0</td>
<td>202404.0</td>
<td>376.0</td>
<td>ISR</td>
<td>Israel</td>
<td>M</td>
<td>...</td>
<td>2648.649</td>
<td>True</td>
<td>0.0</td>
<td>False</td>
<td>1.500000e+04</td>
<td>NaN</td>
<td>1.500000e+04</td>
<td>6.0</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">105250</td>
<td>C</td>
<td>M</td>
<td>20240401.0</td>
<td>2024.0</td>
<td>4.0</td>
<td>202404.0</td>
<td>392.0</td>
<td>JPN</td>
<td>Japan</td>
<td>M</td>
<td>...</td>
<td>2502000.000</td>
<td>False</td>
<td>0.0</td>
<td>False</td>
<td>1.017666e+07</td>
<td>NaN</td>
<td>1.017666e+07</td>
<td>0.0</td>
<td>False</td>
<td>True</td>
</tr>
</tbody>
</table>

<p>105251 rows × 47 columns</p>
</div>
</div>
</div>
<div id="7ac8e90c" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 인도네시아의 수출가격, 수출량, 수입량</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>price_indonesia_raw <span class="op">=</span> filter_df(df<span class="op">=</span>df_un_nickel_all, from_country<span class="op">=</span><span class="st">'Indonesia'</span>, to_country<span class="op">=</span><span class="va">None</span>, export<span class="op">=</span><span class="va">True</span>, returnvalue<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>price_indonesia <span class="op">=</span> preprocessing_kpi_uscomtrade(price_indonesia_raw, <span class="st">'Price'</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>export_qty_indonesia <span class="op">=</span> preprocessing_kpi_uscomtrade(price_indonesia_raw, <span class="st">'ExportQty'</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>import_qty_from_indonesia <span class="op">=</span> preprocessing_kpi_uscomtrade(price_indonesia_raw, <span class="st">'ImportQty'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="48e91fe9" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 중국의 수출가격, 수출량, 수입량</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>price_china_raw <span class="op">=</span> filter_df(df<span class="op">=</span>df_un_nickel_all, from_country<span class="op">=</span><span class="st">'China'</span>, to_country<span class="op">=</span><span class="va">None</span>, export<span class="op">=</span><span class="va">True</span>, returnvalue<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>price_china <span class="op">=</span> preprocessing_kpi_uscomtrade(price_china_raw, <span class="st">'Price'</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>export_qty_china <span class="op">=</span>  preprocessing_kpi_uscomtrade(price_china_raw, <span class="st">'ExportQty'</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>import_qty_from_china <span class="op">=</span> preprocessing_kpi_uscomtrade(price_china_raw, <span class="st">'ImportQty'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="각-지표에-대해-예측수행" class="level5">
<h5 class="anchored" data-anchor-id="각-지표에-대해-예측수행">각 지표에 대해 예측수행</h5>
<ul>
<li><p>Exponential smoothing으로 예측</p>
<ul>
<li>타 팀원의 LSTM활용한 모델 등을 활용할 것으로 예상</li>
</ul></li>
<li><p>데이터를 시각화하여 계절성 등을 먼저 확인하고자 함</p></li>
<li><p>데이터 확인용 시각화</p></li>
</ul>
<div id="0b6332e6" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> koreanize_matplotlib</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="05c39b4d" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>datasource <span class="op">=</span> pd.DataFrame(price_china)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">4</span>))</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.gca().set_xticks(datasource.index)</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>sns.lineplot(datasource)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-24-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Exponential Smoothing모델로 예측</li>
</ul>
<div id="0e3e4ec4" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ExponentialSmoothing 모델 활용</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.holtwinters <span class="im">import</span> ExponentialSmoothing</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dateutil.relativedelta <span class="im">import</span> relativedelta</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> price_china</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> predict_exponential(df:pd.DataFrame, month_to_expect:<span class="bu">int</span>):</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 모델 학습</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> ExponentialSmoothing(df.values, trend<span class="op">=</span><span class="st">'add'</span>, seasonal<span class="op">=</span><span class="st">'add'</span>, seasonal_periods<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    fit <span class="op">=</span> model.fit()</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 예측 수행 (12개월)</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    forecast <span class="op">=</span> fit.forecast(steps<span class="op">=</span>month_to_expect)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 날짜배열 생성</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    months<span class="op">=</span> []</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    start_month <span class="op">=</span> <span class="bu">max</span>(df.index)<span class="op">+</span> relativedelta(months<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    end_month <span class="op">=</span> <span class="bu">max</span>(df.index) <span class="op">+</span> relativedelta(months<span class="op">=</span>month_to_expect)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    current_month <span class="op">=</span> start_month</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_month <span class="op">&lt;=</span> end_month:</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>        months.append(current_month)</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>        current_month <span class="op">+=</span> relativedelta(months<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 날짜+예측값 Series 생성</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    forecast <span class="op">=</span> pd.Series(data<span class="op">=</span>forecast, index<span class="op">=</span>months)</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> forecast</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>forecast <span class="op">=</span> predict_exponential(df<span class="op">=</span>price_china, month_to_expect<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>forecast</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>2024-01-01    14.324603
2024-02-01    15.397100
2024-03-01    14.578083
2024-04-01    14.589412
2024-05-01    15.382925
2024-06-01    15.244014
2024-07-01    15.578931
2024-08-01    15.535253
2024-09-01    15.241216
2024-10-01    15.326029
2024-11-01    15.416176
2024-12-01    15.462405
dtype: float64</code></pre>
</div>
</div>
<div id="0466d76d" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 예측 결과 시각화</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>plt.plot(df.index, df.values, label<span class="op">=</span><span class="st">'실제 데이터'</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>plt.plot(forecast.index, forecast, label<span class="op">=</span><span class="st">'예측 데이터'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'날짜'</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'수급안정화지수'</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="예측값을-데이터에-추가" class="level5">
<h5 class="anchored" data-anchor-id="예측값을-데이터에-추가">예측값을 데이터에 추가</h5>
<div id="ac6b17a5" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>price_china_plus_forecast <span class="op">=</span> pd.concat([price_china, forecast])</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>price_indonesia_plus_forecast <span class="op">=</span> pd.concat([price_indonesia, forecast])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="각-지표에-대해-이상탐지-r-abnomality-패키지-활용" class="level5">
<h5 class="anchored" data-anchor-id="각-지표에-대해-이상탐지-r-abnomality-패키지-활용">각 지표에 대해 이상탐지 (R Abnomality 패키지 활용)</h5>
<ul>
<li><p>중국과 인도네시아의 수출가격(니켈) : 기간별 가격(예측치 포함)에 대한 이상탐지</p></li>
<li><p>중국과 인도네시아의 수출량(니켈) : 기간별 수출량(예측치 포함)에 대한 이상탐지</p></li>
<li><p>국가별 수입량(니켈) : 국가별 수입량(예측치 포함)에 대한 이상탐지</p></li>
<li><p>수급안정화지수 : 예측치에 대한 이상탐지</p></li>
<li><p>BDI : 예측치에 대한 이상탐지</p></li>
<li><p>RStudio 등 설치했으나 구동문제가 있어, 팀원 상의 후에도 이 모델을 사용하는 경우 조치 예정</p></li>
</ul>
</section>
<section id="이상탐지-결과-취합-및-위기요소-판단" class="level5">
<h5 class="anchored" data-anchor-id="이상탐지-결과-취합-및-위기요소-판단">이상탐지 결과 취합 및 위기요소 판단</h5>
<ul>
<li>각 지표에 대해 아래와 같은 평가점수를 부여
<ul>
<li>이상없음 0 / 이상탐지 1</li>
</ul></li>
<li>이상 탐지된 지표 수에 따라 구간별 위기상황 부여 (0정상 1경계 2주의 3위기 등)</li>
</ul>
</section>
</section>
<section id="활용데이터" class="level4">
<h4 class="anchored" data-anchor-id="활용데이터">활용데이터</h4>
<ul>
<li>분석 대상이 되는 데이터와 이에 대한 항목을 모두 작성
<ul>
<li>공공데이터포털 수급안정화 지수</li>
</ul></li>
<li>외부 데이터를 활용하였다면 그에 대한 세부적인 내용 기재 및 활용 이유 제시
<ul>
<li>Investing.com BDI지수</li>
<li>UN Comtrade 수출입현황</li>
</ul></li>
</ul>


</section>
</section>
</section>

<p><br><strong>Copyright © 2024 Kibok Park All rights reserved.</strong><br></p></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/kr9268\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="kr9268/giscus_for_blog" data-repo-id="R_kgDOL0Sthw" data-category="General" data-category-id="DIC_kwDOL0Sth84Ce_5h" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<script>
    const baseFontSize = parseFloat(getComputedStyle(document.documentElement).fontSize);
    const watermark = new XWatermark.XWatermark();
    watermark.init("Kibok Park", {
      parentSelector: "body",
      prevent: true,
      observer: true,
      mode: "normal",
      font: "system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', 'Noto Sans', 'Liberation Sans', Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'",
      fontsize: baseFontSize * 1.000000,
      angle: -15.000000,
      color: "#000000",
      alpha: 0.100000,
      cols: 10,
      rows: 50,
      xSpace: baseFontSize * 4.000000,
      ySpace: baseFontSize * 4.000000,
      zIndex: -1
    });
    </script>




</body></html>